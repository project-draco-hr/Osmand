{
  final long writeCount=readBufferWriteCount[bufferIndex].get();
  for (int i=0; i < READ_BUFFER_DRAIN_THRESHOLD; i++) {
    final int index=(int)(readBufferReadCount[bufferIndex] & READ_BUFFER_INDEX_MASK);
    final AtomicReference<Node<K,V>> slot=readBuffers[bufferIndex][index];
    final Node<K,V> node=slot.get();
    if (node == null) {
      break;
    }
    slot.lazySet(null);
    applyRead(node);
    readBufferReadCount[bufferIndex]++;
  }
  readBufferDrainAtWriteCount[bufferIndex].lazySet(writeCount);
}
