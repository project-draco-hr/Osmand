{
  checkArgument(capacity >= 0);
  evictionLock.lock();
  try {
    this.capacity.lazySet(Math.min(capacity,MAXIMUM_CAPACITY));
    drainBuffers();
    evict();
  }
  finally {
    evictionLock.unlock();
  }
  notifyListener();
}
