{
  ((OsmandApplication)getApplication()).applyTheme(this);
  requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
  getSherlock().setUiOptions(ActivityInfo.UIOPTION_SPLIT_ACTION_BAR_WHEN_NARROW);
  super.onCreate(icicle);
  setSupportProgressBarIndeterminateVisibility(false);
  getSupportActionBar().setDisplayHomeAsUpEnabled(true);
  getSupportActionBar().setTitle(R.string.favorites_Button);
  File[] lf=((OsmandApplication)getApplication()).getAppPath(TRACKS).listFiles();
  boolean hasGpx=false;
  if (lf != null) {
    for (    File t : lf) {
      if (t.isDirectory() || (t.getName().toLowerCase().endsWith(".gpx"))) {
        hasGpx=true;
        break;
      }
    }
  }
  if (!hasGpx) {
    FrameLayout fl=new FrameLayout(this);
    fl.setId(R.id.layout);
    setContentView(fl);
    getSupportFragmentManager().beginTransaction().add(R.id.layout,new FavouritesTreeFragment()).commit();
  }
 else {
    setContentView(R.layout.tab_content);
    tabHost=(TabHost)findViewById(android.R.id.tabhost);
    tabHost.setup();
    OsmandSettings settings=((OsmandApplication)getApplication()).getSettings();
    Integer tab=settings.FAVORITES_TAB.get();
    ViewPager mViewPager=(ViewPager)findViewById(R.id.pager);
    mTabsAdapter=new TabsAdapter(this,tabHost,mViewPager,settings,true);
    mTabsAdapter.addTab(tabHost.newTabSpec(FAVOURITES_INFO).setIndicator(getString(R.string.my_favorites)),FavouritesTreeFragment.class,null);
    mTabsAdapter.addTab(tabHost.newTabSpec(TRACKS).setIndicator(getString(R.string.my_tracks)),AvailableGPXFragment.class,null);
    selectedTrack=mTabsAdapter.addTab(tabHost.newTabSpec(SELECTED_TRACK).setIndicator(getString(R.string.selected_track)),SelectedGPXFragment.class,null);
    Intent intent=getIntent();
    if (intent != null) {
      int tt=intent.getIntExtra(TAB_PARAM,-1);
      if (tt >= 0) {
        tabHost.setCurrentTab(tt);
      }
    }
 else {
      tabHost.setCurrentTab(tab);
    }
    updateSelectedTracks();
  }
}
