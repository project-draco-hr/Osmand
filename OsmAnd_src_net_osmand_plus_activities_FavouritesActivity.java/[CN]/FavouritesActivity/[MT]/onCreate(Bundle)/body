{
  super.onCreate(icicle);
  requestWindowFeature(Window.FEATURE_NO_TITLE);
  setContentView(R.layout.favourites_list);
  Button backButton=(Button)findViewById(R.id.favourites_back_button);
  backButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      FavouritesActivity.this.finish();
    }
  }
);
  helper=((OsmandApplication)getApplication()).getFavorites();
  favouritesAdapter=new FavouritesAdapter();
  favouritesAdapter.setFavoriteGroups(helper.getFavoriteGroups());
  getExpandableListView().setAdapter(favouritesAdapter);
  getExpandableListView().setOnCreateContextMenuListener(new View.OnCreateContextMenuListener(){
    @Override public void onCreateContextMenu(    ContextMenu menu,    View v,    ContextMenuInfo menuInfo){
      int child=ExpandableListView.getPackedPositionChild(((ExpandableListContextMenuInfo)menuInfo).packedPosition);
      int group=ExpandableListView.getPackedPositionGroup(((ExpandableListContextMenuInfo)menuInfo).packedPosition);
      if (child == -1) {
        return;
      }
      menu.add(0,SHOW_ON_MAP,0,R.string.show_poi_on_map);
      menu.add(0,NAVIGATE_TO,1,R.string.favourites_context_menu_navigate);
      final FavouritePoint point=(FavouritePoint)favouritesAdapter.getChild(group,child);
      if (point.isStored()) {
        menu.add(0,EDIT_ITEM,2,R.string.favourites_context_menu_edit);
        menu.add(0,DELETE_ITEM,3,R.string.favourites_context_menu_delete);
      }
    }
  }
);
  findViewById(R.id.CancelButton).setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      cancelSelectingMode();
    }
  }
);
  findViewById(R.id.ActionButton).setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      if (groupsToDelete.size() + favoritesToDelete.size() > 0) {
        Builder b=new AlertDialog.Builder(FavouritesActivity.this);
        b.setMessage(getString(R.string.favorite_delete_multiple,favoritesToDelete.size(),groupsToDelete.size()));
        b.setPositiveButton(R.string.default_buttons_delete,new DialogInterface.OnClickListener(){
          @Override public void onClick(          DialogInterface dialog,          int which){
            cancelSelectingMode();
            deleteFavorites();
          }
        }
);
        b.setNegativeButton(R.string.default_buttons_cancel,null);
        b.show();
      }
    }
  }
);
}
