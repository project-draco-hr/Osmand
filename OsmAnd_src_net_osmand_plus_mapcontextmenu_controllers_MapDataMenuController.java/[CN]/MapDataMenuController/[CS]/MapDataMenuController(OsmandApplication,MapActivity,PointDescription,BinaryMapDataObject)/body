{
  super(new MenuBuilder(app),pointDescription,mapActivity);
  OsmandRegions osmandRegions=app.getRegions();
  String fullName=osmandRegions.getFullName(dataObject);
  final WorldRegion region=osmandRegions.getRegionData(fullName);
  this.region=region;
  if (region != null) {
    regionName=region.getLocaleName();
  }
 else {
    regionName=dataObject.getName();
  }
  boolean hasIndexes=app.getDownloadThread().getIndexes().isDownloadedFromInternet;
  boolean isDownloading=false;
  leftTitleButtonController=new TitleButtonController(){
    @Override public void buttonPressed(){
      getMapActivity().getContextMenu().close();
      final Intent intent=new Intent(getMapActivity(),getMapActivity().getMyApplication().getAppCustomization().getDownloadIndexActivity());
      intent.putExtra(DownloadActivity.FILTER_KEY,regionName);
      intent.putExtra(DownloadActivity.TAB_TO_OPEN,DownloadActivity.DOWNLOAD_TAB);
      getMapActivity().startActivity(intent);
    }
  }
;
  leftTitleButtonController.caption=getMapActivity().getString(R.string.shared_string_download);
  leftTitleButtonController.leftIconId=R.drawable.ic_action_import;
  rightTitleButtonController=new TitleButtonController(){
    @Override public void buttonPressed(){
    }
  }
;
  rightTitleButtonController.caption=getMapActivity().getString(R.string.shared_string_delete);
  rightTitleButtonController.leftIconId=R.drawable.ic_action_delete_dark;
  topRightTitleButtonController=new TitleButtonController(){
    @Override public void buttonPressed(){
    }
  }
;
  topRightTitleButtonController.caption=getMapActivity().getString(R.string.download_select_map_types);
  topRightTitleButtonController.visible=hasIndexes && !isDownloading;
  titleProgressController=new TitleProgressController(){
    @Override public void buttonPressed(){
    }
  }
;
  if (!hasIndexes) {
    titleProgressController.setIndexesDownloadMode();
    titleProgressController.visible=true;
    getMapActivity().getMyApplication().getDownloadThread().runReloadIndexFiles();
  }
 else   if (isDownloading) {
    titleProgressController.setMapDownloadMode();
    titleProgressController.caption="Downloading...";
    titleProgressController.visible=true;
  }
 else {
    titleProgressController.visible=false;
  }
}
