{
  final List<Location> locs=route.getImmutableAllLocations();
  List<Amenity> amenities=app.getResourceManager().searchAmenitiesOnThePath(locs,searchDeviationRadius,getPoiFilter(),new ResultMatcher<Amenity>(){
    @Override public boolean publish(    Amenity object){
      return true;
    }
    @Override public boolean isCancelled(){
      return false;
    }
  }
);
  List<LocationPointWrapper> array=getArray(locationPoints,POI);
  for (  Amenity a : amenities) {
    AmenityRoutePoint rp=a.getRoutePoint();
    int i=locs.indexOf(rp.pointA);
    if (i >= 0) {
      LocationPointWrapper lwp=new LocationPointWrapper(route,POI,new AmenityLocationPoint(a),(float)rp.deviateDistance,i);
      lwp.setAnnounce(announcePOI());
      array.add(lwp);
    }
  }
}
