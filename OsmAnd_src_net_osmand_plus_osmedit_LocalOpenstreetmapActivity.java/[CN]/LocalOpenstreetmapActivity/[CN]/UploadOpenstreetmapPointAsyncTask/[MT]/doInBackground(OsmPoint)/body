{
  int uploaded=0;
  for (  OsmPoint point : points) {
    if (interruptUploading)     break;
    if (point.getGroup() == OsmPoint.Group.POI) {
      OpenstreetmapPoint p=(OpenstreetmapPoint)point;
      EntityInfo entityInfo=null;
      if (OsmPoint.Action.CREATE != p.getAction()) {
        entityInfo=remotepoi.loadNode(p.getEntity());
      }
      Node n;
      if ((n=remotepoi.commitNodeImpl(p.getAction(),p.getEntity(),entityInfo,p.getComment(),false)) != null) {
        remotepoi.updateNodeInIndexes(LocalOpenstreetmapActivity.this,p.getAction(),n,p.getEntity());
        dbpoi.deletePOI(p);
        publishProgress(p);
        uploaded++;
      }
    }
 else     if (point.getGroup() == OsmPoint.Group.BUG) {
      OsmbugsPoint p=(OsmbugsPoint)point;
      boolean success=false;
      if (p.getAction() == OsmPoint.Action.CREATE) {
        success=remotebug.createNewBug(p.getLatitude(),p.getLongitude(),p.getText(),p.getAuthor());
      }
 else       if (p.getAction() == OsmPoint.Action.MODIFY) {
        success=remotebug.addingComment(p.getId(),p.getText(),p.getAuthor());
      }
 else       if (p.getAction() == OsmPoint.Action.DELETE) {
        success=remotebug.closingBug(p.getId(),p.getText(),p.getAuthor());
      }
      if (success) {
        dbbug.deleteAllBugModifications(p);
        uploaded++;
        publishProgress(p);
      }
    }
  }
  return Integer.valueOf(uploaded);
}
