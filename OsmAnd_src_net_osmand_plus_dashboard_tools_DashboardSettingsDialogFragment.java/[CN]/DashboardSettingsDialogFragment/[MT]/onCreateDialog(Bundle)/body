{
  final OsmandSettings settings=mapActivity.getMyApplication().getSettings();
  View view=LayoutInflater.from(getActivity()).inflate(R.layout.dashboard_settings_dialog_item,null,false);
  final TextView textView=(TextView)view.findViewById(R.id.text);
  textView.setText("Show on start");
  final OsmandSettings.CommonPreference<Boolean> shouldShowDashboardOnStart=settings.registerBooleanPreference(MapActivity.SHOULD_SHOW_DASHBOARD_ON_START,true);
  final CompoundButton compoundButton=(CompoundButton)view.findViewById(R.id.check_item);
  compoundButton.setChecked(shouldShowDashboardOnStart.get());
  textView.setTextColor(shouldShowDashboardOnStart.get() ? 0xFF212121 : 0xFF8c8c8c);
  compoundButton.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener(){
    @Override public void onCheckedChanged(    CompoundButton compoundButton,    boolean b){
      textView.setTextColor(b ? 0xFF212121 : 0xFF8c8c8c);
    }
  }
);
  AlertDialog.Builder builder=new AlertDialog.Builder(getActivity());
  if (savedInstanceState != null && savedInstanceState.containsKey(CHECKED_ITEMS)) {
    mAdapter=new DashFragmentAdapter(getActivity(),mFragmentsData,savedInstanceState.getBooleanArray(CHECKED_ITEMS),new int[mFragmentsData.size()]);
  }
 else {
    mAdapter=new DashFragmentAdapter(getActivity(),mFragmentsData,settings);
  }
  builder.setTitle(R.string.dahboard_options_dialog_title).setAdapter(mAdapter,null).setPositiveButton(R.string.shared_string_ok,new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialogInterface,    int type){
      boolean[] shouldShow=mAdapter.getCheckedItems();
      for (int i=0; i < shouldShow.length; i++) {
        settings.registerBooleanPreference(DashboardOnMap.SHOULD_SHOW + mFragmentsData.get(i).tag,true).makeGlobal().set(shouldShow[i]);
      }
      mapActivity.getDashboard().refreshDashboardFragments();
      shouldShowDashboardOnStart.set(compoundButton.isChecked());
    }
  }
).setNegativeButton(R.string.shared_string_cancel,null);
  final AlertDialog dialog=builder.create();
  ListView listView=dialog.getListView();
  listView.addHeaderView(view);
  return dialog;
}
