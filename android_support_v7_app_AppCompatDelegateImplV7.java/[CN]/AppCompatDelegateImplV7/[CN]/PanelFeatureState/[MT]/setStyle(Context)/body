{
  final TypedValue outValue=new TypedValue();
  final Resources.Theme widgetTheme=context.getResources().newTheme();
  widgetTheme.setTo(context.getTheme());
  widgetTheme.resolveAttribute(R.attr.actionBarPopupTheme,outValue,true);
  if (outValue.resourceId != 0) {
    widgetTheme.applyStyle(outValue.resourceId,true);
  }
  widgetTheme.resolveAttribute(R.attr.panelMenuListTheme,outValue,true);
  if (outValue.resourceId != 0) {
    widgetTheme.applyStyle(outValue.resourceId,true);
  }
 else {
    widgetTheme.applyStyle(R.style.Theme_AppCompat_CompactMenu,true);
  }
  context=new ContextThemeWrapper(context,0);
  context.getTheme().setTo(widgetTheme);
  listPresenterContext=context;
  TypedArray a=context.obtainStyledAttributes(R.styleable.Theme);
  background=a.getResourceId(R.styleable.Theme_panelBackground,0);
  windowAnimations=a.getResourceId(R.styleable.Theme_android_windowAnimationStyle,0);
  a.recycle();
}
