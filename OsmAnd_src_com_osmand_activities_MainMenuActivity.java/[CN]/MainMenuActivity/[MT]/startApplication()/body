{
  if (!applicationAlreadyStarted) {
    final ProgressDialog dlg=ProgressDialog.show(this,getString(R.string.loading_data),getString(R.string.reading_indexes),true);
    final ProgressDialogImplementation impl=new ProgressDialogImplementation(dlg);
    impl.setRunnable("Initializing app",new Runnable(){
      @Override public void run(){
        try {
          List<String> warnings=ResourceManager.getResourceManager().reloadIndexes(impl);
          SavingTrackHelper helper=new SavingTrackHelper(MainMenuActivity.this);
          if (helper.hasDataToSave()) {
            impl.startTask(getString(R.string.saving_gpx_tracks),-1);
            helper.saveDataToGpx();
          }
          helper.close();
          showWarnings(warnings);
        }
  finally {
          dlg.dismiss();
        }
      }
    }
);
    impl.run();
    applicationAlreadyStarted=true;
    Thread.setDefaultUncaughtExceptionHandler(new DefaultExceptionHandler());
    long size=getPreferences(MODE_WORLD_READABLE).getLong(EXCEPTION_FILE_SIZE,0);
    File file=new File(Environment.getExternalStorageDirectory(),EXCEPTION_PATH);
    if (file.exists() && file.length() > 0) {
      if (size != file.length()) {
        String msg=MessageFormat.format(getString(R.string.previous_run_crashed),EXCEPTION_PATH);
        Builder builder=new AlertDialog.Builder(MainMenuActivity.this);
        builder.setMessage(msg).setNeutralButton(getString(R.string.close),null).show();
        getPreferences(MODE_WORLD_READABLE).edit().putLong(EXCEPTION_FILE_SIZE,file.length()).commit();
      }
    }
 else {
      if (size > 0) {
        getPreferences(MODE_WORLD_READABLE).edit().putLong(EXCEPTION_FILE_SIZE,0).commit();
      }
    }
  }
}
