{
  if (!applicationAlreadyStarted) {
    final ProgressDialog dlg=ProgressDialog.show(this,"Loading data","Reading indices...",true);
    final ProgressDialogImplementation impl=new ProgressDialogImplementation(dlg);
    impl.setRunnable("Initializing app",new Runnable(){
      @Override public void run(){
        try {
          List<String> warnings=new ArrayList<String>();
          warnings.addAll(ResourceManager.getResourceManager().indexingPoi(impl));
          warnings.addAll(ResourceManager.getResourceManager().indexingAddresses(impl));
          SavingTrackHelper helper=new SavingTrackHelper(MainMenuActivity.this);
          if (helper.hasDataToSave()) {
            impl.startTask("Saving gpx tracks to SD...",-1);
            helper.saveDataToGpx();
          }
          helper.close();
          showWarnings(warnings);
        }
  finally {
          dlg.dismiss();
        }
      }
    }
);
    impl.run();
    applicationAlreadyStarted=true;
    Thread.setDefaultUncaughtExceptionHandler(new DefaultExceptionHandler());
    long size=getPreferences(MODE_WORLD_READABLE).getLong(EXCEPTION_FILE_SIZE,0);
    File file=new File(Environment.getExternalStorageDirectory(),EXCEPTION_PATH);
    if (file.exists() && file.length() > 0) {
      if (size != file.length()) {
        String msg="Previous application run was crashed. Log file is in " + EXCEPTION_PATH + ". ";
        msg+="Please raise the issue and attach log file.";
        Builder builder=new AlertDialog.Builder(MainMenuActivity.this);
        builder.setMessage(msg).setNeutralButton("Close",null).show();
        getPreferences(MODE_WORLD_READABLE).edit().putLong(EXCEPTION_FILE_SIZE,file.length()).commit();
      }
    }
 else {
      if (size > 0) {
        getPreferences(MODE_WORLD_READABLE).edit().putLong(EXCEPTION_FILE_SIZE,0).commit();
      }
    }
  }
}
