{
  File file=new File(Environment.getExternalStorageDirectory(),POI_PATH);
  DataTileManager<Node> r=new DataTileManager<Node>();
  if (file.exists() && file.canRead() && indexPOIFlag) {
    for (    File f : file.listFiles()) {
      if (f.getName().endsWith(".bz2") || f.getName().endsWith(".osm")) {
        if (log.isDebugEnabled()) {
          log.debug("Starting index POI " + f.getAbsolutePath());
        }
        boolean zipped=f.getName().endsWith(".bz2");
        InputStream stream=null;
        try {
          OsmBaseStorage storage=new OsmBaseStorage();
          stream=new FileInputStream(f);
          stream=new BufferedInputStream(stream);
          if (zipped) {
            if (stream.read() != 'B' || stream.read() != 'Z') {
              log.error("Can't read poi file " + f.getAbsolutePath() + "The source stream must start with the characters BZ if it is to be read as a BZip2 stream.");
              continue;
            }
 else {
              stream=new CBZip2InputStream(stream);
            }
          }
          storage.parseOSM(stream);
          for (          Entity e : storage.getRegisteredEntities().values()) {
            if (e instanceof Node && e.getTag(OSMTagKey.AMENITY) != null) {
              Node n=(Node)e;
              r.registerObject(n.getLatitude(),n.getLongitude(),n);
            }
          }
          if (log.isDebugEnabled()) {
            log.debug("Finishing index POI " + f.getAbsolutePath());
          }
        }
 catch (        IOException e) {
          log.error("Can't read poi file " + f.getAbsolutePath(),e);
        }
catch (        SAXException e) {
          log.error("Can't read poi file " + f.getAbsolutePath(),e);
        }
 finally {
          Algoritms.closeStream(stream);
        }
      }
    }
  }
  return r;
}
