{
  locationLayer.setLastKnownLocation(location,true);
  if (location != null) {
    if (linkLocationWithMap) {
      if (location.hasBearing() && OsmandSettings.isRotateMapToBearing(this)) {
        mapView.setRotateWithLocation(-location.getBearing(),location.getLatitude(),location.getLongitude());
      }
 else {
        mapView.setLatLon(location.getLatitude(),location.getLongitude());
      }
    }
 else {
      mapView.prepareImage();
    }
  }
 else {
    if (!linkLocationWithMap) {
      backToLocation.setVisibility(View.VISIBLE);
    }
  }
}
