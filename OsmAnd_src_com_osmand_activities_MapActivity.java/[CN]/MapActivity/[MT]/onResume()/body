{
  super.onResume();
  if (mapView.getMap() != OsmandSettings.getMapTileSource(this)) {
    mapView.setMap(OsmandSettings.getMapTileSource(this));
  }
  if (!OsmandSettings.isRotateMapToBearing(this)) {
    mapView.setRotate(0);
  }
  if (mapView.getLayers().contains(poiMapLayer) != OsmandSettings.isShowingPoiOverMap(this)) {
    if (OsmandSettings.isShowingPoiOverMap(this)) {
      mapView.addLayer(poiMapLayer);
    }
 else {
      mapView.removeLayer(poiMapLayer);
    }
  }
  LocationManager service=(LocationManager)getSystemService(LOCATION_SERVICE);
  service.requestLocationUpdates(LocationManager.GPS_PROVIDER,2000,0,this);
  if (wakeLock == null) {
    PowerManager powerManager=(PowerManager)getSystemService(POWER_SERVICE);
    wakeLock=powerManager.newWakeLock(PowerManager.SCREEN_BRIGHT_WAKE_LOCK,"com.osmand.map");
    wakeLock.acquire();
  }
}
