{
  if (location == null) {
    if (sensorRegistered) {
      Log.d(LogUtil.TAG,"Disable sensor");
      ((SensorManager)getSystemService(SENSOR_SERVICE)).unregisterListener(this);
      sensorRegistered=false;
      locationLayer.setHeading(null);
    }
  }
 else {
    if (!sensorRegistered && OsmandSettings.isShowingViewAngle(this)) {
      Log.d(LogUtil.TAG,"Enable sensor");
      SensorManager sensorMgr=(SensorManager)getSystemService(SENSOR_SERVICE);
      Sensor s=sensorMgr.getDefaultSensor(Sensor.TYPE_ORIENTATION);
      if (s != null) {
        sensorMgr.registerListener(this,s,SensorManager.SENSOR_DELAY_UI);
      }
      sensorRegistered=true;
    }
  }
}
