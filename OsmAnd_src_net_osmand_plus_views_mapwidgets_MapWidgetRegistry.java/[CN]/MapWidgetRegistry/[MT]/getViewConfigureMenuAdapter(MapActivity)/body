{
  final ContextMenuAdapter cm=new ContextMenuAdapter(map);
  cm.setDefaultLayoutId(R.layout.list_item_icon_and_menu);
  cm.item(R.string.app_modes_choose).layout(R.layout.mode_toggles).reg();
  cm.setChangeAppModeListener(new ConfigureMapMenu.OnClickListener(){
    @Override public void onClick(    boolean allModes){
      map.getDashboard().updateListAdapter(getViewConfigureMenuAdapter(map));
    }
  }
);
  final ApplicationMode mode=settings.getApplicationMode();
  addControls(map,cm,mode);
  return cm;
}
