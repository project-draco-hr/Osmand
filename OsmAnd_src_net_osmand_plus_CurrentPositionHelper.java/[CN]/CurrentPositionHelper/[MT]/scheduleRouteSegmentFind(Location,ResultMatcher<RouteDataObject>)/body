{
  Thread calcThread=calculatingThread;
  if (calcThread == Thread.currentThread()) {
    lastFound=runUpdateInThreadCatch(loc.getLatitude(),loc.getLongitude(),result);
  }
 else   if (loc != null) {
    if (calcThread == null) {
      Runnable run=new Runnable(){
        @Override public void run(){
          try {
            lastFound=runUpdateInThreadCatch(loc.getLatitude(),loc.getLongitude(),result);
            if (lastAskedLocation != loc && result != null) {
              getLastKnownRouteSegment(lastAskedLocation);
            }
          }
  finally {
            calculatingThread=null;
          }
        }
      }
;
      calculatingThread=app.getRoutingHelper().startTaskInRouteThreadIfPossible(run);
    }
 else     if (calcThread != null && !calcThread.isAlive()) {
      calculatingThread=null;
    }
  }
}
