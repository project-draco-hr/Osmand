{
  this.view=view;
  rm=view.getApplication().getResourceManager();
  osmandRegions=rm.getOsmandRegions();
  paint=new Paint();
  paint.setStyle(Style.FILL_AND_STROKE);
  paint.setStrokeWidth(1);
  paint.setColor(Color.argb(100,50,200,50));
  paint.setAntiAlias(true);
  paint.setStrokeCap(Cap.ROUND);
  paint.setStrokeJoin(Join.ROUND);
  textPaint=new TextPaint();
  final WindowManager wmgr=(WindowManager)view.getApplication().getSystemService(Context.WINDOW_SERVICE);
  DisplayMetrics dm=new DisplayMetrics();
  wmgr.getDefaultDisplay().getMetrics(dm);
  textPaint.setStrokeWidth(21 * dm.scaledDensity);
  textPaint.setAntiAlias(true);
  textPaint.setTextAlign(Paint.Align.CENTER);
  FrameLayout fl=(FrameLayout)view.getParent();
  downloadBtn=new Button(view.getContext());
  downloadBtn.setVisibility(View.GONE);
  downloadBtn.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      final Intent intent=new Intent(view.getContext(),view.getApplication().getAppCustomization().getDownloadIndexActivity());
      intent.putExtra(DownloadIndexActivity.FILTER_KEY,filter.toString());
      view.getContext().startActivity(intent);
    }
  }
);
  final FrameLayout.LayoutParams lp=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
  lp.gravity=Gravity.CENTER;
  fl.addView(downloadBtn,lp);
  path=new Path();
  data=new MapLayerData<List<BinaryMapDataObject>>(){
{
      ZOOM_THRESHOLD=2;
    }
    @Override protected List<BinaryMapDataObject> calculateResult(    RotatedTileBox tileBox){
      return queryData(tileBox);
    }
  }
;
}
