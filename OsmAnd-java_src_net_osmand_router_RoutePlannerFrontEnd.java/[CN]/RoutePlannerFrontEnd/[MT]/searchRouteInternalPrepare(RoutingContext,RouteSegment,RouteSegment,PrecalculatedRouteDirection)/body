{
  ctx.targetX=end.road.getPoint31XTile(end.getSegmentStart());
  ctx.targetY=end.road.getPoint31YTile(end.getSegmentStart());
  ctx.startX=start.road.getPoint31XTile(start.getSegmentStart());
  ctx.startY=start.road.getPoint31YTile(start.getSegmentStart());
  if (routeDirection != null) {
    ctx.precalculatedRouteDirection=routeDirection.adopt(ctx);
  }
  if (ctx.nativeLib != null) {
    return runNativeRouting(ctx);
  }
 else {
    refreshProgressDistance(ctx);
    if (useOldVersion) {
      new BinaryRoutePlannerOld().searchRouteInternal(ctx,start,end);
    }
 else {
      ctx.finalRouteSegment=new BinaryRoutePlanner().searchRouteInternal(ctx,start,end);
    }
    return new RouteResultPreparation().prepareResult(ctx,ctx.finalRouteSegment);
  }
}
