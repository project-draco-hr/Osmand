{
  this.mMapActivity=mapActivity;
  screenHeight=AndroidUtils.getScreenHeight(mapActivity);
  markerPaddingPx=dpToPx(MARKER_PADDING_DP);
  markerPaddingXPx=dpToPx(MARKER_PADDING_X_DP);
  menu=mapActivity.getContextMenu();
  map=mapActivity.getMapView();
  RotatedTileBox box=map.getCurrentRotatedTileBox().copy();
  customMapCenter=menu.getMapCenter() != null;
  if (!customMapCenter) {
    mapCenter=box.getCenterLatLon();
    menu.setMapCenter(mapCenter);
    double markerLat=menu.getLatLon().getLatitude();
    double markerLon=menu.getLatLon().getLongitude();
    origMarkerX=(int)box.getPixXFromLatLon(markerLat,markerLon);
    origMarkerY=(int)box.getPixYFromLatLon(markerLat,markerLon);
  }
 else {
    mapCenter=menu.getMapCenter();
    origMarkerX=box.getCenterPixelX();
    origMarkerY=box.getCenterPixelY();
  }
  menu.updateData();
  bottomSheetViewHeght=dpToPx(bottomSheetViewHeightDp);
}
