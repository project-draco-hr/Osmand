{
  if (rules[OsmandRenderingRulesParser.LINE_STATE] == null) {
    return false;
  }
  Map<String,List<FilterState>> map=rules[OsmandRenderingRulesParser.LINE_STATE].get(tag);
  if (map != null) {
    List<FilterState> list=map.get(val);
    if (list != null) {
      FilterState found=null;
      for (      FilterState f : list) {
        if (f.minzoom <= zoom && (zoom <= f.maxzoom || f.maxzoom == -1) && f.layer == layer) {
          found=f;
          break;
        }
      }
      if (found == null) {
        for (        FilterState f : list) {
          if (f.minzoom <= zoom && (zoom <= f.maxzoom || f.maxzoom == -1) && f.layer == 0) {
            found=f;
            break;
          }
        }
      }
      if (found != null) {
        rc.main.color=Color.BLACK;
        if (found.shader != null) {
          Integer i=RenderingIcons.getIcons().get(found.shader);
          if (i != null) {
            rc.main.shader=o.getShader(i);
          }
        }
        rc.main.fillArea=false;
        applyEffectAttributes(found.main,rc.main,o);
        if (found.effectAttributes.size() > 0) {
          applyEffectAttributes(found.effectAttributes.get(0),rc.second,o);
          if (found.effectAttributes.size() > 1) {
            applyEffectAttributes(found.effectAttributes.get(1),rc.third,o);
          }
        }
        return true;
      }
    }
  }
  return false;
}
