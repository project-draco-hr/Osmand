{
switch (item.getItemId()) {
case R.id.map_show_settings:
    final Intent intentSettings=new Intent(MapActivity.this,SettingsActivity.class);
  startActivity(intentSettings);
return true;
case R.id.map_where_am_i:
backToLocationImpl();
return true;
case R.id.map_show_gps_status:
startGpsStatusIntent();
return true;
case R.id.map_get_directions:
if (routingHelper.isRouteCalculated()) {
mapActions.aboutRoute();
}
 else {
Location loc=getLastKnownLocation();
if (loc != null) {
mapActions.getDirections(loc.getLatitude(),loc.getLongitude(),true);
}
 else {
mapActions.getDirections(mapView.getLatitude(),mapView.getLongitude(),true);
}
}
return true;
case R.id.map_layers:
mapLayers.openLayerSelectionDialog(mapView);
return true;
case R.id.map_specify_point:
Intent newIntent=new Intent(MapActivity.this,SearchActivity.class);
LatLon mapLoc=getMapLocation();
newIntent.putExtra(SearchActivity.SEARCH_LAT,mapLoc.getLatitude());
newIntent.putExtra(SearchActivity.SEARCH_LON,mapLoc.getLongitude());
newIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(newIntent);
return true;
case R.id.map_mute:
routingHelper.getVoiceRouter().setMute(!routingHelper.getVoiceRouter().isMute());
return true;
case R.id.map_navigate_to_point:
if (mapLayers.getNavigationLayer().getPointToNavigate() != null) {
if (routingHelper.isRouteCalculated()) {
routingHelper.setFinalAndCurrentLocation(null,routingHelper.getCurrentLocation(),routingHelper.getCurrentGPXRoute());
}
 else {
navigateToPoint(null);
}
}
 else {
navigateToPoint(new LatLon(mapView.getLatitude(),mapView.getLongitude()));
}
mapView.refreshMap();
return true;
case R.id.map_show_point_options:
contextMenuPoint(mapView.getLatitude(),mapView.getLongitude());
return true;
case R.id.map_animate_route:
routeAnimation.startStopRouteAnimation(routingHelper,this);
return true;
default :
return super.onOptionsItemSelected(item);
}
}
