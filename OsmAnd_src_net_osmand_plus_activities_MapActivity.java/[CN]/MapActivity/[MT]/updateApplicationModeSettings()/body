{
  RendererRegistry registry=app.getRendererRegistry();
  RenderingRulesStorage newRenderer=registry.getRenderer(settings.RENDERER.get());
  if (newRenderer == null) {
    newRenderer=registry.defaultRender();
  }
  if (registry.getCurrentSelectedRenderer() != newRenderer) {
    registry.setCurrentSelectedRender(newRenderer);
    app.getResourceManager().getRenderer().clearCache();
  }
  mapViewTrackingUtilities.updateSettings();
  app.getRoutingHelper().setAppMode(settings.getApplicationMode());
  if (mapLayers.getMapInfoLayer() != null && !settings.USE_NATIVE_RENDER.get()) {
    mapLayers.getMapInfoLayer().recreateControls();
  }
  mapViewController.updateLayers(mapLayers);
  mapViewController.setComplexZoom();
  app.getDaynightHelper().startSensorIfNeeded(new StateChangedListener<Boolean>(){
    @Override public void stateChanged(    Boolean change){
      mapViewController.refreshMap(true);
    }
  }
);
  mapViewController.refreshMap(true);
}
