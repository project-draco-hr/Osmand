{
  changeKeyguardFlags();
  RendererRegistry registry=app.getRendererRegistry();
  RenderingRulesStorage newRenderer=registry.getRenderer(settings.RENDERER.get());
  if (newRenderer == null) {
    newRenderer=registry.defaultRender();
  }
  if (registry.getCurrentSelectedRenderer() != newRenderer) {
    registry.setCurrentSelectedRender(newRenderer);
    app.getResourceManager().getRenderer().clearCache();
  }
  mapViewTrackingUtilities.updateSettings();
  app.getRoutingHelper().setAppMode(settings.getApplicationMode());
  if (mapLayers.getMapInfoLayer() != null) {
    mapLayers.getMapInfoLayer().recreateControls();
  }
  mapLayers.updateLayers(mapView);
  mapView.setComplexZoom(mapView.getZoom(),mapView.getSettingsZoomScale());
  app.getDaynightHelper().startSensorIfNeeded(new StateChangedListener<Boolean>(){
    @Override public void stateChanged(    Boolean change){
      getMapView().refreshMap(true);
    }
  }
);
  getMapView().refreshMap(true);
}
