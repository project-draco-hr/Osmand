{
  super.onPause();
  LocationManager service=(LocationManager)getSystemService(LOCATION_SERVICE);
  service.removeUpdates(gpsListener);
  service.removeUpdates(networkListener);
  SensorManager sensorMgr=(SensorManager)getSystemService(SENSOR_SERVICE);
  sensorMgr.unregisterListener(this);
  sensorRegistered=false;
  currentLocationProvider=null;
  routingHelper.setUiActivity(null);
  ((OsmandApplication)getApplication()).getDaynightHelper().onMapPause();
  OsmandSettings.setLastKnownMapLocation(this,(float)mapView.getLatitude(),(float)mapView.getLongitude());
  AnimateDraggingMapThread animatedThread=mapView.getAnimatedDraggingThread();
  if (animatedThread.isAnimating() && animatedThread.getTargetZoom() != 0) {
    OsmandSettings.setMapLocationToShow(this,animatedThread.getTargetLatitude(),animatedThread.getTargetLongitude(),animatedThread.getTargetZoom());
  }
  OsmandSettings.setLastKnownMapZoom(this,mapView.getZoom());
  if (wakeLock != null) {
    wakeLock.release();
    wakeLock=null;
  }
  OsmandSettings.setMapActivityEnabled(this,false);
  ((OsmandApplication)getApplication()).getResourceManager().interruptRendering();
  ((OsmandApplication)getApplication()).getResourceManager().setBusyIndicator(null);
}
