{
  DisplayMetrics metrics=new DisplayMetrics();
  getWindowManager().getDefaultDisplay().getMetrics(metrics);
  int screenSizeCorrection=(int)Math.round(Math.log(((float)metrics.heightPixels) / 320.0f) / Math.log(2.0f));
  if (speed < 7f / 3.6) {
    return currentZoom;
  }
 else   if (speed < 23f / 3.6) {
    return 17 + screenSizeCorrection;
  }
 else   if (speed < 43f / 3.6) {
    return 16 + screenSizeCorrection;
  }
 else   if (speed < 63f / 3.6) {
    return 15 + screenSizeCorrection;
  }
 else   if (speed < 83f / 3.6) {
    return 14 + screenSizeCorrection;
  }
  return 13 + screenSizeCorrection;
}
