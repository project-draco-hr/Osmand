{
  final int itemId=item.getItemId();
  OsmandMapTileView mapView=mapActivity.getMapView();
  if (itemId == R.id.map_show_settings) {
    final Intent intentSettings=new Intent(mapActivity,OsmandIntents.getSettingsActivity());
    mapActivity.startActivity(intentSettings);
    return true;
  }
 else   if (itemId == R.id.map_where_am_i) {
    if (getMyApplication().accessibilityEnabled()) {
      whereAmIDialog();
    }
 else {
      mapActivity.backToLocationImpl();
    }
    return true;
  }
 else   if (itemId == R.id.map_show_gps_status) {
    startGpsStatusIntent();
    return true;
  }
 else   if (itemId == R.id.map_specify_point) {
    Intent newIntent=new Intent(mapActivity,OsmandIntents.getSearchActivity());
    LatLon loc=mapActivity.getMapLocation();
    newIntent.putExtra(SearchActivity.SEARCH_LAT,loc.getLatitude());
    newIntent.putExtra(SearchActivity.SEARCH_LON,loc.getLongitude());
    newIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    mapActivity.startActivity(newIntent);
    return true;
  }
 else {
    if (itemId == R.id.map_get_directions) {
      if (routingHelper.isRouteCalculated()) {
        aboutRoute();
      }
 else {
        Location loc=mapActivity.getLastKnownLocation();
        if (loc != null) {
          getDirections(loc.getLatitude(),loc.getLongitude(),true);
        }
 else {
          getDirections(mapView.getLatitude(),mapView.getLongitude(),true);
        }
      }
      return true;
    }
 else     if (itemId == R.id.map_layers) {
      mapActivity.getMapLayers().openLayerSelectionDialog(mapView);
      return true;
    }
 else     if (itemId == R.id.map_mute) {
      routingHelper.getVoiceRouter().setMute(!routingHelper.getVoiceRouter().isMute());
      return true;
    }
 else     if (itemId == R.id.map_navigate_to_point) {
      if (mapActivity.getMapLayers().getNavigationLayer().getPointToNavigate() != null) {
        if (routingHelper.isRouteCalculated() || routingHelper.isFollowingMode() || routingHelper.isRouteBeingCalculated()) {
          routingHelper.setFinalAndCurrentLocation(null,routingHelper.getCurrentLocation(),routingHelper.getCurrentGPXRoute());
          boolean changed=settings.APPLICATION_MODE.set(settings.PREV_APPLICATION_MODE.get());
          mapActivity.updateApplicationModeSettings();
          mapView.refreshMap(changed);
        }
 else {
          mapActivity.navigateToPoint(null);
        }
      }
 else {
        mapActivity.navigateToPoint(new LatLon(mapView.getLatitude(),mapView.getLongitude()));
      }
      mapView.refreshMap();
      return true;
    }
 else     if (itemId == R.id.map_show_point_options) {
      contextMenuPoint(mapView.getLatitude(),mapView.getLongitude());
      return true;
    }
 else     if (itemId == R.id.map_animate_route) {
      routeAnimation.startStopRouteAnimation(routingHelper,mapActivity);
      return true;
    }
 else {
      return OsmandPlugin.registerOnOptionsMenuItemSelected(mapActivity,itemId);
    }
  }
}
