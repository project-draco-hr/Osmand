{
  final List<IndexItem> filtered=new ArrayList<IndexItem>();
  if (type == DownloadActivityType.SRTM_FILE) {
    Map<String,String> indexFileNames=getMyApplication().getResourceManager().getIndexFileNames();
    if (cachedSRTMFiles == null) {
      cachedSRTMFiles=new ArrayList<SrtmIndexItem>();
      List<RegionCountry> countries=RegionRegistry.getRegionRegistry().getCountries();
      for (      RegionCountry rc : countries) {
        if (rc.tiles.size() > 35) {
          for (          RegionCountry ch : rc.getSubRegions()) {
            cachedSRTMFiles.add(new SrtmIndexItem(ch,indexFileNames));
          }
        }
 else {
          cachedSRTMFiles.add(new SrtmIndexItem(rc,indexFileNames));
        }
      }
      filtered.addAll(cachedSRTMFiles);
    }
 else {
      for (      SrtmIndexItem s : cachedSRTMFiles) {
        s.updateExistingTiles(indexFileNames);
        filtered.add(s);
      }
    }
  }
  List<IndexItem> cachedIndexFiles=downloadListIndexThread.getCachedIndexFiles();
  if (cachedIndexFiles != null) {
    for (    IndexItem file : cachedIndexFiles) {
      if (file.getType() == type) {
        filtered.add(file);
      }
    }
  }
  return filtered;
}
