{
  hasExternalStoragePermission=DownloadActivity.hasPermissionToWriteExternalStorage(getActivity());
  internalStorage=getInternalStorageDirectory(getActivity());
  sharedStorage=getSharedStorageDirectory(getActivity());
  if (hasExternalStoragePermission) {
    externalStorage=getMyApplication().getSettings().getSecondaryStorage();
  }
  Bundle args=null;
  if (savedInstanceState != null) {
    args=savedInstanceState;
  }
 else   if (getArguments() != null) {
    args=getArguments();
  }
  if (args != null) {
    storageReadOnly=args.getBoolean(STORAGE_READOLNY_KEY);
  }
  final View view=inflater.inflate(R.layout.fragment_data_storage_place_dialog,container,false);
  ((ImageView)view.findViewById(R.id.folderIconImageView)).setImageDrawable(getIcon(R.drawable.ic_action_folder,R.color.map_widget_blue));
  if (storageReadOnly) {
    ((TextView)view.findViewById(R.id.description)).setText(getString(R.string.storage_directory_readonly_desc));
  }
  View internalStorageRow=view.findViewById(R.id.deviceMemoryRow);
  internalStorageRow.setOnClickListener(internalMemoryOnClickListener);
  ImageView internalStorageImageView=(ImageView)view.findViewById(R.id.deviceMemoryImageView);
  internalStorageImageView.setImageDrawable(getContentIcon(R.drawable.ic_sdcard));
  TextView internalStorageDescription=(TextView)view.findViewById(R.id.deviceMemoryDescription);
  internalStorageDescription.setText(getFreeSpace(internalStorage));
  View sharedMemoryRow=view.findViewById(R.id.sharedMemoryRow);
  sharedMemoryRow.setOnClickListener(sharedMemoryOnClickListener);
  ImageView sharedMemoryImageView=(ImageView)view.findViewById(R.id.sharedMemoryImageView);
  sharedMemoryImageView.setImageDrawable(getContentIcon(R.drawable.ic_sdcard));
  TextView sharedMemoryDescription=(TextView)view.findViewById(R.id.sharedMemoryDescription);
  sharedMemoryDescription.setText(getFreeSpace(sharedStorage));
  View memoryStickRow=view.findViewById(R.id.memoryStickRow);
  if (hasExternalStoragePermission) {
    memoryStickRow.setOnClickListener(externalMemoryOnClickListener);
    ImageView memoryStickImageView=(ImageView)view.findViewById(R.id.memoryStickImageView);
    memoryStickImageView.setImageDrawable(getContentIcon(R.drawable.ic_sdcard));
    TextView memoryStickDescription=(TextView)view.findViewById(R.id.memoryStickDescription);
    memoryStickDescription.setText(getFreeSpace(externalStorage));
  }
 else {
    view.findViewById(R.id.divExtStorage).setVisibility(View.GONE);
    memoryStickRow.setVisibility(View.GONE);
  }
  final ImageButton closeImageButton=(ImageButton)view.findViewById(R.id.closeImageButton);
  closeImageButton.setImageDrawable(getContentIcon(R.drawable.ic_action_remove_dark));
  closeImageButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      isInterestedInFirstTime=false;
      dismiss();
    }
  }
);
  return view;
}
