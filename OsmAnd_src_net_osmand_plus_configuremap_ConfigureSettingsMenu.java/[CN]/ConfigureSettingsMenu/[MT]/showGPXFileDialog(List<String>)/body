{
  CallbackWithObject<GPXUtilities.GPXFile[]> callbackWithObject=new CallbackWithObject<GPXUtilities.GPXFile[]>(){
    @Override public boolean processResult(    GPXUtilities.GPXFile[] result){
      GPXUtilities.WptPt locToShow=null;
      for (      GPXUtilities.GPXFile g : result) {
        if (g.showCurrentTrack) {
          if (!app.getSettings().SAVE_TRACK_TO_GPX.get() && !app.getSettings().SAVE_GLOBAL_TRACK_TO_GPX.get()) {
            AccessibleToast.makeText(app.getMapActivity(),R.string.gpx_monitoring_disabled_warn,Toast.LENGTH_SHORT).show();
          }
          break;
        }
        if (!g.showCurrentTrack || locToShow == null) {
          locToShow=g.findPointToShow();
        }
      }
      app.getSelectedGpxHelper().setGpxFileToDisplay(result);
      listView.setAdapter(createSettingsAdapter());
      return true;
    }
  }
;
  AlertDialog dialog;
  if (files == null) {
    dialog=GpxUiHelper.selectGPXFile(app.getMapActivity(),true,true,callbackWithObject);
  }
 else {
    dialog=GpxUiHelper.selectGPXFile(files,app.getMapActivity(),true,true,callbackWithObject);
  }
  if (dialog != null) {
    dialog.setOnKeyListener(new DialogInterface.OnKeyListener(){
      @Override public boolean onKey(      DialogInterface dialogInterface,      int i,      KeyEvent event){
        if (i == KeyEvent.KEYCODE_BACK && event.getAction() == KeyEvent.ACTION_UP && !event.isCanceled()) {
          dialogInterface.cancel();
          listView.setAdapter(createSettingsAdapter());
          return true;
        }
        return false;
      }
    }
);
  }
}
