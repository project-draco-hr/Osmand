{
  super(context,attrs,defStyle);
  TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.CompatTextView,defStyle,0);
  final int ap=a.getResourceId(R.styleable.CompatTextView_android_textAppearance,-1);
  a.recycle();
  if (ap != -1) {
    TypedArray appearance=context.obtainStyledAttributes(ap,R.styleable.TextAppearance);
    if (appearance.hasValue(R.styleable.TextAppearance_textAllCaps)) {
      setAllCaps(appearance.getBoolean(R.styleable.TextAppearance_textAllCaps,false));
    }
    appearance.recycle();
  }
  a=context.obtainStyledAttributes(attrs,R.styleable.CompatTextView,defStyle,0);
  if (a.hasValue(R.styleable.CompatTextView_textAllCaps)) {
    setAllCaps(a.getBoolean(R.styleable.CompatTextView_textAllCaps,false));
  }
  a.recycle();
}
