{
  RendererRegistry registry=RendererRegistry.getRegistry();
  String name=registry.getCurrentSelectedRenderer().name;
  boolean day=true;
  if (!currentRenderName.equals(name)) {
    currentRenderName=name;
    if (registry.hasDayNightRenderer(name)) {
      if (dayNightMode.isDay()) {
        day=true;
      }
 else       if (dayNightMode.isNight()) {
        day=false;
      }
 else       if (dayNightMode.isAuto()) {
        daynightcheck=true;
      }
 else       if (dayNightMode.isSensor()) {
        sensorcheck=true;
        registerServiceListener();
      }
    }
  }
  if (daynightcheck) {
    LocationManager locationProvider=(LocationManager)osmandApplication.getSystemService(Context.LOCATION_SERVICE);
    try {
      Location lastKnownLocation=locationProvider.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
      SunriseSunset daynightSwitch=new SunriseSunset(lastKnownLocation.getLatitude(),lastKnownLocation.getLongitude(),new Date(),TimeZone.getDefault().getRawOffset());
      day=daynightSwitch.isDaytime();
      log.debug("Sunrise/sunset setting to day: " + day);
    }
 catch (    IllegalArgumentException e) {
      log.warn("Network location provider not available");
      daynightcheck=false;
    }
catch (    SecurityException e) {
      log.warn("Missing permitions to get actual location!");
      daynightcheck=false;
    }
  }
  if (sensorcheck) {
    day=lux > SensorManager.LIGHT_CLOUDY;
    log.debug("lux value:" + lux + " setting to day: "+ day);
  }
  return day;
}
