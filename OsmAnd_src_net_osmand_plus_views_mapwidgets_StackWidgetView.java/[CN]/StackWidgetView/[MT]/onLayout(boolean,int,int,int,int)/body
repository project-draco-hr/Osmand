{
  int y=0;
  int cw=right - left;
  for (  View c : stackViews) {
    if (c.getVisibility() != View.GONE) {
      if (y == 0) {
        y+=c.getPaddingTop();
      }
      y-=MAGIC_CONSTANT_STACK;
      c.layout(0,y,cw,y + c.getMeasuredHeight());
      y+=c.getMeasuredHeight();
      y-=c.getPaddingBottom();
    }
  }
  for (  View c : collapsedViews) {
    if (!isCollapsed) {
      if (c.getVisibility() != View.GONE) {
        if (y == 0) {
          y+=c.getPaddingTop();
        }
        y-=MAGIC_CONSTANT_STACK;
        c.layout(0,y,cw,y + c.getMeasuredHeight());
        y+=c.getMeasuredHeight();
        y-=c.getPaddingBottom();
      }
    }
 else {
      c.layout(0,0,0,0);
      if (y == 0) {
        y+=c.getPaddingTop();
      }
    }
  }
  if (isCollapsible) {
    y-=MAGIC_CONSTANT_STACK;
    expandView.setVisibility(VISIBLE);
    int w=expandView.getDrawable().getMinimumWidth();
    int h=expandView.getDrawable().getMinimumHeight();
    expandView.layout((cw - w) / 2,y,(cw + w) / 2,y + h);
  }
 else {
    expandView.setVisibility(GONE);
  }
}
