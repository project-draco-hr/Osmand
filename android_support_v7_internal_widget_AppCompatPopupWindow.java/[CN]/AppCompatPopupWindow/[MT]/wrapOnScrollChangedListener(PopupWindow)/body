{
  try {
    final Field fieldAnchor=PopupWindow.class.getDeclaredField("mAnchor");
    fieldAnchor.setAccessible(true);
    final Field fieldListener=PopupWindow.class.getDeclaredField("mOnScrollChangedListener");
    fieldListener.setAccessible(true);
    final OnScrollChangedListener originalListener=(OnScrollChangedListener)fieldListener.get(popup);
    fieldListener.set(popup,new OnScrollChangedListener(){
      @Override public void onScrollChanged(){
        try {
          WeakReference<View> mAnchor=(WeakReference<View>)fieldAnchor.get(popup);
          if (mAnchor == null || mAnchor.get() == null) {
            return;
          }
 else {
            originalListener.onScrollChanged();
          }
        }
 catch (        IllegalAccessException e) {
        }
      }
    }
);
  }
 catch (  Exception e) {
    Log.d(TAG,"Exception while installing workaround OnScrollChangedListener",e);
  }
}
