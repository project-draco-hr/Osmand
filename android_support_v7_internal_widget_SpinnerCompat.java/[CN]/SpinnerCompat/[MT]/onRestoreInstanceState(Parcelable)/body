{
  SavedState ss=(SavedState)state;
  super.onRestoreInstanceState(ss.getSuperState());
  if (ss.showDropdown) {
    ViewTreeObserver vto=getViewTreeObserver();
    if (vto != null) {
      final ViewTreeObserver.OnGlobalLayoutListener listener=new ViewTreeObserver.OnGlobalLayoutListener(){
        @Override public void onGlobalLayout(){
          if (!mPopup.isShowing()) {
            mPopup.show();
          }
          final ViewTreeObserver vto=getViewTreeObserver();
          if (vto != null) {
            vto.removeGlobalOnLayoutListener(this);
          }
        }
      }
;
      vto.addOnGlobalLayoutListener(listener);
    }
  }
}
