{
  if (this.descriptor != null) {
    throw new IllegalStateException("Already initialized.");
  }
  if (!descriptor.isExtension()) {
    throw new IllegalArgumentException("GeneratedExtension given a regular (non-extension) field.");
  }
  this.descriptor=descriptor;
  this.type=type;
switch (descriptor.getJavaType()) {
case MESSAGE:
    enumValueOf=null;
  enumGetValueDescriptor=null;
messageDefaultInstance=(Message)invokeOrDie(getMethodOrDie(type,"getDefaultInstance"),null);
if (messageDefaultInstance == null) {
throw new IllegalStateException(type.getName() + ".getDefaultInstance() returned null.");
}
break;
case ENUM:
enumValueOf=getMethodOrDie(type,"valueOf",EnumValueDescriptor.class);
enumGetValueDescriptor=getMethodOrDie(type,"getValueDescriptor");
messageDefaultInstance=null;
break;
default :
enumValueOf=null;
enumGetValueDescriptor=null;
messageDefaultInstance=null;
break;
}
}
