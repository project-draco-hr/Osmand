{
  long locationTime=System.currentTimeMillis();
  OsmandSettings settings=ctx.getSettings();
  boolean record=false;
  if (OsmAndLocationProvider.isPointAccurateForRouting(location) && OsmandPlugin.getEnabledPlugin(OsmandMonitoringPlugin.class) != null) {
    if (settings.SAVE_TRACK_TO_GPX.get() && locationTime - lastTimeUpdated > settings.SAVE_TRACK_INTERVAL.get()) {
      record=true;
    }
 else     if (settings.SAVE_GLOBAL_TRACK_TO_GPX.get() && locationTime - lastTimeUpdated > settings.SAVE_GLOBAL_TRACK_INTERVAL.get()) {
      record=true;
    }
  }
  if (record) {
    insertData(location.getLatitude(),location.getLongitude(),location.getAltitude(),location.getSpeed(),location.getAccuracy(),locationTime,settings);
  }
}
