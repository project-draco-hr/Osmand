{
  super.onDraw(canvas);
  if (routeLayer != null) {
    int d=routeLayer.getHelper().getDistanceToNextRouteDirection();
    if (showMiniMap || d == 0) {
      if (!routeLayer.getPath().isEmpty()) {
        canvas.save();
        canvas.translate(centerMiniRouteX - view.getCenterPointX(),centerMiniRouteY - view.getCenterPointY());
        canvas.scale(scaleMiniRoute,scaleMiniRoute,view.getCenterPointX(),view.getCenterPointY());
        canvas.rotate(view.getRotate(),view.getCenterPointX(),view.getCenterPointY());
        canvas.drawCircle(view.getCenterPointX(),view.getCenterPointY(),3 / scaleMiniRoute,fillBlack);
        canvas.drawPath(routeLayer.getPath(),paintMiniRoute);
        canvas.restore();
      }
    }
 else {
      RouteDirectionInfo next=routeLayer.getHelper().getNextRouteDirectionInfo();
      if (next != null) {
        if (!Algoritms.objectEquals(cachedTurnType,next.turnType)) {
          cachedTurnType=next.turnType;
          TurnPathHelper.calcTurnPath(pathForTurn,cachedTurnType,pathTransform);
          if (cachedTurnType.getExitOut() > 0) {
            cachedExitOut=cachedTurnType.getExitOut() + "";
          }
 else {
            cachedExitOut=null;
          }
        }
        canvas.drawPath(pathForTurn,paintRouteDirection);
        canvas.drawPath(pathForTurn,paintBlack);
        if (cachedExitOut != null) {
          canvas.drawText(cachedExitOut,(getLeft() + getRight()) / 2 - 6 * scaleCoefficient,(getTop() + getBottom()) / 2 - 9 * scaleCoefficient,paintBlack);
        }
        String text=OsmAndFormatter.getFormattedDistance(cachedMeters,map);
        String subtext=null;
        int ls=text.lastIndexOf(' ');
        if (ls != -1) {
          subtext=text.substring(ls + 1);
          text=text.substring(0,ls);
        }
        int margin=(int)(10 * scaleCoefficient);
        canvas.drawText(text,margin + getLeft(),getBottom() - 3 * scaleCoefficient,textPaint);
        if (subtext != null) {
          canvas.drawText(subtext,getLeft() + margin + 2 * scaleCoefficient + textPaint.measureText(text),getBottom() - 3 * scaleCoefficient,subtextPaint);
        }
      }
    }
  }
}
