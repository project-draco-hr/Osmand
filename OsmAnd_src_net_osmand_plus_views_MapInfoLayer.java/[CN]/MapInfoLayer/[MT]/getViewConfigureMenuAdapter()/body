{
  ContextMenuAdapter cm=new ContextMenuAdapter(view.getContext());
  cm.setDefaultLayoutId(R.layout.drawer_list_item);
  cm.item(R.string.layer_map_appearance).icons(R.drawable.ic_back_drawer_dark,R.drawable.ic_back_drawer_white).listen(new OnContextMenuClick(){
    @Override public boolean onContextMenuClick(    ArrayAdapter<?> adapter,    int itemId,    int pos,    boolean isChecked){
      map.getMapActions().onDrawerBack();
      return false;
    }
  }
).reg();
  cm.item(R.string.app_modes_choose).layout(R.layout.mode_toggles).reg();
  cm.setChangeAppModeListener(new ConfigureMapMenu.OnClickListener(){
    @Override public void onClick(    boolean allModes){
      map.getMapActions().prepareOptionsMenu(getViewConfigureMenuAdapter());
    }
  }
);
  cm.item(R.string.map_widget_reset).icons(R.drawable.widget_reset_to_default_dark,R.drawable.widget_reset_to_default_light).listen(new OnContextMenuClick(){
    @Override public boolean onContextMenuClick(    ArrayAdapter<?> adapter,    int itemId,    int pos,    boolean isChecked){
      mapInfoControls.resetToDefault();
      recreateControls();
      adapter.notifyDataSetInvalidated();
      return false;
    }
  }
).reg();
  final ApplicationMode mode=settings.getApplicationMode();
  mapInfoControls.addControls(this,cm,mode);
  return cm;
}
