{
  OsmandApplication app=activity.getMyApplication();
  OsmandSettings settings=app.getSettings();
  LayerMenuListener l=new LayerMenuListener(activity,adapter);
  adapter.item(R.string.shared_string_show).setCategory(true).layout(R.layout.drawer_list_sub_header).reg();
  adapter.item(R.string.layer_poi).selected(settings.SELECTED_POI_FILTER_FOR_MAP.get() != null ? 1 : 0).colorIcon(R.drawable.ic_action_info_dark).listen(l).reg();
  adapter.item(R.string.layer_amenity_label).selected(settings.SHOW_POI_LABEL.get() ? 1 : 0).colorIcon(R.drawable.ic_action_text_dark).listen(l).reg();
  adapter.item(R.string.shared_string_favorites).selected(settings.SHOW_FAVORITES.get() ? 1 : 0).colorIcon(R.drawable.ic_action_fav_dark).listen(l).reg();
  adapter.item(R.string.layer_gpx_layer).selected(app.getSelectedGpxHelper().isShowingAnyGpxFiles() ? 1 : 0).colorIcon(R.drawable.ic_action_polygom_dark).listen(l).reg();
  adapter.item(R.string.layer_map).colorIcon(R.drawable.ic_world_globe_dark).listen(l).reg();
  if (TransportRouteHelper.getInstance().routeIsCalculated()) {
    adapter.item(R.string.layer_transport_route).selected(1).colorIcon(R.drawable.ic_action_bus_dark).listen(l).reg();
  }
  OsmandPlugin.registerLayerContextMenu(activity.getMapView(),adapter,activity);
  app.getAppCustomization().prepareLayerContextMenu(activity,adapter);
}
