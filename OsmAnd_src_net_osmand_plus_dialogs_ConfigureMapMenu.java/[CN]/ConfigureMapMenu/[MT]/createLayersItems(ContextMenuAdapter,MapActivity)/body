{
  OsmandApplication app=activity.getMyApplication();
  OsmandSettings settings=app.getSettings();
  LayerMenuListener l=new LayerMenuListener(activity,adapter);
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.shared_string_show,activity).setCategory(true).setLayout(R.layout.drawer_list_sub_header).createItem());
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.layer_poi,activity).setSelected(settings.SELECTED_POI_FILTER_FOR_MAP.get() != null).setIcon(R.drawable.ic_action_info_dark).setListener(l).createItem());
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.layer_amenity_label,activity).setSelected(settings.SHOW_POI_LABEL.get()).setIcon(R.drawable.ic_action_text_dark).setListener(l).createItem());
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.shared_string_favorites,activity).setSelected(settings.SHOW_FAVORITES.get()).setIcon(R.drawable.ic_action_fav_dark).setListener(l).createItem());
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.layer_gpx_layer,activity).setSelected(app.getSelectedGpxHelper().isShowingAnyGpxFiles()).setIcon(R.drawable.ic_action_polygom_dark).setListener(l).createItem());
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.layer_map,activity).setIcon(R.drawable.ic_world_globe_dark).setListener(l).createItem());
  if (TransportRouteHelper.getInstance().routeIsCalculated()) {
    adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.layer_transport_route,activity).setSelected(true).setIcon(R.drawable.ic_action_bus_dark).setListener(l).createItem());
  }
  OsmandPlugin.registerLayerContextMenu(activity.getMapView(),adapter,activity);
  app.getAppCustomization().prepareLayerContextMenu(activity,adapter);
}
