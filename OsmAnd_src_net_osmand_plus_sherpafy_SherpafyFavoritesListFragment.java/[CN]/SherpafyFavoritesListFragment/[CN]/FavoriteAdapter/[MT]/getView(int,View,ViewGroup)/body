{
  View row=convertView;
  if (row == null) {
    LayoutInflater inflater=getActivity().getLayoutInflater();
    row=inflater.inflate(R.layout.sherpafy_stage_list_item,parent,false);
  }
  Object ti=getItem(position);
  TextView header=(TextView)row.findViewById(R.id.HeaderText);
  ImageView img=(ImageView)row.findViewById(R.id.Icon);
  TextView text=(TextView)row.findViewById(R.id.Text);
  TextView addtext=(TextView)row.findViewById(R.id.AdditionalText);
  if (ti instanceof StageFavoriteGroup) {
    addtext.setText("");
    text.setTextColor(((StageFavoriteGroup)ti).getColor());
    text.setText(((StageFavoriteGroup)ti).getName());
    header.setVisibility(View.GONE);
    img.setVisibility(View.GONE);
    img.setImageDrawable(null);
  }
 else   if (ti instanceof StageFavorite) {
    StageFavorite sf=((StageFavorite)ti);
    if (stage.startPoint != null && sf.location != null) {
      double d=MapUtils.getDistance(stage.startPoint,sf.location);
      addtext.setText(OsmAndFormatter.getFormattedDistance((float)d,getMyApplication()));
    }
 else {
      addtext.setText("");
    }
    header.setVisibility(View.VISIBLE);
    header.setText(sf.getName());
    text.setTextColor(StageImageDrawable.MENU_COLOR);
    text.setText(sf.getShortDescription());
    img.setVisibility(View.VISIBLE);
    img.setImageDrawable(new StageImageDrawable(getActivity(),sf.getGroup().getColor(),sf.getName().substring(0,1),0));
  }
  return row;
}
