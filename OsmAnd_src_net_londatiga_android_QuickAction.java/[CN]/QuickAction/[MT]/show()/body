{
  preShow();
  int[] location=new int[2];
  anchor.getLocationOnScreen(location);
  Rect anchorRect=new Rect(location[0],location[1],location[0] + anchor.getWidth(),location[1] + anchor.getHeight());
  root.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT));
  root.measure(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);
  int rootWidth=root.getMeasuredWidth();
  int rootHeight=root.getMeasuredHeight();
  int screenWidth=windowManager.getDefaultDisplay().getWidth();
  int xPos=(screenWidth - rootWidth) / 2;
  int yPos=anchorRect.top - rootHeight;
  boolean onTop=true;
  if (rootHeight > anchor.getTop() && !this.onTop) {
    yPos=anchorRect.bottom;
    onTop=false;
  }
  showArrow(((onTop) ? R.id.arrow_down : R.id.arrow_up),anchorRect.centerX());
  setAnimationStyle(screenWidth,anchorRect.centerX(),onTop);
  createActionList();
  window.showAtLocation(this.anchor,Gravity.NO_GRAVITY,xPos,yPos);
  if (animateTrack)   mTrack.startAnimation(mTrackAnim);
}
