{
  if (mVisibilityAnim != null) {
    mVisibilityAnim.cancel();
  }
  if (visibility == VISIBLE) {
    if (getVisibility() != VISIBLE) {
      ViewCompat.setAlpha(this,0f);
      if (mSplitView != null && mMenuView != null) {
        ViewCompat.setAlpha(mMenuView,0f);
      }
    }
    ViewPropertyAnimatorCompat anim=ViewCompat.animate(this).alpha(1f);
    anim.setDuration(FADE_DURATION);
    anim.setInterpolator(sAlphaInterpolator);
    if (mSplitView != null && mMenuView != null) {
      ViewPropertyAnimatorCompatSet set=new ViewPropertyAnimatorCompatSet();
      ViewPropertyAnimatorCompat splitAnim=ViewCompat.animate(mMenuView).alpha(1f);
      splitAnim.setDuration(FADE_DURATION);
      set.setListener(mVisAnimListener.withFinalVisibility(anim,visibility));
      set.play(anim).play(splitAnim);
      set.start();
    }
 else {
      anim.setListener(mVisAnimListener.withFinalVisibility(anim,visibility));
      anim.start();
    }
  }
 else {
    ViewPropertyAnimatorCompat anim=ViewCompat.animate(this).alpha(0f);
    anim.setDuration(FADE_DURATION);
    anim.setInterpolator(sAlphaInterpolator);
    if (mSplitView != null && mMenuView != null) {
      ViewPropertyAnimatorCompatSet set=new ViewPropertyAnimatorCompatSet();
      ViewPropertyAnimatorCompat splitAnim=ViewCompat.animate(mMenuView).alpha(0f);
      splitAnim.setDuration(FADE_DURATION);
      set.setListener(mVisAnimListener.withFinalVisibility(anim,visibility));
      set.play(anim).play(splitAnim);
      set.start();
    }
 else {
      anim.setListener(mVisAnimListener.withFinalVisibility(anim,visibility));
      anim.start();
    }
  }
}
