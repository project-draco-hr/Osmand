{
  if (!uploadIndexes) {
    return;
  }
  String summary;
  double mbLengh=(double)f.length() / MB;
  boolean zip=true;
  String regionName=f.getName().substring(0,f.getName().lastIndexOf('_',f.getName().indexOf('.')));
  if (f.getName().endsWith(IndexConstants.POI_INDEX_EXT) || f.getName().endsWith(IndexConstants.POI_INDEX_EXT_ZIP)) {
    summary="POI index for ";
  }
 else   if (f.getName().endsWith(IndexConstants.BINARY_MAP_INDEX_EXT) || f.getName().endsWith(IndexConstants.BINARY_MAP_INDEX_EXT_ZIP)) {
    boolean addr=indexAddress;
    boolean trans=indexTransport;
    boolean map=indexMap;
    RandomAccessFile raf=null;
    if (f.getName().endsWith(IndexConstants.BINARY_MAP_INDEX_EXT)) {
      try {
        raf=new RandomAccessFile(f,"r");
        BinaryMapIndexReader reader=new BinaryMapIndexReader(raf);
        trans=reader.hasTransportData();
        map=reader.containsMapData();
        addr=reader.containsAddressData();
        reader.close();
      }
 catch (      Exception e) {
        log.info("Exception",e);
        if (raf != null) {
          try {
            raf.close();
          }
 catch (          IOException e1) {
          }
        }
      }
    }
    summary=" index for ";
    boolean fir=true;
    if (addr) {
      summary="Address" + (fir ? "" : ", ") + summary;
      fir=false;
    }
    if (trans) {
      summary="Transport" + (fir ? "" : ", ") + summary;
      fir=false;
    }
    if (map) {
      summary="Map" + (fir ? "" : ", ") + summary;
      fir=false;
    }
  }
 else {
    return;
  }
  if (mbLengh < MIN_SIZE_TO_UPLOAD) {
    return;
  }
  if (mbLengh > MIN_SIZE_TO_NOT_ZIP && (f.getName().endsWith(".odb") || f.getName().endsWith(".obf")) && zip) {
    String n=f.getName();
    if (f.getName().endsWith(".odb")) {
      n=f.getName().substring(0,f.getName().length() - 4);
    }
    String zipFileName=n + ".zip";
    File zFile=new File(f.getParentFile(),zipFileName);
    log.info("Zipping file " + f.getName());
    try {
      ZipOutputStream zout=new ZipOutputStream(new FileOutputStream(zFile));
      zout.setLevel(9);
      zout.putNextEntry(new ZipEntry(f.getName()));
      FileInputStream is=new FileInputStream(f);
      byte[] BUFFER=new byte[8192];
      int read=0;
      while ((read=is.read(BUFFER)) != -1) {
        zout.write(BUFFER,0,read);
      }
      is.close();
      zout.close();
    }
 catch (    IOException e) {
      log.error("Exception while zipping file",e);
    }
    if (f.delete()) {
      log.info("Source odb file was deleted");
    }
    f=zFile;
  }
  summary+=regionName;
  summary=summary.replace('_',' ');
  List<File> splittedFiles=Collections.emptyList();
  try {
    splittedFiles=splitFiles(f);
    boolean uploaded=true;
    for (    File fs : splittedFiles) {
      uploaded&=uploadFileToServer(fs,f,summary);
    }
    if (uploaded && deleteFilesAfterUploading && f.exists()) {
      f.delete();
    }
    alreadyUploadedFiles.add(f.getName());
  }
 catch (  IOException e) {
    log.error("Input/output exception uploading " + f.getName(),e);
  }
 finally {
    for (    File fs : splittedFiles) {
      if (!fs.equals(f)) {
        fs.delete();
      }
    }
  }
}
