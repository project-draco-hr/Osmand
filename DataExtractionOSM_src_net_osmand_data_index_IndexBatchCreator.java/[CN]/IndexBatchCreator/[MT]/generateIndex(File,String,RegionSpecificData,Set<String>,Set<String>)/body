{
  if (!generateIndexes) {
    return;
  }
  try {
    RTree.clearCache();
    String regionName=f.getName();
    System.out.println("-----------------------------------------------");
    System.out.println("----------- Generate " + f.getName());
    System.out.println("\n\n\n\n");
    int i=f.getName().indexOf('.');
    if (i > -1) {
      regionName=Algoritms.capitalizeFirstLetterAndLowercase(f.getName().substring(0,i));
    }
    if (Algoritms.isEmpty(rName)) {
      rName=regionName;
    }
 else {
      rName=Algoritms.capitalizeFirstLetterAndLowercase(rName);
    }
    IndexCreator indexCreator=new IndexCreator(workDir);
    indexCreator.setIndexAddress(indexAddress);
    indexCreator.setIndexPOI(indexPOI);
    indexCreator.setIndexTransport(indexTransport);
    indexCreator.setIndexMap(indexMap);
    indexCreator.setLastModifiedDate(f.lastModified());
    indexCreator.setNormalizeStreets(true);
    indexCreator.setSaveAddressWays(true);
    indexCreator.setRegionName(rName);
    if (regionSpecificData != null && regionSpecificData.cityAdminLevel != null) {
      indexCreator.setCityAdminLevel(regionSpecificData.cityAdminLevel);
    }
    if (zoomWaySmoothness != null) {
      indexCreator.setZoomWaySmothness(zoomWaySmoothness);
    }
    String poiFileName=regionName + "_" + IndexConstants.POI_TABLE_VERSION+ IndexConstants.POI_INDEX_EXT;
    indexCreator.setPoiFileName(poiFileName);
    String mapFileName=regionName + "_" + IndexConstants.BINARY_MAP_VERSION+ IndexConstants.BINARY_MAP_INDEX_EXT;
    indexCreator.setMapFileName(mapFileName);
    try {
      alreadyGeneratedFiles.add(f.getName());
      indexCreator.generateIndexes(f,new ConsoleProgressImplementation(3),null,mapZooms,types);
      File generated=new File(workDir,mapFileName);
      File ready=new File(indexDirFiles,mapFileName);
      generated.renameTo(ready);
      if (indexMap || indexAddress || indexTransport|| indexPOI) {
        uploadIndex(ready,alreadyUploadedFiles);
      }
    }
 catch (    Exception e) {
      log.error("Exception generating indexes for " + f.getName(),e);
    }
  }
 catch (  OutOfMemoryError e) {
    System.gc();
    log.error("OutOfMemory",e);
  }
  System.gc();
}
