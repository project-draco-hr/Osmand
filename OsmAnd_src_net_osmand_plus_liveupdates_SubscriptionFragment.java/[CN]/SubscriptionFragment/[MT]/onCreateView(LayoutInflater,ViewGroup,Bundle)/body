{
  View view=inflater.inflate(R.layout.subscription_fragment,container,false);
  ImageButton closeButton=(ImageButton)view.findViewById(R.id.closeButton);
  closeButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      dismiss();
    }
  }
);
  userName=settings.BILLING_USER_NAME.get();
  final EditText userNameEdit=(EditText)view.findViewById(R.id.userNameEdit);
  if (!Algorithms.isEmpty(userName)) {
    userNameEdit.setText(userName);
  }
  email=settings.BILLING_USER_EMAIL.get();
  final EditText emailEdit=(EditText)view.findViewById(R.id.emailEdit);
  if (!Algorithms.isEmpty(email)) {
    emailEdit.setText(email);
  }
  countrySelectionFragment.initCountries(getMyApplication());
  String countryDownloadName=settings.BILLING_USER_COUNTRY_DOWNLOAD_NAME.get();
  if (Algorithms.isEmpty(countryDownloadName)) {
    selectedCountryItem=countrySelectionFragment.getCountryItems().get(0);
  }
 else {
    selectedCountryItem=countrySelectionFragment.getCountryItem(countryDownloadName);
  }
  final EditText selectCountryEdit=(EditText)view.findViewById(R.id.selectCountryEdit);
  if (selectedCountryItem != null) {
    selectCountryEdit.setText(selectedCountryItem.getLocalName());
  }
  selectCountryEdit.setOnTouchListener(new View.OnTouchListener(){
    @Override public boolean onTouch(    View v,    MotionEvent event){
      if (event.getAction() == MotionEvent.ACTION_UP) {
        CountrySelectionFragment countryCountrySelectionFragment=countrySelectionFragment;
        countryCountrySelectionFragment.show(getChildFragmentManager(),"CountriesSearchSelectionFragment");
      }
      return false;
    }
  }
);
  updatePrice(view);
  final Button subscribeButton=(Button)view.findViewById(R.id.subscribeButton);
  final CheckBox hideUserNameCheckbox=(CheckBox)view.findViewById(R.id.hideUserNameCheckbox);
  boolean hideUserName=settings.BILLING_HIDE_USER_NAME.get();
  hideUserNameCheckbox.setChecked(hideUserName);
  subscribeButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      if (inAppHelper != null) {
        userName=userNameEdit.getText().toString().trim();
        email=emailEdit.getText().toString().trim();
        String countryName=selectedCountryItem != null ? selectedCountryItem.getLocalName() : "";
        String countryDownloadName=selectedCountryItem != null ? selectedCountryItem.getDownloadName() : "";
        if (Algorithms.isEmpty(email) || !AndroidUtils.isValidEmail(email)) {
          getMyApplication().showToastMessage("Please enter valid E-mail address");
          return;
        }
        if (Algorithms.isEmpty(userName) && !hideUserNameCheckbox.isChecked()) {
          getMyApplication().showToastMessage("Please enter Public Name");
          return;
        }
        settings.BILLING_USER_NAME.set(userName);
        settings.BILLING_USER_EMAIL.set(email);
        settings.BILLING_USER_COUNTRY.set(countryName);
        settings.BILLING_USER_COUNTRY_DOWNLOAD_NAME.set(countryDownloadName);
        settings.BILLING_HIDE_USER_NAME.set(hideUserNameCheckbox.isChecked());
        inAppHelper.purchaseLiveUpdates(getActivity(),email,userName,countryDownloadName);
      }
    }
  }
);
  setThemedDrawable((ImageView)view.findViewById(R.id.userNameIcon),R.drawable.ic_person);
  setThemedDrawable((ImageView)view.findViewById(R.id.emailIcon),R.drawable.ic_action_message);
  setThemedDrawable((ImageView)view.findViewById(R.id.countryIcon),R.drawable.ic_world_globe_dark);
  selectCountryEdit.setCompoundDrawablesWithIntrinsicBounds(null,null,getContentIcon(R.drawable.ic_action_arrow_drop_down),null);
  return view;
}
