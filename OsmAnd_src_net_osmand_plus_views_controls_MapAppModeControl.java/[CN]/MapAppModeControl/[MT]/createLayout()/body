{
  View settingsDlg=View.inflate(mapActivity,R.layout.plan_route_settings,null);
  final OsmandSettings settings=mapActivity.getMyApplication().getSettings();
  ApplicationMode am=settings.APPLICATION_MODE.get();
  final ListView lv=(ListView)settingsDlg.findViewById(android.R.id.list);
  final Set<ApplicationMode> selected=new HashSet<ApplicationMode>();
  selected.add(am);
  NavigateAction.prepareAppModeView(mapActivity,selected,false,(ViewGroup)settingsDlg.findViewById(R.id.TopBar),true,new View.OnClickListener(){
    @Override public void onClick(    View v){
      if (selected.size() > 0) {
        settings.APPLICATION_MODE.set(selected.iterator().next());
        mapActivity.getRoutingHelper().recalculateRouteDueToSettingsChange();
      }
    }
  }
);
  return settingsDlg;
}
