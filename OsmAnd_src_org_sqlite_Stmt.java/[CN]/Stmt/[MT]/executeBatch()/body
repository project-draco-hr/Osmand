{
  close();
  if (batch == null || batchPos == 0)   return new int[]{};
  int[] changes=new int[batchPos];
synchronized (db) {
    try {
      for (int i=0; i < changes.length; i++) {
        try {
          this.sql=(String)batch[i];
          db.prepare(this);
          changes[i]=db.executeUpdate(this,null);
        }
 catch (        SQLException e) {
          throw new BatchUpdateException("batch entry " + i + ": "+ e.getMessage(),changes);
        }
 finally {
          db.finalize(this);
        }
      }
    }
  finally {
      clearBatch();
    }
  }
  return changes;
}
