{
  final Amenity amenity=((AmenityAdapter)getListAdapter()).getItem(position);
  final OsmandSettings settings=app.getSettings();
  String poiSimpleFormat=OsmAndFormatter.getPoiStringWithoutType(amenity,app.getSettings().MAP_PREFERRED_LOCALE.get());
  PointDescription name=new PointDescription(PointDescription.POINT_TYPE_POI,poiSimpleFormat);
  int z=Math.max(16,settings.getLastKnownMapZoom());
  final PopupMenu optionsMenu=new PopupMenu(this,view);
  DirectionsDialogs.createDirectionsActionsPopUpMenu(optionsMenu,amenity.getLocation(),amenity,name,z,this,true);
  final String d=OsmAndFormatter.getAmenityDescriptionContent(getMyApplication(),amenity,false);
  if (d.toString().trim().length() > 0) {
    MenuItem item=optionsMenu.getMenu().add(R.string.poi_context_menu_showdescription).setIcon(getMyApplication().getIconsCache().getContentIcon(R.drawable.ic_action_note_dark));
    item.setOnMenuItemClickListener(new OnMenuItemClickListener(){
      @Override public boolean onMenuItemClick(      MenuItem item){
        SpannableString spannable=new SpannableString(d);
        Linkify.addLinks(spannable,Linkify.ALL);
        Builder bs=new AlertDialog.Builder(view.getContext());
        bs.setTitle(OsmAndFormatter.getPoiStringWithoutType(amenity,app.getSettings().MAP_PREFERRED_LOCALE.get()));
        bs.setMessage(spannable);
        AlertDialog dialog=bs.show();
        TextView textView=(TextView)dialog.findViewById(android.R.id.message);
        textView.setMovementMethod(LinkMovementMethod.getInstance());
        textView.setLinksClickable(true);
        return true;
      }
    }
);
  }
  if (((OsmandApplication)getApplication()).accessibilityEnabled()) {
    MenuItem item=optionsMenu.getMenu().add(R.string.show_details);
    item.setOnMenuItemClickListener(new OnMenuItemClickListener(){
      @Override public boolean onMenuItemClick(      MenuItem item){
        showPOIDetails(amenity,app.getSettings().MAP_PREFERRED_LOCALE.get());
        return true;
      }
    }
);
  }
  optionsMenu.show();
}
