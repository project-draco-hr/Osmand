{
  if (dialog != null) {
    dialog.hide();
    dialog=null;
  }
 else {
    final boolean switched=controlsLayer.switchToRoutePlanningLayout();
    dialog=createDialog();
    dialog.show();
    dialog.setOnDismissListener(new OnDismissListener(){
      @Override public void onDismiss(      DialogInterface dlg){
        dialog=null;
        if (switched) {
          controlsLayer.switchToRouteFollowingLayout();
        }
      }
    }
);
  }
}
