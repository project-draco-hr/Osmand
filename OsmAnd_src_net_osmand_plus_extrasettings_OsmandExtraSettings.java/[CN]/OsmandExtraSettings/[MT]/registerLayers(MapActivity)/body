{
  registerControls=true;
  final OsmandMapTileView view=activity.getMapView();
  final MapInfoLayer mapInfoLayer=activity.getMapLayers().getMapInfoLayer();
  final MapInfoControls mapInfoControls=mapInfoLayer.getMapInfoControls();
  final OsmandPreference<Float> textSizePref=view.getSettings().MAP_TEXT_SIZE;
  final MapInfoControlRegInfo textSize=mapInfoControls.registerAppearanceWidget(R.drawable.widget_text_size,R.string.map_text_size,"text_size",textSizePref);
  textSize.setStateChangeListener(new Runnable(){
    @Override public void run(){
      final Float[] floatValues=new Float[]{0.6f,0.8f,1.0f,1.2f,1.5f,1.75f,2f};
      String[] entries=new String[floatValues.length];
      for (int i=0; i < floatValues.length; i++) {
        entries[i]=(int)(floatValues[i] * 100) + " %";
      }
      Builder b=new AlertDialog.Builder(view.getContext());
      b.setTitle(R.string.map_text_size);
      int i=Arrays.binarySearch(floatValues,textSizePref.get());
      b.setSingleChoiceItems(entries,i,new OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          textSizePref.set(floatValues[which]);
          app.getResourceManager().getRenderer().clearCache();
          view.refreshMap(true);
          dialog.dismiss();
        }
      }
);
      b.show();
    }
  }
);
  final MapInfoControlRegInfo showRuler=mapInfoControls.registerAppearanceWidget(R.drawable.widget_ruler,R.string.map_widget_show_ruler,"showRuler",view.getSettings().SHOW_RULER);
  showRuler.setStateChangeListener(new Runnable(){
    @Override public void run(){
      view.getSettings().SHOW_RULER.set(!view.getSettings().SHOW_RULER.get());
      view.refreshMap();
    }
  }
);
  final MapInfoControlRegInfo transparent=mapInfoControls.registerAppearanceWidget(R.drawable.widget_transparent_skin,R.string.map_widget_transparent,"transparent",view.getSettings().TRANSPARENT_MAP_THEME);
  transparent.setStateChangeListener(new Runnable(){
    @Override public void run(){
      view.getSettings().TRANSPARENT_MAP_THEME.set(!view.getSettings().TRANSPARENT_MAP_THEME.get());
      mapInfoLayer.recreateControls();
    }
  }
);
  final MapInfoControlRegInfo showDestinationArrow=mapInfoControls.registerAppearanceWidget(0,R.string.map_widget_show_destionation_arrow,"show_destination_arrow",view.getSettings().SHOW_DESTINATION_ARROW);
  showDestinationArrow.setStateChangeListener(new Runnable(){
    @Override public void run(){
      view.getSettings().SHOW_DESTINATION_ARROW.set(!view.getSettings().SHOW_DESTINATION_ARROW.get());
      mapInfoLayer.recreateControls();
    }
  }
);
}
