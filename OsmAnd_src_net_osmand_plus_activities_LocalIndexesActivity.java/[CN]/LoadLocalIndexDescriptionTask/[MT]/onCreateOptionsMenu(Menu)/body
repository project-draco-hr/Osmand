{
  optionsMenuAdapter=new ContextMenuAdapter(this);
  OnContextMenuClick listener=new OnContextMenuClick(){
    @Override public void onContextMenuClick(    int itemId,    int pos,    boolean isChecked,    DialogInterface dialog){
      localOptionsMenu(itemId);
    }
  }
;
  optionsMenuAdapter.item(R.string.local_index_download).icons(R.drawable.a_9_av_download_dark,R.drawable.a_9_av_download_light).listen(listener).position(0).reg();
  optionsMenuAdapter.item(R.string.local_index_mi_reload).icons(R.drawable.a_1_navigation_refresh_dark,R.drawable.a_1_navigation_refresh_light).listen(listener).position(1).reg();
  optionsMenuAdapter.item(R.string.local_index_mi_backup).icons(R.drawable.a_8_images_rotate_left_dark,R.drawable.a_8_images_rotate_left_light).listen(listener).position(2).reg();
  optionsMenuAdapter.item(R.string.local_index_mi_restore).icons(R.drawable.a_8_images_rotate_right_dark,R.drawable.a_8_images_rotate_right_light).listen(listener).position(3).reg();
  optionsMenuAdapter.item(R.string.local_index_mi_delete).icons(R.drawable.a_5_content_discard_dark,R.drawable.a_5_content_discard_light).listen(listener).position(4).reg();
  OsmandPlugin.onOptionsMenuLocalIndexes(this,optionsMenuAdapter);
  int max=getResources().getInteger(R.integer.abs__max_action_buttons);
  SubMenu split=null;
  for (int j=0; j < optionsMenuAdapter.length(); j++) {
    MenuItem item;
    if (j + 1 >= max && optionsMenuAdapter.length() > max) {
      if (split == null) {
        split=menu.addSubMenu(0,1,0,R.string.default_buttons_other_actions);
        split.setIcon(isLightActionBar() ? R.drawable.abs__ic_menu_moreoverflow_holo_light : R.drawable.abs__ic_menu_moreoverflow_holo_dark);
        split.getItem().setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
      }
      item=split.add(0,optionsMenuAdapter.getItemId(j),j + 1,optionsMenuAdapter.getItemName(j));
      item.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
    }
 else {
      item=menu.add(0,optionsMenuAdapter.getItemId(j),j + 1,optionsMenuAdapter.getItemName(j));
      item.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
    }
    if (optionsMenuAdapter.getImageId(j,isLightActionBar()) != 0) {
      item.setIcon(optionsMenuAdapter.getImageId(j,isLightActionBar()));
    }
  }
  return true;
}
