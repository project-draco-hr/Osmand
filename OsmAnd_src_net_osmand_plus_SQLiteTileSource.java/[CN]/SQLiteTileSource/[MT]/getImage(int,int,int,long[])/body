{
  SQLiteConnection db=getDatabase();
  if (db == null) {
    return null;
  }
  long ts=System.currentTimeMillis();
  try {
    if (zoom <= maxZoom) {
      String[] params=new String[]{x + "",y + "",getFileZoom(zoom) + ""};
      boolean queryTime=timeHolder != null && timeHolder.length > 0 && timeSupported;
      SQLiteCursor cursor=db.rawQuery("SELECT image " + (queryTime ? ", time" : "") + "  FROM tiles WHERE x = ? AND y = ? AND z = ?",params);
      byte[] blob=null;
      if (cursor.moveToFirst()) {
        blob=cursor.getBlob(0);
        if (queryTime) {
          timeHolder[0]=cursor.getLong(1);
        }
      }
      cursor.close();
      if (blob != null) {
        Bitmap bmp=null;
        bmp=BitmapFactory.decodeByteArray(blob,0,blob.length);
        if (bmp == null) {
          db.execSQL("DELETE FROM tiles WHERE x = ? AND y = ? AND z = ?",params);
        }
        return bmp;
      }
    }
    return null;
  }
  finally {
    if (log.isDebugEnabled()) {
      log.debug("Load tile " + x + "/"+ y+ "/"+ zoom+ " for "+ (System.currentTimeMillis() - ts)+ " ms ");
    }
  }
}
