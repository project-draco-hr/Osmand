{
  BaseMapLayer mainLayer=view.getMainLayer();
  boolean zoomInEnabled=mainLayer != null && tileBox.getZoom() < mainLayer.getMaximumShownMapZoom();
  boolean zoomOutEnabled=mainLayer != null && tileBox.getZoom() > mainLayer.getMinimumShownMapZoom();
  if (zoomInButton.isEnabled() != zoomInEnabled) {
    zoomInButton.setEnabled(zoomInEnabled);
  }
  if (zoomOutButton.isEnabled() != zoomOutEnabled) {
    zoomOutButton.setEnabled(zoomOutEnabled);
  }
  drawApplicationMode(canvas,nightMode != null && nightMode.isNightMode());
  if (view.isZooming()) {
    showZoomLevel=true;
    showUIHandler.removeMessages(SHOW_ZOOM_LEVEL_MSG_ID);
  }
 else {
    if (showZoomLevel) {
      hideZoomLevelInTime();
    }
  }
  int sh=Color.WHITE;
  if (nightMode != null && nightMode.isNightMode()) {
    sh=Color.TRANSPARENT;
  }
  if (shadowColor != sh) {
    shadowColor=sh;
    zoomTextPaint.setColor(sh == Color.WHITE ? Color.BLACK : 0xffC8C8C8);
    rulerTextPaint.setColor(sh == Color.WHITE ? Color.BLACK : 0xffC8C8C8);
  }
  boolean drawZoomLevel=showZoomLevel || !view.getSettings().SHOW_RULER.get();
  if (drawZoomLevel) {
    drawZoomLevel(canvas,tileBox,view.isZooming());
  }
 else {
    drawRuler(canvas,tileBox);
  }
}
