{
  boolean castNeeded=false;
  boolean castPrinted=false;
  ITypeBinding nodeType=Types.getTypeBinding(node);
  ITypeBinding thenType=Types.getTypeBinding(node.getThenExpression());
  ITypeBinding elseType=Types.getTypeBinding(node.getElseExpression());
  if (!thenType.equals(elseType) && !(node.getThenExpression() instanceof NullLiteral) && !(node.getElseExpression() instanceof NullLiteral)) {
    castNeeded=true;
  }
  node.getExpression().accept(this);
  buffer.append(" ? ");
  if (castNeeded) {
    castPrinted=printCast(nodeType);
  }
  node.getThenExpression().accept(this);
  if (castPrinted) {
    buffer.append(')');
  }
  buffer.append(" : ");
  if (castNeeded) {
    castPrinted=printCast(nodeType);
  }
  node.getElseExpression().accept(this);
  if (castPrinted) {
    buffer.append(')');
  }
  return false;
}
