{
  String st=settings.LIVE_MONITORING_URL.get();
  List<String> prm=new ArrayList<String>();
  int maxLen=0;
  for (int i=0; i < 7; i++) {
    boolean b=st.contains("{" + i + "}");
    if (b) {
      maxLen=i;
    }
  }
  for (int i=0; i < maxLen + 1; i++) {
switch (i) {
case 0:
      prm.add(data.lat + "");
    break;
case 1:
  prm.add(data.lon + "");
break;
case 2:
prm.add(data.time + "");
break;
case 3:
prm.add(data.hdop + "");
break;
case 4:
prm.add(data.alt + "");
break;
case 5:
prm.add(data.speed + "");
break;
case 6:
prm.add(data.bearing + "");
break;
default :
break;
}
}
String url=MessageFormat.format(st,prm.toArray());
try {
HttpParams params=new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(params,15000);
DefaultHttpClient httpclient=new DefaultHttpClient(params);
URL u=new URL(url);
URI uri=new URI(u.getProtocol(),u.getAuthority(),u.getHost(),u.getPort(),u.getPath(),u.getQuery(),u.getRef());
HttpRequestBase method=new HttpGet(uri);
log.info("Monitor " + uri);
HttpResponse response=httpclient.execute(method);
if (response.getStatusLine() == null || response.getStatusLine().getStatusCode() != 200) {
String msg;
if (response.getStatusLine() == null) {
msg=ctx.getString(R.string.failed_op);
}
 else {
msg=response.getStatusLine().getStatusCode() + " : " + response.getStatusLine().getReasonPhrase();
}
log.error("Error sending monitor request: " + msg);
}
 else {
InputStream is=response.getEntity().getContent();
StringBuilder responseBody=new StringBuilder();
if (is != null) {
BufferedReader in=new BufferedReader(new InputStreamReader(is,"UTF-8"));
String s;
while ((s=in.readLine()) != null) {
responseBody.append(s);
responseBody.append("\n");
}
is.close();
}
httpclient.getConnectionManager().shutdown();
log.info("Monitor response (" + response.getFirstHeader("Content-Type") + "): "+ responseBody.toString());
}
}
 catch (Exception e) {
log.error("Failed connect to " + url + ": "+ e.getMessage(),e);
}
}
