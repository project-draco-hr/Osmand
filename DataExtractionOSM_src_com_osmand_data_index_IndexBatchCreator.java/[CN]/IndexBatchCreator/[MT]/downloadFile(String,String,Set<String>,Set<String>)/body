{
  byte[] buffer=new byte[BUFFER_SIZE];
  int count=0;
  int downloaded=0;
  int mbDownloaded=0;
  File toSave=new File(osmDirFiles,country + ".osm.bz2");
  try {
    log.info("Downloading country " + country + " from "+ url);
    FileOutputStream ostream=new FileOutputStream(toSave);
    InputStream stream=new URL(url).openStream();
    while ((count=stream.read(buffer)) != -1) {
      ostream.write(buffer,0,count);
      downloaded+=count;
      if (downloaded > DOWNLOAD_DEBUG) {
        downloaded-=DOWNLOAD_DEBUG;
        mbDownloaded+=(DOWNLOAD_DEBUG >> 20);
        log.info(mbDownloaded + " megabytes downloaded of " + toSave.getName());
      }
    }
    ostream.close();
    stream.close();
    generateIndex(toSave,alreadyGeneratedFiles,alreadyUploadedFiles);
  }
 catch (  IOException e) {
    log.error("Input/output exception " + toSave.getName() + " downloading from "+ url,e);
  }
}
