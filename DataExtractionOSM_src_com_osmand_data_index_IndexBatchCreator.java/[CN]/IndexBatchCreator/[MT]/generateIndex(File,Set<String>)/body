{
  DataExtraction extr=new DataExtraction(indexAddress,indexPOI,indexTransport,indexAddress,false,false,indexDirFiles);
  try {
    Region country=extr.readCountry(f.getAbsolutePath(),new ConsoleProgressImplementation(9),null);
    DataIndexWriter dataIndexWriter=new DataIndexWriter(indexDirFiles,country);
    String name=country.getName();
    if (indexAddress) {
      String fName=name + "_" + IndexConstants.ADDRESS_TABLE_VERSION+ IndexConstants.ADDRESS_INDEX_EXT;
      uploadIndex(new File(indexDirFiles,fName),alreadyUploadedFiles);
      dataIndexWriter.writeAddress(fName,f.lastModified(),writeWayNodes);
    }
    if (indexPOI) {
      String fName=name + "_" + IndexConstants.POI_TABLE_VERSION+ IndexConstants.POI_INDEX_EXT;
      uploadIndex(new File(indexDirFiles,fName),alreadyUploadedFiles);
      dataIndexWriter.writePOI(fName,f.lastModified());
    }
    if (indexTransport) {
      String fName=name + "_" + IndexConstants.TRANSPORT_TABLE_VERSION+ IndexConstants.TRANSPORT_INDEX_EXT;
      uploadIndex(new File(indexDirFiles,fName),alreadyUploadedFiles);
      dataIndexWriter.writeTransport(fName,f.lastModified());
    }
  }
 catch (  Exception e) {
    log.error("Exception generating indexes for " + f.getName());
  }
}
