{
  ArrayList<PointItem> pointItemsList=new ArrayList<PointItem>();
  for (int i=0; i < pointsList.size(); i++) {
    String pointName=pointsList.get(i).name;
    if (pointsStatus.get(i) != 0) {
      String dateString=DateFormat.format("MM/dd/yyyy hh:mm:ss",new Date(pointsStatus.get(i))).toString();
      pointItemsList.add(new PointItem(true,pointName,dateString));
    }
 else {
      pointItemsList.add(new PointItem(false,pointName,""));
    }
  }
  PointItemAdapter adapter=new PointItemAdapter(this,R.layout.route_point_info,pointItemsList);
  listView=(ListView)findViewById(R.id.pointsListView);
  listView.setAdapter(adapter);
  listView.setOnItemClickListener(new AdapterView.OnItemClickListener(){
    @Override public void onItemClick(    AdapterView<?> adapterView,    View view,    int i,    long l){
      selectedItemIndex=i;
      final PopupMenu popup=new PopupMenu(RoutePointsActivity.this,view);
      final Menu menu=popup.getMenu();
      menu.add(getString(R.string.mark_as_current));
      menu.add(getString(R.string.mark_as_visited));
      menu.add(getString(R.string.show_on_map));
      popup.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener(){
        @Override public boolean onMenuItemClick(        MenuItem menuItem){
          if (menuItem.getTitle().equals(getResources().getString(R.string.mark_as_current))) {
            plugin.setCurrentPoint(pointsList.get(selectedItemIndex));
          }
 else           if (menuItem.getTitle().equals(getResources().getString(R.string.show_on_map))) {
            GPXUtilities.WptPt point=pointsList.get(selectedItemIndex);
            app.getSettings().setMapLocationToShow(point.lat,point.lon,app.getSettings().getMapZoomToShow());
            finish();
          }
 else {
            boolean state=pointsChangedState.get(selectedItemIndex);
            pointsChangedState.set(selectedItemIndex,!state);
          }
          return true;
        }
      }
);
      popup.show();
    }
  }
);
}
