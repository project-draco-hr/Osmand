{
  Statement stat=conn.createStatement();
  ResultSet rs;
  String sql;
  checkOpen();
  if (getColumnsTblName == null)   getColumnsTblName=conn.prepareStatement("select tbl_name from sqlite_master where tbl_name like ?;");
  getColumnsTblName.setString(1,tbl);
  rs=getColumnsTblName.executeQuery();
  if (!rs.next())   return rs;
  tbl=rs.getString(1);
  rs.close();
  sql="select " + "null as TABLE_CAT, " + "null as TABLE_SCHEM, "+ "'" + escape(tbl) + "' as TABLE_NAME, "+ "cn as COLUMN_NAME, "+ "ct as DATA_TYPE, "+ "tn as TYPE_NAME, "+ "2000000000 as COLUMN_SIZE, "+ "2000000000 as BUFFER_LENGTH, "+ "10   as DECIMAL_DIGITS, "+ "10   as NUM_PREC_RADIX, "+ "colnullable as NULLABLE, "+ "null as REMARKS, "+ "null as COLUMN_DEF, "+ "0    as SQL_DATA_TYPE, "+ "0    as SQL_DATETIME_SUB, "+ "2000000000 as CHAR_OCTET_LENGTH, "+ "ordpos as ORDINAL_POSITION, "+ "(case colnullable when 0 then 'N' when 1 then 'Y' else '' end)"+ "    as IS_NULLABLE, "+ "null as SCOPE_CATLOG, "+ "null as SCOPE_SCHEMA, "+ "null as SCOPE_TABLE, "+ "null as SOURCE_DATA_TYPE from (";
  rs=stat.executeQuery("pragma table_info ('" + escape(tbl) + "');");
  boolean colFound=false;
  for (int i=0; rs.next(); i++) {
    String colName=rs.getString(2);
    String colType=rs.getString(3);
    String colNotNull=rs.getString(4);
    int colNullable=2;
    if (colNotNull != null)     colNullable=colNotNull.equals("0") ? 1 : 0;
    if (colFound)     sql+=" union all ";
    colFound=true;
    colType=colType == null ? "TEXT" : colType.toUpperCase();
    int colJavaType=-1;
    if (colType == "INT" || colType == "INTEGER")     colJavaType=Types.INTEGER;
 else     if (colType == "TEXT")     colJavaType=Types.VARCHAR;
 else     if (colType == "FLOAT")     colJavaType=Types.FLOAT;
 else     colJavaType=Types.VARCHAR;
    sql+="select " + i + " as ordpos, "+ colNullable+ " as colnullable, '"+ colJavaType+ "' as ct, '"+ escape(colName)+ "' as cn, '"+ escape(colType)+ "' as tn";
    if (colPat != null)     sql+=" where upper(cn) like upper('" + escape(colPat) + "')";
  }
  sql+=colFound ? ");" : "select null as ordpos, null as colnullable, " + "null as cn, null as tn) limit 0;";
  rs.close();
  return stat.executeQuery(sql);
}
