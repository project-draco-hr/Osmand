{
  String methodName=method.getName();
  if (methodName.equals("getName")) {
    return newName;
  }
  if (methodName.equals("getQualifiedName")) {
    String fullName=delegate.getQualifiedName();
    int lastPackageDelimiter=fullName.lastIndexOf('.');
    if (lastPackageDelimiter > 0) {
      return fullName.substring(0,lastPackageDelimiter + 1) + newName;
    }
 else {
      String pkgName=delegate.getPackage().getName();
      if (!pkgName.isEmpty()) {
        return pkgName + '.' + newName;
      }
    }
    return newName;
  }
  if (methodName.equals("getDeclaringClass")) {
    return declaringClass;
  }
  if (methodName.equals("getErasure")) {
    return proxy;
  }
  if (methodName.equals("getModifiers")) {
    return modifiers;
  }
  return method.invoke(delegate,args);
}
