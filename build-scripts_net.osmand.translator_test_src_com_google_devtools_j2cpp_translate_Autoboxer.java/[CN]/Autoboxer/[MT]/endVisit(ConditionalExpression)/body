{
  ITypeBinding nodeType=getBoxType(node);
  Expression thenExpr=node.getThenExpression();
  ITypeBinding thenType=getBoxType(thenExpr);
  Expression elseExpr=node.getElseExpression();
  ITypeBinding elseType=getBoxType(elseExpr);
  if (thenType.isPrimitive() && !nodeType.isPrimitive()) {
    node.setThenExpression(box(thenExpr));
  }
 else   if (!thenType.isPrimitive() && nodeType.isPrimitive()) {
    node.setThenExpression(unbox(thenExpr));
  }
  if (elseType.isPrimitive() && !nodeType.isPrimitive()) {
    node.setElseExpression(box(elseExpr));
  }
 else   if (!elseType.isPrimitive() && nodeType.isPrimitive()) {
    node.setElseExpression(unbox(elseExpr));
  }
}
