{
  mapActivity=(MapActivity)activity;
  AlertDialog.Builder builder=new Builder(mapActivity);
  builder.setTitle(R.string.send_location_way_choose_title);
  builder.setItems(new String[]{"Email","SMS","Clipboard","geo:","QR-Code"},new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int which){
      final double latitude=args.getDouble(MapActivityActions.KEY_LATITUDE);
      final double longitude=args.getDouble(MapActivityActions.KEY_LONGITUDE);
      final int zoom=args.getInt(MapActivityActions.KEY_ZOOM);
      try {
        final String shortOsmUrl=MapUtils.buildShortOsmUrl(latitude,longitude,zoom);
        final String appLink="http://download.osmand.net/go?lat=" + ((float)latitude) + "&lon="+ ((float)longitude)+ "&z="+ zoom;
        String sms=mapActivity.getString(R.string.send_location_sms_pattern,shortOsmUrl,appLink);
        if (which == 0) {
          sendEmail(shortOsmUrl,appLink);
        }
 else         if (which == 1) {
          sendSms(sms);
        }
 else         if (which == 2) {
          sendToClipboard(sms);
        }
 else         if (which == 3) {
          sendGeoActivity(latitude,longitude,zoom);
        }
 else         if (which == 4) {
          sendQRCode(latitude,longitude);
        }
      }
 catch (      RuntimeException e) {
        Toast.makeText(mapActivity,R.string.input_output_error,Toast.LENGTH_SHORT).show();
      }
    }
  }
);
  return builder.create();
}
