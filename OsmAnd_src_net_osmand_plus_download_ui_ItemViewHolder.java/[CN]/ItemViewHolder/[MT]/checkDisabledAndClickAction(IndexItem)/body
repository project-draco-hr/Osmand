{
  boolean disabled=false;
  clickAction=RightButtonAction.DOWNLOAD;
  if (indexItem.getBasename().toLowerCase().equals(DownloadResources.WORLD_SEAMARKS_KEY) && nauticalPluginDisabled) {
    clickAction=RightButtonAction.ASK_FOR_SEAMARKS_PLUGIN;
    disabled=true;
  }
 else   if ((indexItem.getType() == DownloadActivityType.SRTM_COUNTRY_FILE || indexItem.getType() == DownloadActivityType.HILLSHADE_FILE) && srtmDisabled) {
    if (srtmNeedsInstallation) {
      clickAction=RightButtonAction.ASK_FOR_SRTM_PLUGIN_PURCHASE;
    }
 else {
      clickAction=RightButtonAction.ASK_FOR_SRTM_PLUGIN_ENABLE;
    }
    disabled=true;
  }
 else   if (indexItem.getType() == DownloadActivityType.WIKIPEDIA_FILE && freeVersion) {
    clickAction=RightButtonAction.ASK_FOR_FULL_VERSION_PURCHASE;
    disabled=true;
  }
  if (clickAction != RightButtonAction.DOWNLOAD) {
    rightButton.setText(R.string.get_plugin);
    rightButton.setVisibility(View.VISIBLE);
    rightImageButton.setVisibility(View.GONE);
    final RightButtonAction action=clickAction;
    rightButton.setOnClickListener(new View.OnClickListener(){
      @Override public void onClick(      View v){
switch (action) {
case ASK_FOR_FULL_VERSION_PURCHASE:
          Intent intent=new Intent(Intent.ACTION_VIEW,Uri.parse(Version.marketPrefix(context.getMyApplication()) + "net.osmand.plus"));
        context.startActivity(intent);
      break;
case ASK_FOR_SEAMARKS_PLUGIN:
    context.startActivity(new Intent(context,context.getMyApplication().getAppCustomization().getPluginsActivity()));
  AccessibleToast.makeText(context.getApplicationContext(),context.getString(R.string.activate_seamarks_plugin),Toast.LENGTH_SHORT).show();
break;
case ASK_FOR_SRTM_PLUGIN_PURCHASE:
OsmandPlugin plugin=OsmandPlugin.getPlugin(SRTMPlugin.class);
context.startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse(plugin.getInstallURL())));
break;
case ASK_FOR_SRTM_PLUGIN_ENABLE:
context.startActivity(new Intent(context,context.getMyApplication().getAppCustomization().getPluginsActivity()));
AccessibleToast.makeText(context,context.getString(R.string.activate_srtm_plugin),Toast.LENGTH_SHORT).show();
break;
case DOWNLOAD:
break;
}
}
}
);
}
 else {
rightButton.setVisibility(View.GONE);
rightImageButton.setVisibility(View.VISIBLE);
}
return disabled;
}
