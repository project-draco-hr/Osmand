{
  ApplicationMode oldMode=currentMode;
  boolean changed=globalPreferences.edit().putString(APPLICATION_MODE,p.name()).commit();
  if (changed) {
    currentMode=p;
    updateProfilePreferences();
    switchApplicationMode(oldMode);
  }
  return changed;
}
