{
  List<AmenityIndexRepository> repos=app.getResourceManager().searchAmenityRepositories(n.getLatitude(),n.getLongitude());
  if (DELETE_ACTION.equals(action)) {
    for (    AmenityIndexRepository r : repos) {
      r.deleteAmenity(n.getId());
      r.clearCache();
    }
  }
 else {
    boolean changed=MODIFY_ACTION.equals(action);
    Amenity a=new Amenity(n);
    for (    AmenityIndexRepository r : repos) {
      if (changed) {
        r.updateAmenity(a);
      }
 else {
        r.addAmenity(a);
      }
      r.clearCache();
    }
  }
}
