{
  if (checkRunning()) {
    return;
  }
  final BasicProgressAsyncTask<Void,Void,IndexFileList> inst=new BasicProgressAsyncTask<Void,Void,IndexFileList>(ctx){
    @Override protected IndexFileList doInBackground(    Void... params){
      return DownloadOsmandIndexesHelper.getIndexesList(ctx);
    }
    @Override protected void onPreExecute(){
      currentRunningTask=this;
      super.onPreExecute();
      this.message=ctx.getString(R.string.downloading_list_indexes);
      if (uiActivity != null) {
        uiActivity.updateProgress(false,this);
      }
    }
    protected void onPostExecute(    IndexFileList result){
      indexFiles=result;
      if (indexFiles != null && uiActivity != null) {
        boolean basemapExists=uiActivity.getMyApplication().getResourceManager().containsBasemap();
        IndexItem basemap=indexFiles.getBasemap();
        if (!basemapExists && basemap != null) {
          List<DownloadEntry> downloadEntry=basemap.createDownloadEntry(uiActivity.getClientContext(),uiActivity.getType(),new ArrayList<DownloadEntry>());
          uiActivity.getEntriesToDownload().put(basemap,downloadEntry);
          AccessibleToast.makeText(uiActivity,R.string.basemap_was_selected_to_download,Toast.LENGTH_LONG).show();
          uiActivity.findViewById(R.id.DownloadButton).setVisibility(View.VISIBLE);
        }
        uiActivity.setListAdapter(new DownloadIndexAdapter(uiActivity,uiActivity.getFilteredByType()));
        if (indexFiles.isIncreasedMapVersion()) {
          showWarnDialog();
        }
      }
 else {
        AccessibleToast.makeText(ctx,R.string.list_index_files_was_not_loaded,Toast.LENGTH_LONG).show();
      }
      if (uiActivity != null) {
        uiActivity.updateProgress(false,null);
      }
    }
    private void showWarnDialog(){
      AlertDialog.Builder builder=new AlertDialog.Builder(ctx);
      builder.setMessage(R.string.map_version_changed_info);
      builder.setPositiveButton(R.string.button_upgrade_osmandplus,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          Intent intent=new Intent(Intent.ACTION_VIEW,Uri.parse("market://search?q=pname:net.osmand.plus"));
          try {
            ctx.startActivity(intent);
          }
 catch (          ActivityNotFoundException e) {
          }
        }
      }
);
      builder.setNegativeButton(R.string.default_buttons_cancel,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          dialog.dismiss();
        }
      }
);
      builder.show();
    }
    @Override protected void updateProgress(    boolean updateOnlyProgress){
      if (uiActivity != null) {
        uiActivity.updateProgress(updateOnlyProgress,this);
      }
    }
  }
;
  inst.execute(new Void[0]);
}
