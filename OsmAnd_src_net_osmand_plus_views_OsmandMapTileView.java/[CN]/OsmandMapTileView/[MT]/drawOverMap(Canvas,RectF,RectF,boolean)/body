{
  int w=getCenterPointX();
  int h=getCenterPointY();
  canvas.save();
  boolean rotated=false;
  for (int i=0; i < layers.size(); i++) {
    try {
      OsmandMapLayer layer=layers.get(i);
      if ((!layer.drawInScreenPixels()) != rotated) {
        canvas.restore();
        rotated=!layer.drawInScreenPixels();
        canvas.save();
        if (rotated) {
          canvas.rotate(rotate,w,h);
        }
      }
      layer.onDraw(canvas,latlonRect,tilesRect,nightMode);
    }
 catch (    IndexOutOfBoundsException e) {
    }
  }
  canvas.restore();
  if (showMapPosition) {
    canvas.drawCircle(w,h,3 * dm.density,paintCenter);
    canvas.drawCircle(w,h,7 * dm.density,paintCenter);
  }
}
