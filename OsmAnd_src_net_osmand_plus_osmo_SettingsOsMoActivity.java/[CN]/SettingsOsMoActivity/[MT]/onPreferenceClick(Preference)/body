{
  final OsMoPlugin plugin=OsMoPlugin.getEnabledPlugin(OsMoPlugin.class);
  if (preference == debugPref) {
    updateDebugPref();
    AlertDialog.Builder bld=new AlertDialog.Builder(this);
    StringBuilder bs=new StringBuilder();
    List<String> hs=plugin.getService().getHistoryOfCommands();
    if (hs != null) {
      for (int i=hs.size() - 1; i >= 0; i--) {
        bs.append(hs.get(i)).append("\n");
      }
    }
    ScrollView sv=new ScrollView(this);
    TextView tv=new TextView(this);
    sv.addView(tv);
    final String log=bs.toString();
    tv.setText(log);
    tv.setPadding(5,0,5,5);
    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP,19);
    tv.setMovementMethod(LinkMovementMethod.getInstance());
    bld.setView(sv);
    bld.setNegativeButton(R.string.shared_string_ok,null);
    bld.setPositiveButton(R.string.shared_string_share,new OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        final Intent sendIntent=new Intent();
        sendIntent.setAction(Intent.ACTION_SEND);
        sendIntent.putExtra(Intent.EXTRA_SUBJECT,getString(R.string.share_fav_subject));
        sendIntent.putExtra(Intent.EXTRA_TEXT,log);
        sendIntent.setType("text/plain");
        startActivity(sendIntent);
      }
    }
);
    bld.show();
    return true;
  }
 else   if (preference == trackerId) {
    OsMoService service=plugin.getService();
    SessionInfo ci=service.getCurrentSessionInfo();
    if (ci == null || ci.trackerId == null) {
      AccessibleToast.makeText(this,R.string.osmo_auth_pending,Toast.LENGTH_SHORT).show();
    }
 else {
      ShareDialog dlg=new ShareDialog(this);
      dlg.setTitle(getString(R.string.osmo_tracker_id));
      dlg.setAction(getString(R.string.osmo_regenerate_login_ids),getRegenerateAction());
      dlg.viewContent(ci.trackerId);
      String url=OsMoService.SHARE_TRACKER_URL + Uri.encode(ci.trackerId);
      dlg.shareURLOrText(ci.trackerId,getString(R.string.osmo_tracker_id_share,ci.trackerId,"",url),null);
      dlg.showDialog();
    }
  }
  return super.onPreferenceClick(preference);
}
