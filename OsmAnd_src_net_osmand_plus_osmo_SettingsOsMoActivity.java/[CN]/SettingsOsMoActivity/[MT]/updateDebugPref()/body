{
  final OsMoPlugin plugin=OsMoPlugin.getEnabledPlugin(OsMoPlugin.class);
  OsMoService service=plugin.getService();
  OsMoTracker tracker=plugin.getTracker();
  StringBuilder s=new StringBuilder();
  s.append(getString(R.string.osmo_settings_uuid)).append(" : ").append(getMyApplication().getSettings().OSMO_DEVICE_KEY.get().toUpperCase()).append("\n");
  if (service.isConnected()) {
    int seconds=(int)((System.currentTimeMillis() - service.getConnectionTime()) / 1000);
    s.append(getString(R.string.osmo_conn_successfull,Algorithms.formatDuration(seconds))).append("\n");
    SessionInfo si=service.getCurrentSessionInfo();
    if (si == null) {
      s.append(getString(R.string.osmo_auth_pending)).append("\n");
    }
 else {
      s.append(getString(R.string.osmo_session_token,si.token)).append("\n");
    }
  }
 else {
    s.append(getString(R.string.osmo_io_error) + service.getLastRegistrationError()).append("\n");
  }
  s.append(getString(R.string.osmo_locations_sent,tracker.getLocationsSent(),tracker.getBufferLocationsSize()));
  debugPref.setSummary(s.toString().trim());
  debugPref.setOnPreferenceClickListener(this);
}
