{
  searchedAmenities.clear();
  query=filter;
  String q=query + " near " + latitude+ ","+ longitude;
  try {
    URL url=new URL("http://gazetteer.openstreetmap.org/namefinder/search.xml?find=" + URLEncoder.encode(q));
    InputStream stream=url.openStream();
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(stream,"UTF-8");
    int eventType;
    int namedDepth=0;
    while ((eventType=parser.next()) != XmlPullParser.END_DOCUMENT) {
      if (eventType == XmlPullParser.START_TAG) {
        if (parser.getName().equals("searchresults")) {
          String err=parser.getAttributeValue("","error");
          if (err != null) {
            stream.close();
            return err;
          }
        }
        if (parser.getName().equals("named")) {
          namedDepth++;
          if (namedDepth == 1) {
            try {
              Amenity a=new Amenity();
              a.setLocation(Double.parseDouble(parser.getAttributeValue("","lat")),Double.parseDouble(parser.getAttributeValue("","lon")));
              a.setId(Long.parseLong(parser.getAttributeValue("","id")));
              String name=parser.getAttributeValue("","name");
              a.setName(name);
              a.setEnName(Junidecode.unidecode(name));
              a.setType(AmenityType.OTHER);
              a.setSubType(parser.getAttributeValue("","category"));
              searchedAmenities.add(a);
            }
 catch (            NullPointerException e) {
              log.info("Invalid attributes",e);
            }
catch (            NumberFormatException e) {
              log.info("Invalid attributes",e);
            }
          }
        }
      }
 else       if (eventType == XmlPullParser.END_TAG) {
        if (parser.getName().equals("named")) {
          namedDepth--;
        }
      }
    }
    stream.close();
  }
 catch (  IOException e) {
    log.error("Error loading name finder poi",e);
    return getApplication().getString(R.string.input_output_error);
  }
catch (  XmlPullParserException e) {
    log.error("Error parsing name finder poi",e);
    return getApplication().getString(R.string.input_output_error);
  }
  MapUtils.sortListOfMapObject(searchedAmenities,latitude,longitude);
  return null;
}
