{
  ImageIO.setUseCache(false);
  tilesLocation=fileWithTiles;
  LatLon defaultLocation=DataExtractionSettings.getSettings().getDefaultLocation();
  latitude=defaultLocation.getLatitude();
  longitude=defaultLocation.getLongitude();
  zoom=DataExtractionSettings.getSettings().getDefaultZoom();
  if (map != null) {
    if (zoom > map.getMaximumZoomSupported()) {
      zoom=map.getMaximumZoomSupported();
    }
    if (zoom < map.getMinimumZoomSupported()) {
      zoom=map.getMinimumZoomSupported();
    }
  }
  popupMenu=new JPopupMenu();
  downloader.addDownloaderCallback(this);
  setFocusable(true);
  addComponentListener(new ComponentAdapter(){
    @Override public void componentResized(    ComponentEvent e){
      prepareImage();
    }
  }
);
  setOpaque(false);
  MapMouseAdapter mouse=new MapMouseAdapter();
  addMouseListener(mouse);
  addMouseMotionListener(mouse);
  addMouseWheelListener(mouse);
  initDefaultLayers();
}
