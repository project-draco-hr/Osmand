{
  return searchUICore.search(text,new ResultMatcher<SearchResult>(){
    SearchResultCollection regionResultCollection=null;
    SearchCoreAPI regionResultApi=null;
    List<SearchResult> results=new ArrayList<>();
    @Override public boolean publish(    SearchResult object){
      if (paused) {
        if (regionResultCollection != null && regionResultCollection.getCurrentSearchResults().size() > 0) {
          getResultCollection().addSearchResults(regionResultCollection.getCurrentSearchResults(),true,true);
          regionResultCollection=null;
        }
        if (results.size() > 0) {
          getResultCollection().addSearchResults(results,true,true);
          results.clear();
        }
        return false;
      }
switch (object.objectType) {
case SEARCH_API_FINISHED:
        final SearchCoreAPI searchApi=(SearchCoreAPI)object.object;
      final List<SearchResult> apiResults;
    final SearchPhrase phrase=object.requiredSearchPhrase;
  final SearchCoreAPI regionApi=regionResultApi;
final SearchResultCollection regionCollection=regionResultCollection;
final boolean hasRegionCollection=(searchApi == regionApi && regionCollection != null);
if (hasRegionCollection) {
apiResults=regionCollection.getCurrentSearchResults();
}
 else {
apiResults=results;
}
regionResultApi=null;
regionResultCollection=null;
results.clear();
showApiResults(apiResults,phrase,hasRegionCollection);
break;
case SEARCH_API_REGION_FINISHED:
regionResultApi=(SearchCoreAPI)object.object;
final SearchPhrase regionPhrase=object.requiredSearchPhrase;
if (regionResultCollection == null) {
regionResultCollection=new SearchResultCollection(regionPhrase);
}
regionResultCollection.addSearchResults(results,true,true);
results.clear();
showRegionResults(regionPhrase,regionResultCollection);
break;
case PARTIAL_LOCATION:
showLocationToolbar();
break;
default :
results.add(object);
}
return false;
}
@Override public boolean isCancelled(){
return paused;
}
}
);
}
