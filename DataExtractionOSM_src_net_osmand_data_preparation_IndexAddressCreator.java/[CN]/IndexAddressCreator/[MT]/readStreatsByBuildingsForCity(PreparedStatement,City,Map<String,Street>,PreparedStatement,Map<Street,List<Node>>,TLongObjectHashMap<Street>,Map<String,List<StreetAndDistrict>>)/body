{
  streetBuildingsStat.setLong(1,city.getId());
  ResultSet set=streetBuildingsStat.executeQuery();
  while (set.next()) {
    long streetId=set.getLong(1);
    if (!visitedStreets.containsKey(streetId)) {
      Street street=new Street(null);
      String streetName=set.getString(2);
      street.setLocation(set.getDouble(4),set.getDouble(5));
      street.setId(streetId);
      loadStreetNodes(street,waynodesStat,streetNodes);
      String defaultDistrict=set.getString(12);
      String district=identifyBestDistrict(street,streetName," (" + defaultDistrict + ")",uniqueNames,streetNodes);
      street.setName(streetName + district);
      street.setEnName(set.getString(3) + district);
      if (!streets.containsKey(street.getName())) {
        streets.put(street.getName(),street);
      }
 else {
        List<Node> firstStreetNodes=streetNodes.get(streets.get(street.getName()));
        if (firstStreetNodes != null && streetNodes.get(street) != null) {
          firstStreetNodes.addAll(streetNodes.get(street));
        }
      }
      visitedStreets.put(streetId,street);
    }
    if (set.getObject(6) != null) {
      Street s=visitedStreets.get(streetId);
      Building b=new Building();
      b.setId(set.getLong(6));
      b.setName(set.getString(7));
      b.setEnName(set.getString(8));
      b.setLocation(set.getDouble(9),set.getDouble(10));
      b.setPostcode(set.getString(11));
      s.registerBuilding(b);
    }
  }
  set.close();
}
