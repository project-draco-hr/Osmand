{
  if (isBoundary(e)) {
    Boundary boundary=null;
    if (e instanceof Relation) {
      Relation aRelation=(Relation)e;
      ctx.loadEntityRelation(aRelation);
      boundary=new Boundary(true);
      boundary.setName(aRelation.getTag(OSMTagKey.NAME));
      boundary.setBoundaryId(aRelation.getId());
      boundary.setAdminLevel(extractBoundaryAdminLevel(aRelation));
      Map<Entity,String> entities=aRelation.getMemberEntities();
      for (      Entity es : entities.keySet()) {
        if (es instanceof Way) {
          boolean inner="inner".equals(entities.get(es));
          if (inner) {
            boundary.addInnerWay((Way)es);
          }
 else {
            String wName=es.getTag(OSMTagKey.NAME);
            if (Algoritms.objectEquals(wName,boundary.getName()) || wName == null) {
              visitedBoundaryWays.add(es.getId());
            }
            boundary.addOuterWay((Way)es);
          }
        }
 else         if (es instanceof Node && ("admin_centre".equals(entities.get(es)) || "admin_center".equals(entities.get(es)))) {
          boundary.setAdminCenterId(es.getId());
        }
      }
      boundary.computeIsClosedWay();
    }
 else     if (e instanceof Way) {
      if (!visitedBoundaryWays.contains(e.getId())) {
        boolean closed=false;
        if (((Way)e).getNodeIds().size() > 1) {
          closed=((Way)e).getFirstNodeId() == ((Way)e).getLastNodeId();
        }
        boundary=new WayBoundary(closed);
        boundary.setName(e.getTag(OSMTagKey.NAME));
        boundary.setBoundaryId(e.getId());
        boundary.setAdminLevel(extractBoundaryAdminLevel(e));
        boundary.addOuterWay((Way)e);
      }
    }
    return boundary;
  }
 else {
    return null;
  }
}
