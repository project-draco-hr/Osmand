{
  OsmandApplication app=(OsmandApplication)getActivity().getApplication();
  boolean portrait=ScreenOrientationHelper.isOrientationPortrait(getActivity());
  boolean light=app.getSettings().isLightActionBar();
  Menu menu=onCreate;
  if (getActivity() instanceof SearchActivity) {
    if (portrait) {
      menu=((SearchActivity)getActivity()).getClearToolbar(true).getMenu();
    }
 else {
      ((SearchActivity)getActivity()).getClearToolbar(false);
    }
    light=false;
  }
  MenuItem menuItem=menu.add(0,NAVIGATE_TO,0,R.string.context_menu_item_directions_to);
  MenuItemCompat.setShowAsAction(menuItem,MenuItemCompat.SHOW_AS_ACTION_ALWAYS);
  menuItem=menuItem.setIcon(app.getIconsCache().getIcon(R.drawable.ic_action_gdirections_dark,light));
  menuItem.setOnMenuItemClickListener(new OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      select(NAVIGATE_TO);
      return true;
    }
  }
);
  TargetPointsHelper targets=app.getTargetPointsHelper();
  if (targets.getPointToNavigate() != null) {
    menuItem=menu.add(0,ADD_WAYPOINT,0,R.string.context_menu_item_intermediate_point);
    MenuItemCompat.setShowAsAction(menuItem,MenuItemCompat.SHOW_AS_ACTION_ALWAYS);
    menuItem=menuItem.setIcon(app.getIconsCache().getIcon(R.drawable.ic_action_flage_dark,light));
  }
 else {
    menuItem=menu.add(0,ADD_WAYPOINT,0,R.string.context_menu_item_destination_point);
    MenuItemCompat.setShowAsAction(menuItem,MenuItemCompat.SHOW_AS_ACTION_ALWAYS);
    menuItem=menuItem.setIcon(app.getIconsCache().getIcon(R.drawable.ic_action_flag_dark,light));
  }
  menuItem.setOnMenuItemClickListener(new OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      select(ADD_WAYPOINT);
      return true;
    }
  }
);
  menuItem=menu.add(0,SHOW_ON_MAP,0,R.string.shared_string_show_on_map);
  MenuItemCompat.setShowAsAction(menuItem,MenuItemCompat.SHOW_AS_ACTION_ALWAYS);
  menuItem=menuItem.setIcon(app.getIconsCache().getIcon(R.drawable.ic_action_marker_dark,light));
  menuItem.setOnMenuItemClickListener(new OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      select(SHOW_ON_MAP);
      return true;
    }
  }
);
  menuItem=menu.add(0,ADD_TO_FAVORITE,0,R.string.shared_string_add_to_favorites);
  MenuItemCompat.setShowAsAction(menuItem,MenuItemCompat.SHOW_AS_ACTION_ALWAYS);
  menuItem=menuItem.setIcon(app.getIconsCache().getIcon(R.drawable.ic_action_fav_dark,light));
  menuItem.setOnMenuItemClickListener(new OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      select(ADD_TO_FAVORITE);
      return true;
    }
  }
);
}
