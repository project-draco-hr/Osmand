{
  long now=System.currentTimeMillis();
  Cursor query=db.query("poi",null,"? < latitude AND latitude < ? AND ? < longitude AND longitude < ?",new String[]{Double.toString(bottomLatitude),Double.toString(topLatitude),Double.toString(leftLongitude),Double.toString(rightLongitude)},null,null,null);
  List<Amenity> amenities=new ArrayList<Amenity>();
  int idIndex=query.getColumnIndex("id");
  int latitudeIndex=query.getColumnIndex("latitude");
  int longitudeIndex=query.getColumnIndex("longitude");
  int nameIndex=query.getColumnIndex("name");
  int typeIndex=query.getColumnIndex("type");
  int subtypeIndex=query.getColumnIndex("subtype");
  if (query.moveToFirst()) {
    do {
      Amenity am=new Amenity();
      if (idIndex != -1) {
        am.setId(query.getLong(idIndex));
      }
      if (latitudeIndex != -1 && longitudeIndex != -1) {
        am.setLocation(query.getDouble(latitudeIndex),query.getDouble(longitudeIndex));
      }
      if (nameIndex != -1) {
        am.setName(query.getString(nameIndex));
      }
      if (typeIndex != -1) {
        am.setType(AmenityType.fromString(query.getString(typeIndex)));
      }
      if (subtypeIndex != -1) {
        am.setSubType(query.getString(subtypeIndex));
      }
      amenities.add(am);
    }
 while (query.moveToNext());
  }
  query.deactivate();
  if (log.isDebugEnabled()) {
    log.debug(String.format("Search for %s done in %s ms found %s.",topLatitude + " " + leftLongitude,System.currentTimeMillis() - now,amenities.size()));
  }
  return amenities;
}
