{
  View v=convertView;
  if (v == null) {
    LayoutInflater inflater=(LayoutInflater)getDownloadActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    v=inflater.inflate(R.layout.download_index_list_item,null);
  }
  TextView name=(TextView)v.findViewById(R.id.download_item);
  TextView description=(TextView)v.findViewById(R.id.download_descr);
  IndexItem e=items.get(position);
  String eName=e.getVisibleName(getMyApplication(),osmandRegions);
  name.setText(eName.trim());
  String d=e.getDate(format) + "\n" + e.getSizeDescription(getMyApplication());
  description.setText(d);
  final CheckBox ch=(CheckBox)v.findViewById(R.id.check_download_item);
  ch.setChecked(getDownloadActivity().getEntriesToDownload().containsKey(e));
  ch.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      ch.setChecked(!ch.isChecked());
      final IndexItem e=(IndexItem)getListAdapter().getItem(position);
      if (ch.isChecked()) {
        ch.setChecked(!ch.isChecked());
        getDownloadActivity().getEntriesToDownload().remove(e);
        getDownloadActivity().updateDownloadButton(true);
        return;
      }
      List<DownloadEntry> download=e.createDownloadEntry(getMyApplication(),getDownloadActivity().getType(),new ArrayList<DownloadEntry>());
      if (download.size() > 0) {
        getDownloadActivity().getEntriesToDownload().put(e,download);
        getDownloadActivity().updateDownloadButton(true);
        ch.setChecked(!ch.isChecked());
      }
    }
  }
);
  return v;
}
