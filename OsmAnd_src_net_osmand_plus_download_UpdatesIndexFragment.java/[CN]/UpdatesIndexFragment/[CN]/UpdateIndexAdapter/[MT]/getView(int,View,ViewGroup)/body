{
  View v=convertView;
  if (v == null) {
    LayoutInflater inflater=(LayoutInflater)getDownloadActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    v=inflater.inflate(R.layout.update_index_list_item,null);
  }
  TextView name=(TextView)v.findViewById(R.id.download_item);
  TextView description=(TextView)v.findViewById(R.id.download_descr);
  final CheckBox ch=(CheckBox)v.findViewById(R.id.check_download_item);
  IndexItem e=items.get(position);
  if (e.getFileName() == getString(R.string.everything_up_to_date)) {
    name.setText(e.getFileName());
    description.setText("");
    ch.setVisibility(View.INVISIBLE);
    return v;
  }
 else {
    ch.setVisibility(View.VISIBLE);
  }
  String eName=e.getVisibleName(getMyApplication(),osmandRegions);
  name.setText(eName.trim());
  String d=e.getDate(format) + "\n" + e.getSizeDescription(getMyApplication());
  description.setText(d);
  ch.setChecked(getDownloadActivity().getEntriesToDownload().containsKey(e));
  ch.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      ch.setChecked(!ch.isChecked());
      onItemSelected(ch,position);
    }
  }
);
  if (e.getDate(format) != null) {
    Map<String,String> indexActivatedFileNames=getDownloadActivity().getIndexActivatedFileNames();
    Map<String,String> indexFileNames=getDownloadActivity().getIndexFileNames();
    if (indexActivatedFileNames != null && indexFileNames != null) {
      String sfName=e.getTargetFileName();
      final boolean updatableResource=indexActivatedFileNames.containsKey(sfName);
      if (updatableResource && !DownloadActivity.downloadListIndexThread.checkIfItemOutdated(e)) {
        name.setText(name.getText() + "\n" + getResources().getString(R.string.local_index_installed)+ " : "+ indexActivatedFileNames.get(sfName));
        name.setTypeface(Typeface.DEFAULT,Typeface.NORMAL);
      }
 else       if (e.getDate(format).equals(indexFileNames.get(sfName))) {
        name.setText(name.getText() + "\n" + getResources().getString(R.string.local_index_installed)+ " : "+ indexFileNames.get(sfName));
        name.setTypeface(Typeface.DEFAULT,Typeface.ITALIC);
      }
 else       if (updatableResource) {
        name.setText(name.getText() + "\n" + getResources().getString(R.string.local_index_installed)+ " : "+ indexActivatedFileNames.get(sfName));
        name.setTextColor(updateColor);
        name.setTypeface(Typeface.DEFAULT,Typeface.NORMAL);
      }
 else {
        name.setText(name.getText() + "\n" + getResources().getString(R.string.local_index_installed)+ " : "+ indexFileNames.get(sfName));
        name.setTextColor(updateColor);
        name.setTypeface(Typeface.DEFAULT,Typeface.ITALIC);
      }
    }
  }
  return v;
}
