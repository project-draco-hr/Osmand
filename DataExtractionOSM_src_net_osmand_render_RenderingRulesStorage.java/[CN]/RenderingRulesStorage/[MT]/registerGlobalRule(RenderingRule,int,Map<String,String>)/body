{
  int tag=rr.getIntPropertyValue(RenderingRuleStorageProperties.TAG);
  if (tag == -1) {
    throw new SAXException("Attribute tag should be specified for root filter " + attrsMap.toString());
  }
  int value=rr.getIntPropertyValue(RenderingRuleStorageProperties.VALUE);
  if (value == -1) {
    throw new SAXException("Attribute tag should be specified for root filter " + attrsMap.toString());
  }
  int key=(tag << SHIFT_TAG_VAL) + value;
  RenderingRule toInsert=rr;
  RenderingRule previous=tagValueGlobalRules[state].get(key);
  if (previous != null) {
    if (previous.getProperties().length > 2) {
      Map<String,String> m=new HashMap<String,String>();
      m.put("tag",dictionary.get(tag));
      m.put("value",dictionary.get(value));
      toInsert=new RenderingRule(m,RenderingRulesStorage.this);
      toInsert.addIfElseChildren(previous);
    }
 else {
      toInsert=previous;
    }
    toInsert.addIfElseChildren(rr);
  }
  tagValueGlobalRules[state].put(key,toInsert);
}
