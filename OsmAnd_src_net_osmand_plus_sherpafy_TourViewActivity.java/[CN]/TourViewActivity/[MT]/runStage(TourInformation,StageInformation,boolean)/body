{
  WptPt point=null;
  GPXFile gpx=null;
  customization.selectTour(tour,IProgress.EMPTY_PROGRESS);
  customization.selectStage(stage,IProgress.EMPTY_PROGRESS);
  if (customization.getSelectedStage() != null) {
    gpx=customization.getSelectedStage().getGpx();
    List<SelectedGpxFile> sgpx=getMyApplication().getSelectedGpxHelper().getSelectedGPXFiles();
    if (gpx == null && sgpx.size() > 0) {
      getMyApplication().getSelectedGpxHelper().clearAllGpxFileToShow();
    }
 else     if (sgpx.size() != 1 || sgpx.get(0).getGpxFile() != gpx) {
      getMyApplication().getSelectedGpxHelper().clearAllGpxFileToShow();
      if (gpx != null && gpx.findPointToShow() != null) {
        point=gpx.findPointToShow();
        getMyApplication().getSelectedGpxHelper().setGpxFileToDisplay(gpx);
      }
    }
  }
  WptPt lp=gpx.getLastPoint();
  if (lp != null) {
    TargetPointsHelper targetPointsHelper=getMyApplication().getTargetPointsHelper();
    targetPointsHelper.navigateToPoint(new LatLon(lp.lat,lp.lon),true,-1,lp.name);
    getMyApplication().getSettings().navigateDialog(true);
  }
  String mode=stage != null ? stage.getMode() : tour.getMode();
  if (!Algorithms.isEmpty(mode)) {
    final ApplicationMode def=getMyApplication().getSettings().getApplicationMode();
    ApplicationMode am=ApplicationMode.valueOfStringKey(mode,def);
    if (am != def) {
      getMyApplication().getSettings().APPLICATION_MODE.set(am);
    }
  }
  getMyApplication().getSettings().SHOW_FAVORITES.set(true);
  if (startOver && point != null) {
    goToMap(new LatLon(point.lat,point.lon));
  }
 else {
    goToMap(null);
  }
}
