{
  if (!(getMyApplication().getAppCustomization() instanceof SherpafyCustomization)) {
    getMyApplication().setAppCustomization(new SherpafyCustomization());
  }
  customization=(SherpafyCustomization)getMyApplication().getAppCustomization();
  setTheme(R.style.OsmandLightTheme);
  ((OsmandApplication)getApplication()).setLanguage(this);
  super.onCreate(savedInstanceState);
  if (getRequestedOrientation() == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT || getRequestedOrientation() == ActivityInfo.SCREEN_ORIENTATION_REVERSE_PORTRAIT) {
    getSherlock().setUiOptions(ActivityInfo.UIOPTION_SPLIT_ACTION_BAR_WHEN_NARROW);
  }
  getSupportActionBar().setDisplayHomeAsUpEnabled(false);
  getSupportActionBar().setTitle(R.string.sherpafy_app_name);
  setContentView(R.layout.sherpafy_loading);
  if (state == STATE_LOADING) {
    getMyApplication().checkApplicationIsBeingInitialized(this,(TextView)findViewById(R.id.ProgressMessage),(ProgressBar)findViewById(R.id.ProgressBar),new Runnable(){
      @Override public void run(){
        if (customization.getSelectedTour() != null) {
          startTourView();
        }
 else {
          startSettings();
        }
      }
    }
);
  }
 else   if (state == STATE_SELECT_TOUR) {
    state=STATE_LOADING;
    startSettings();
  }
 else   if (state == STATE_TOUR_VIEW) {
    state=STATE_LOADING;
    startTourView();
  }
}
