{
  long time=System.currentTimeMillis();
  if (start != null && end != null) {
    if (log.isInfoEnabled()) {
      log.info("Start finding route from " + start + " to "+ end+ " using "+ type.getName());
    }
    try {
      RouteCalculationResult res;
      if (gpxRoute != null && !gpxRoute.points.isEmpty()) {
        res=calculateGpxRoute(start,end,gpxRoute,ctx,leftSide);
      }
 else       if (type == RouteService.YOURS) {
        res=findYOURSRoute(start,end,mode,fast,ctx,leftSide);
      }
 else       if (type == RouteService.ORS) {
        res=findORSRoute(start,end,mode,fast,ctx,leftSide);
      }
 else       if (type == RouteService.OSMAND) {
        List<RouteSegmentResult> originalRoute=null;
        if (previousToRecalculate != null) {
          originalRoute=previousToRecalculate.getOriginalRoute();
        }
        res=findVectorMapsRoute(start,end,mode,(OsmandApplication)ctx.getApplicationContext(),originalRoute,leftSide,interruptable);
      }
 else {
        res=findCloudMadeRoute(start,end,mode,ctx,fast,leftSide);
      }
      if (log.isInfoEnabled()) {
        log.info("Finding route contained " + res.getImmutableLocations().size() + " points for "+ (System.currentTimeMillis() - time)+ " ms");
      }
      return res;
    }
 catch (    IOException e) {
      log.error("Failed to find route ",e);
    }
catch (    ParserConfigurationException e) {
      log.error("Failed to find route ",e);
    }
catch (    SAXException e) {
      log.error("Failed to find route ",e);
    }
  }
  return new RouteCalculationResult(null);
}
