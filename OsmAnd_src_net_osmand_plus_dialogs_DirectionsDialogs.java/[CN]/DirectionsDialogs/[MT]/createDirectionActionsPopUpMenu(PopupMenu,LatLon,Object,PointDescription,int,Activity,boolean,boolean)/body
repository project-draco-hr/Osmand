{
  setupPopUpMenuIcon(optionsMenu);
  final OsmandApplication app=((OsmandApplication)activity.getApplication());
  IconsCache iconsCache=app.getIconsCache();
  final TargetPointsHelper targetPointsHelper=app.getTargetPointsHelper();
  MenuItem item=optionsMenu.getMenu().add(R.string.context_menu_item_directions_to).setIcon(iconsCache.getContentIcon((R.drawable.ic_action_gdirections_dark)));
  item.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      DirectionsDialogs.directionsToDialogAndLaunchMap(activity,location.getLatitude(),location.getLongitude(),name);
      optionsMenu.dismiss();
      return true;
    }
  }
);
  if (targetPointsHelper.getPointToNavigate() != null) {
    item=optionsMenu.getMenu().add(R.string.context_menu_item_intermediate_point).setIcon(iconsCache.getContentIcon(R.drawable.ic_action_flage_dark));
  }
 else {
    item=optionsMenu.getMenu().add(R.string.context_menu_item_destination_point).setIcon(iconsCache.getContentIcon(R.drawable.ic_action_flag_dark));
  }
  item.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      DirectionsDialogs.addWaypointDialogAndLaunchMap(activity,location.getLatitude(),location.getLongitude(),name);
      optionsMenu.dismiss();
      return true;
    }
  }
);
  item=optionsMenu.getMenu().add(R.string.shared_string_show_on_map).setIcon(iconsCache.getContentIcon(R.drawable.ic_action_marker_dark));
  item.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener(){
    @Override public boolean onMenuItemClick(    MenuItem item){
      app.getSettings().setMapLocationToShow(location.getLatitude(),location.getLongitude(),z,name,saveHistory,obj);
      MapActivity.launchMapActivityMoveToTop(activity);
      return true;
    }
  }
);
  if (favorite) {
    item=optionsMenu.getMenu().add(R.string.shared_string_add_to_favorites).setIcon(iconsCache.getContentIcon(R.drawable.ic_action_fav_dark));
    item.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener(){
      @Override public boolean onMenuItemClick(      MenuItem item){
        Bundle args=new Bundle();
        Dialog dlg=FavoriteDialogs.createAddFavouriteDialog(activity,args);
        dlg.show();
        FavoriteDialogs.prepareAddFavouriteDialog(activity,dlg,args,location.getLatitude(),location.getLongitude(),name);
        return true;
      }
    }
);
  }
}
