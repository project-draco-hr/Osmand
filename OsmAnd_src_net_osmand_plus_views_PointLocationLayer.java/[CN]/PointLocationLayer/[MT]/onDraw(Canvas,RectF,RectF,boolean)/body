{
  if (lastKnownLocation == null || view == null) {
    return;
  }
  int locationX=view.getMapXForPoint(lastKnownLocation.getLongitude());
  int locationY=view.getMapYForPoint(lastKnownLocation.getLatitude());
  int radius=MapUtils.getLengthXFromMeters(view.getZoom(),view.getLatitude(),view.getLongitude(),lastKnownLocation.getAccuracy(),view.getTileSize(),view.getWidth());
  if (radius > RADIUS * dm.density) {
    int allowedRad=Math.min(view.getWidth() / 2,view.getHeight() / 2);
    canvas.drawCircle(locationX,locationY,Math.min(radius,allowedRad),area);
    canvas.drawCircle(locationX,locationY,Math.min(radius,allowedRad),aroundArea);
  }
  if (isLocationVisible(lastKnownLocation)) {
    checkAppMode(view.getSettings().getApplicationMode());
    boolean isBearing=lastKnownLocation.hasBearing();
    if (!isBearing) {
      canvas.drawBitmap(locationIcon,locationX - locationIcon.getWidth() / 2,locationY - locationIcon.getHeight() / 2,locationPaint);
    }
    if (heading != null) {
      canvas.drawArc(getHeadingRect(locationX,locationY),heading - HEADING_ANGLE / 2 - 90,HEADING_ANGLE,true,headingPaint);
    }
    if (isBearing) {
      float bearing=lastKnownLocation.getBearing();
      canvas.rotate(bearing - 90,locationX,locationY);
      canvas.drawBitmap(bearingIcon,locationX - bearingIcon.getWidth() / 2,locationY - bearingIcon.getHeight() / 2,locationPaint);
    }
  }
}
