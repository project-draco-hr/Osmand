{
  if (isLocationVisible(lastKnownLocation)) {
    checkAppMode(view.getSettings().getApplicationMode());
    int locationX=view.getMapXForPoint(lastKnownLocation.getLongitude());
    int locationY=view.getMapYForPoint(lastKnownLocation.getLatitude());
    int radius=MapUtils.getLengthXFromMeters(view.getZoom(),view.getLatitude(),view.getLongitude(),lastKnownLocation.getAccuracy(),view.getTileSize(),view.getWidth());
    boolean isBearing=lastKnownLocation.hasBearing();
    if (!isBearing) {
      canvas.drawBitmap(locationIcon,locationX - locationIcon.getWidth() / 2,locationY - locationIcon.getHeight() / 2,locationPaint);
    }
    if (radius > RADIUS * dm.density) {
      canvas.drawCircle(locationX,locationY,radius,area);
    }
    if (heading != null) {
      canvas.drawArc(getHeadingRect(locationX,locationY),heading - HEADING_ANGLE / 2 - 90,HEADING_ANGLE,true,headingPaint);
    }
    if (isBearing) {
      float bearing=lastKnownLocation.getBearing();
      canvas.rotate(bearing - 90,locationX,locationY);
      canvas.drawBitmap(bearingIcon,locationX - bearingIcon.getWidth() / 2,locationY - bearingIcon.getHeight() / 2,locationPaint);
    }
  }
}
