{
  final Drawable monitoringBig=map.getResources().getDrawable(R.drawable.monitoring_rec_big);
  final Drawable monitoringSmall=map.getResources().getDrawable(R.drawable.monitoring_rec_small);
  final Drawable monitoringInactive=map.getResources().getDrawable(R.drawable.monitoring_rec_inactive);
  monitoringControl=new TextInfoWidget(map,0,paintText,paintSubText){
    long lastUpdateTime;
    @Override public boolean updateInfo(    DrawSettings drawSettings){
      boolean visible=true;
      String txt=map.getString(R.string.monitoring_control_start);
      String subtxt=null;
      Drawable d=monitoringInactive;
      long last=lastUpdateTime;
      final boolean globalRecord=settings.SAVE_GLOBAL_TRACK_TO_GPX.get();
      if (globalRecord || settings.SAVE_TRACK_TO_GPX.get()) {
        float dist=app.getSavingTrackHelper().getDistance();
        last=app.getSavingTrackHelper().getLastTimeUpdated();
        String ds=OsmAndFormatter.getFormattedDistance(dist,map.getMyApplication());
        int ls=ds.lastIndexOf(' ');
        if (ls == -1) {
          txt=ds;
        }
 else {
          txt=ds.substring(0,ls);
          subtxt=ds.substring(ls + 1);
        }
        if (globalRecord) {
          d=monitoringBig;
        }
      }
      setText(txt,subtxt);
      setImageDrawable(d);
      if (last != lastUpdateTime && globalRecord) {
        lastUpdateTime=last;
        blink();
      }
      updateVisibility(visible);
      return true;
    }
    private void blink(){
      setImageDrawable(monitoringSmall);
      invalidate();
      postDelayed(new Runnable(){
        @Override public void run(){
          setImageDrawable(monitoringBig);
          invalidate();
        }
      }
,500);
    }
  }
;
  monitoringControl.updateInfo(null);
  monitoringControl.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      controlDialog(map);
    }
  }
);
  return monitoringControl;
}
