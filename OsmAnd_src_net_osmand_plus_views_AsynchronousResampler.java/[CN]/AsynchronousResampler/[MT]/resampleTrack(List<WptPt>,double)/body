{
  List<WptPt> newPts=new ArrayList<>();
  int size=pts.size();
  if (size > 0) {
    WptPt lastPt=pts.get(0);
    double segSub=0;
    double cumDist=0;
    for (int i=1; i < size && !isCancelled(); i++) {
      WptPt pt=pts.get(i);
      double segLength=MapUtils.getDistance(pt.getLatitude(),pt.getLongitude(),lastPt.getLatitude(),lastPt.getLongitude());
      while (segSub < segLength) {
        double partial=segSub / segLength;
        newPts.add(createIntermediatePoint(lastPt,pt,segSub / segLength,cumDist + segLength * partial));
        segSub+=dist;
      }
      segSub-=segLength;
      cumDist+=segLength;
      lastPt=pt;
    }
    newPts.add(createIntermediatePoint(lastPt,lastPt,0,cumDist));
  }
  return newPts;
}
