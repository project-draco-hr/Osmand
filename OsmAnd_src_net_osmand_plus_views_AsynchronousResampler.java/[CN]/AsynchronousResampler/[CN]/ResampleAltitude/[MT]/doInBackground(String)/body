{
  culled=resampleTrack(rs.points,segmentSize);
  if (!isCancelled() && !culled.isEmpty()) {
    int halfC=Algorithms.getRainbowColor(0.5);
    Double max=Double.NEGATIVE_INFINITY;
    Double min=Double.POSITIVE_INFINITY;
    for (    GPXUtilities.WptPt pt : culled) {
      max=Math.max(max,pt.ele);
      min=Math.min(min,pt.ele);
      pt.colourARGB=halfC;
    }
    Double elevationRange=max - min;
    if (elevationRange > 0)     for (    GPXUtilities.WptPt pt : culled)     pt.colourARGB=Algorithms.getRainbowColor((pt.ele - min) / elevationRange);
  }
  return isCancelled() ? "" : "OK";
}
