{
  double dmax=Double.NEGATIVE_INFINITY;
  int index=-1;
  for (int i=start + 1; i < end && !isCancelled(); i++) {
    double d=MapUtils.getOrthogonalDistance(rs.points.get(i).getLatitude(),rs.points.get(i).getLongitude(),rs.points.get(start).getLatitude(),rs.points.get(start).getLongitude(),rs.points.get(end).getLatitude(),rs.points.get(end).getLongitude());
    if (d > dmax) {
      dmax=d;
      index=i;
    }
  }
  if (dmax >= epsilon) {
    cullRamerDouglasPeucer(survivor,start,index);
    cullRamerDouglasPeucer(survivor,index,end);
  }
 else {
    survivor[end]=true;
  }
}
