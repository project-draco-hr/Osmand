{
  if (DBDialect.SQLITE == dialect) {
    try {
      Class.forName("org.sqlite.JDBC");
    }
 catch (    ClassNotFoundException e) {
      log.error("Illegal configuration",e);
      throw new IllegalStateException(e);
    }
    Connection connection=DriverManager.getConnection("jdbc:sqlite:" + fileName);
    Statement statement=connection.createStatement();
    statement.executeUpdate("PRAGMA synchronous = 0");
    statement.close();
    return connection;
  }
 else   if (DBDialect.DERBY == dialect) {
    try {
      Class.forName("org.apache.derby.jdbc.EmbeddedDriver");
    }
 catch (    ClassNotFoundException e) {
      log.error("Illegal configuration",e);
      throw new IllegalStateException(e);
    }
    Connection conn=DriverManager.getConnection("jdbc:derby:" + fileName + ";create=true");
    conn.setAutoCommit(false);
    return conn;
  }
 else   if (DBDialect.H2 == dialect) {
    try {
      Class.forName("org.h2.Driver");
    }
 catch (    ClassNotFoundException e) {
      log.error("Illegal configuration",e);
      throw new IllegalStateException(e);
    }
    return DriverManager.getConnection("jdbc:h2:file:" + fileName);
  }
 else {
    throw new UnsupportedOperationException();
  }
}
