{
  boolean remove=map.get(key).remove(value);
  if (!remove) {
    throw new IllegalStateException();
  }
  if (map.get(key).isEmpty()) {
    map.remove(key);
  }
}
