{
  Statement statement=dbConn.createStatement();
  String select;
  int count=0;
  if (type == EntityType.NODE) {
    select="select * from node";
  }
 else   if (type == EntityType.WAY) {
    select="select distinct id from ways";
  }
 else {
    select="select distinct id from relations";
  }
  ResultSet rs=statement.executeQuery(select);
  while (rs.next()) {
    count++;
    if (progress != null) {
      progress.progress(1);
    }
    Entity e;
    if (type == EntityType.NODE) {
      e=new Node(rs.getDouble(2),rs.getDouble(3),rs.getLong(1));
    }
 else     if (type == EntityType.WAY) {
      e=new Way(rs.getLong(1));
    }
 else {
      e=new Relation(rs.getLong(1));
    }
    loadEntityTags(type,e);
    iterateEntity(e,step);
  }
  rs.close();
  return count;
}
