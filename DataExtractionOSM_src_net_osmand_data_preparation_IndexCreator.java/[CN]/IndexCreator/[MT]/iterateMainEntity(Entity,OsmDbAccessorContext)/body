{
  if (indexPOI) {
    indexPoiCreator.iterateEntity(e,pStatements);
  }
  if (indexTransport) {
    indexTransportCreator.visitEntityMainStep(e,ctx,pStatements);
  }
  if (indexMap && (e instanceof Way || e instanceof Node)) {
    ctx.loadEntityData(e,false);
    boolean inverse="-1".equals(e.getTag(OSMTagKey.ONEWAY));
    for (int i=0; i < mapZooms.size(); i++) {
      writeBinaryEntityToMapDatabase(e,e.getId(),i == 0 ? inverse : false,i);
    }
  }
  if (indexAddress) {
    if (e.getTag(OSMTagKey.ADDR_HOUSE_NUMBER) != null && e.getTag(OSMTagKey.ADDR_STREET) != null) {
      boolean exist=false;
      if (loadInMemory) {
        exist=addressBuildingLocalSet.contains(e.getId());
      }
 else {
        addressSearchBuildingStat.setLong(1,e.getId());
        ResultSet rs=addressSearchBuildingStat.executeQuery();
        exist=rs.next();
        rs.close();
      }
      if (!exist) {
        ctx.loadEntityData(e,false);
        LatLon l=e.getLatLon();
        City city=getClosestCity(l);
        Long idStreet=getStreetInCity(city,e.getTag(OSMTagKey.ADDR_STREET),l,(e.getId() << 2));
        if (idStreet != null) {
          Building building=new Building(e);
          building.setName(e.getTag(OSMTagKey.ADDR_HOUSE_NUMBER));
          DataIndexWriter.writeBuilding(addressBuildingStat,pStatements,idStreet,building,BATCH_SIZE);
        }
      }
    }
 else     if (e instanceof Way && e.getTag(OSMTagKey.HIGHWAY) != null && e.getTag(OSMTagKey.NAME) != null) {
      boolean exist=false;
      if (saveAddressWays) {
        if (loadInMemory) {
          exist=addressStreetNodeLocalSet.contains(e.getId());
        }
 else {
          addressSearchStreetNodeStat.setLong(1,e.getId());
          ResultSet rs=addressSearchStreetNodeStat.executeQuery();
          exist=rs.next();
          rs.close();
        }
      }
      if (!exist) {
        ctx.loadEntityData(e,false);
        LatLon l=e.getLatLon();
        City city=getClosestCity(l);
        Long idStreet=getStreetInCity(city,e.getTag(OSMTagKey.NAME),l,(e.getId() << 2) | 1);
        if (idStreet != null && saveAddressWays) {
          DataIndexWriter.writeStreetWayNodes(addressStreetNodeStat,pStatements,idStreet,(Way)e,BATCH_SIZE);
        }
      }
    }
    if (e instanceof Relation) {
      if (e.getTag(OSMTagKey.POSTAL_CODE) != null) {
        ctx.loadEntityData(e,false);
        postalCodeRelations.add((Relation)e);
      }
    }
  }
}
