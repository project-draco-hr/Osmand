{
  Log.d(TAG,"Sending request " + url);
  try {
    HttpURLConnection connection=NetworkUtils.getHttpURLConnection(url);
    connection.setConnectTimeout(15000);
    connection.setRequestMethod(requestMethod);
    connection.setRequestProperty("User-Agent",Version.getFullVersion(ctx));
    StringBuilder responseBody=new StringBuilder();
    connection.connect();
    if (connection.getResponseCode() != HttpURLConnection.HTTP_OK) {
      String msg=userOperation + " " + ctx.getString(R.string.failed_op)+ " : "+ connection.getResponseMessage();
      Log.e(TAG,msg);
      showToast(msg);
    }
 else {
      Log.d(TAG,"Response : " + connection.getResponseMessage());
      responseBody.setLength(0);
      InputStream i=connection.getInputStream();
      if (i != null) {
        BufferedReader in=new BufferedReader(new InputStreamReader(i,"UTF-8"),256);
        String s;
        boolean f=true;
        while ((s=in.readLine()) != null) {
          if (!f) {
            responseBody.append("\n");
          }
 else {
            f=false;
          }
          responseBody.append(s);
        }
        try {
          in.close();
          i.close();
        }
 catch (        Exception e) {
          Log.d(TAG,e.getMessage());
        }
      }
      return responseBody.toString();
    }
    connection.disconnect();
  }
 catch (  NullPointerException e) {
    String msg=ctx.getString(R.string.auth_failed);
    Log.e(TAG,msg,e);
    showToast(msg);
  }
catch (  MalformedURLException e) {
    Log.e(TAG,userOperation + " " + ctx.getString(R.string.failed_op),e);
    showToast(MessageFormat.format(ctx.getResources().getString(R.string.shared_string_action_template) + ": " + ctx.getResources().getString(R.string.shared_string_unexpected_error),userOperation));
  }
catch (  IOException e) {
    Log.e(TAG,userOperation + " " + ctx.getString(R.string.failed_op),e);
    showToast(MessageFormat.format(ctx.getResources().getString(R.string.shared_string_action_template) + ": " + ctx.getResources().getString(R.string.shared_string_io_error),userOperation));
  }
  return null;
}
