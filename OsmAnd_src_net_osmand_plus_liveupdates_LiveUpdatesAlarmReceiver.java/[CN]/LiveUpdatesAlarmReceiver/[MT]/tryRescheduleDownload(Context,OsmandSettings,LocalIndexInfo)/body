{
  final OsmandSettings.CommonPreference<Integer> updateFrequencyPreference=preferenceUpdateFrequency(localIndexInfo,settings);
  final Integer frequencyOrdinal=updateFrequencyPreference.get();
  if (UpdateFrequency.values()[frequencyOrdinal] == UpdateFrequency.HOURLY) {
    return;
  }
  final Integer retriesLeft=settings.LIVE_UPDATES_RETRIES.get();
  if (retriesLeft > 0) {
    Intent intent=new Intent(context,LiveUpdatesAlarmReceiver.class);
    final File file=new File(localIndexInfo.getFileName());
    final String fileName=Algorithms.getFileNameWithoutExtension(file);
    intent.putExtra(LiveUpdatesSettingsDialogFragment.LOCAL_INDEX_INFO,localIndexInfo);
    intent.setAction(fileName);
    PendingIntent alarmIntent=PendingIntent.getBroadcast(context,0,intent,0);
    long timeToRetry=System.currentTimeMillis() + AlarmManager.INTERVAL_HOUR;
    AlarmManager alarmMgr=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
    alarmMgr.set(AlarmManager.RTC,timeToRetry,alarmIntent);
    settings.LIVE_UPDATES_RETRIES.set(retriesLeft - 1);
  }
 else {
    settings.LIVE_UPDATES_RETRIES.resetToDefault();
  }
}
