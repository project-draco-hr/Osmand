{
  routes.clear();
  List<TransportIndexRepository> reps=getMapActivity().getMyApplication().getResourceManager().searchTransportRepositories(transportStop.getLocation().getLatitude(),transportStop.getLocation().getLongitude());
  boolean useEnglishNames=getMapActivity().getMyApplication().getSettings().usingEnglishNames();
  for (  TransportIndexRepository t : reps) {
    if (t.acceptTransportStop(transportStop)) {
      List<TransportRoute> rts=t.getRouteForStop(transportStop);
      if (rts != null) {
        for (        TransportRoute rs : rts) {
          TransportStopType type=TransportStopType.findType(rs.getType());
          TransportStopRoute r=new TransportStopRoute();
          if (topType == null && type != null && type.isTopType()) {
            topType=type;
          }
          r.type=type;
          r.desc=rs.getRef() + " " + (useEnglishNames ? rs.getEnName(true) : rs.getName());
          r.route=rs;
          r.stop=transportStop;
          this.routes.add(r);
        }
      }
    }
  }
}
