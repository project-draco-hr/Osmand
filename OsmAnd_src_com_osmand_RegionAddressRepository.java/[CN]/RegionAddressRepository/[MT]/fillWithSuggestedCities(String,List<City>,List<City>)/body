{
  preloadCities();
  if (name.length() < 3) {
    EnumSet<CityType> set=EnumSet.of(CityType.CITY,CityType.TOWN);
    for (    CityType t : set) {
      if (name.length() == 0) {
        citiesToFill.addAll(cityTypes.get(t));
      }
 else {
        name=name.toLowerCase();
        for (        City c : cityTypes.get(t)) {
          String lowerCase=c.getName().toLowerCase();
          if (lowerCase.startsWith(name)) {
            citiesToFill.add(c);
          }
        }
      }
    }
  }
 else {
    name=name.toLowerCase();
    int ind=0;
    Collection<City> src=source == null ? cities.values() : source;
    for (    City c : src) {
      String lowerCase=c.getName().toLowerCase();
      if (lowerCase.startsWith(name)) {
        citiesToFill.add(ind,c);
        ind++;
      }
 else       if (lowerCase.contains(name)) {
        citiesToFill.add(c);
      }
    }
  }
}
