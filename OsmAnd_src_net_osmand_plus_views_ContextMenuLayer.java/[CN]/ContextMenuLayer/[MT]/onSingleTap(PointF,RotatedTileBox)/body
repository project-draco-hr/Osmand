{
  if (mInChangeMarkerPositionMode) {
    return true;
  }
  if (pressedContextMarker(tileBox,point.x,point.y)) {
    hideVisibleMenues();
    menu.show();
    return true;
  }
  if (selectOnMap != null) {
    LatLon latlon=tileBox.getLatLonFromPixel(point.x,point.y);
    CallbackWithObject<LatLon> cb=selectOnMap;
    cb.processResult(latlon);
    menu.init(latlon,null,null);
    selectOnMap=null;
    return true;
  }
  if (!disableSingleTap()) {
    boolean res=showContextMenu(point,tileBox,false);
    if (res) {
      return true;
    }
 else {
      NativeOsmandLibrary nativeLib=NativeOsmandLibrary.getLoadedLibrary();
      if (nativeLib != null) {
        MapRenderRepositories maps=activity.getMyApplication().getResourceManager().getRenderer();
        RenderingContext rc=maps.getVisibleRenderingContext();
        RenderedObject[] renderedObjects=null;
        if (rc.zoom == tileBox.getZoom()) {
          double lat=MapUtils.get31LatitudeY((int)(rc.topY * rc.tileDivisor));
          double lon=MapUtils.get31LongitudeX((int)(rc.leftX * rc.tileDivisor));
          float x=tileBox.getPixXFromLatLon(lat,lon);
          float y=tileBox.getPixYFromLatLon(lat,lon);
          renderedObjects=nativeLib.searchRenderedObjectsFromContext(rc,(int)(point.x - x),(int)(point.y - y));
        }
        if (renderedObjects != null) {
          Map<Object,IContextMenuProvider> selectedObjects=new HashMap<>();
          IContextMenuProvider poiMenuProvider=activity.getMapLayers().getPoiMapLayer();
          IContextMenuProvider transportStopMenuProvider=activity.getMapLayers().getTransportStopsLayer();
          LatLon latLon=null;
          for (          RenderedObject renderedObject : renderedObjects) {
            if (renderedObject.getX() != null && renderedObject.getX().size() == 1 && renderedObject.getY() != null && renderedObject.getY().size() == 1) {
              latLon=new LatLon(MapUtils.get31LatitudeY(renderedObject.getY().get(0)),MapUtils.get31LongitudeX(renderedObject.getX().get(0)));
            }
 else {
              latLon=tileBox.getLatLonFromPixel(point.x,point.y);
            }
            if (renderedObject.getId() != null) {
              TransportStop transportStop=findTransportStop(renderedObject.getId() >> 1,latLon.getLatitude(),latLon.getLongitude());
              if (transportStop != null) {
                selectedObjects.put(transportStop,transportStopMenuProvider);
                continue;
              }
              List<String> names=new ArrayList<>();
              if (!Algorithms.isEmpty(renderedObject.getName())) {
                names.add(renderedObject.getName());
              }
              for (              Entry<String,String> entry : renderedObject.getTags().entrySet()) {
                if (entry.getKey().startsWith("name")) {
                  names.add(entry.getValue());
                }
              }
              Amenity amenity=findAmenity(renderedObject.getId() >> 6,names,latLon.getLatitude(),latLon.getLongitude());
              if (amenity != null) {
                selectedObjects.put(amenity,poiMenuProvider);
                continue;
              }
              TransportStop nearestTransportStop=findNearestTransportStop(latLon.getLatitude(),latLon.getLongitude());
              if (nearestTransportStop != null) {
                selectedObjects.put(nearestTransportStop,transportStopMenuProvider);
                continue;
              }
              if (renderedObject.getX() != null && renderedObject.getX().size() > 1 && renderedObject.getY() != null && renderedObject.getY().size() > 1) {
                List<Node> nodes=new ArrayList<>(renderedObject.getX().size());
                for (int i=0; i < renderedObject.getX().size(); i++) {
                  nodes.add(new Node(MapUtils.get31LatitudeY(renderedObject.getY().get(i)),MapUtils.get31LongitudeX(renderedObject.getX().get(i)),0));
                }
                latLon=OsmMapUtils.getMathWeightCenterForNodes(nodes);
              }
              selectedObjects.put(renderedObject,null);
            }
          }
          if (selectedObjects.size() > 0 && latLon != null) {
            showContextMenu(latLon,selectedObjects);
            return true;
          }
        }
      }
    }
  }
  hideVisibleMenues();
  menu.onSingleTapOnMap();
  return false;
}
