{
  View view=inflater.inflate(R.layout.fragment_live_updates,container,false);
  listView=(ExpandableListView)view.findViewById(android.R.id.list);
  View bottomShadowView=inflater.inflate(R.layout.shadow_bottom,listView,false);
  listView.addFooterView(bottomShadowView);
  adapter=new LocalIndexesAdapter(this);
  listView.setAdapter(adapter);
  listView.setOnChildClickListener(new ExpandableListView.OnChildClickListener(){
    @Override public boolean onChildClick(    ExpandableListView parent,    View v,    int groupPosition,    int childPosition,    long id){
      final FragmentManager fragmentManager=getChildFragmentManager();
      LiveUpdatesSettingsDialogFragment.createInstance(adapter.getChild(groupPosition,childPosition)).show(fragmentManager,"settings");
      return true;
    }
  }
);
  subscriptionHeader=inflater.inflate(R.layout.live_updates_header,listView,false);
  View subscriptionBanner=subscriptionHeader.findViewById(R.id.subscription_banner);
  View subscriptionInfo=subscriptionHeader.findViewById(R.id.subscription_info);
  Button subscriptionButton=(Button)subscriptionHeader.findViewById(R.id.subscription_button);
  subscriptionButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      SubscriptionFragment subscriptionFragment=new SubscriptionFragment();
      subscriptionFragment.show(getChildFragmentManager(),SubscriptionFragment.TAG);
    }
  }
);
  if (InAppHelper.isSubscribedToLiveUpdates()) {
    subscriptionBanner.setVisibility(View.GONE);
    subscriptionInfo.setVisibility(View.VISIBLE);
  }
 else {
    subscriptionBanner.setVisibility(View.VISIBLE);
    subscriptionInfo.setVisibility(View.GONE);
  }
  listView.addHeaderView(subscriptionHeader);
  loadLocalIndexesTask=new LoadLocalIndexTask(adapter,this).execute();
  return view;
}
