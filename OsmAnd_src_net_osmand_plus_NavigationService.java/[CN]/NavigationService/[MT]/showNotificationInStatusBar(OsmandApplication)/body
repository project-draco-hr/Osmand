{
  broadcastReceiver=new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      if (settings.SAVE_GLOBAL_TRACK_TO_GPX.get()) {
        settings.SAVE_GLOBAL_TRACK_TO_GPX.set(false);
      }
      OsMoPlugin osmoPlugin=OsmandPlugin.getEnabledPlugin(OsMoPlugin.class);
      if (osmoPlugin != null) {
        if (osmoPlugin.getTracker().isEnabledTracker()) {
          osmoPlugin.getTracker().disableTracker();
        }
      }
      OsmandMonitoringPlugin monitoringPlugin=OsmandPlugin.getEnabledPlugin(OsmandMonitoringPlugin.class);
      if (monitoringPlugin != null) {
        monitoringPlugin.stopRecording();
      }
      NavigationService.this.stopSelf();
    }
  }
;
  registerReceiver(broadcastReceiver,new IntentFilter(OSMAND_STOP_SERVICE_ACTION));
  int soi=settings.SERVICE_OFF_INTERVAL.get();
  String nt=getString(R.string.service_stop_background_service) + ". " + getString(R.string.gps_wake_up_timer)+ ": ";
  if (soi == 0) {
    nt=nt + getString(R.string.int_continuosly);
  }
 else   if (soi <= 90000) {
    nt=nt + Integer.toString(soi / 1000) + " "+ getString(R.string.int_seconds);
  }
 else {
    nt=nt + Integer.toString(soi / 1000 / 60) + " "+ getString(R.string.int_min);
  }
  Intent contentIntent=new Intent(this,MapActivity.class);
  PendingIntent contentPendingIntent=PendingIntent.getActivity(this,0,contentIntent,PendingIntent.FLAG_UPDATE_CURRENT);
  final Builder notificationBuilder=new NotificationCompat.Builder(this).setContentTitle(Version.getAppName(cl)).setContentText(getString(R.string.osmand_service)).setSmallIcon(R.drawable.bgs_icon).setContentIntent(contentPendingIntent).setOngoing(true);
  startForeground(NOTIFICATION_SERVICE_ID,notificationBuilder.build());
}
