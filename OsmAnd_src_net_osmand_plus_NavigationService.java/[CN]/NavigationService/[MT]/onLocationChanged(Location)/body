{
  if (location != null && !settings.MAP_ACTIVITY_ENABLED.get()) {
    if (!isContinuous()) {
      LocationManager locationManager=(LocationManager)getSystemService(LOCATION_SERVICE);
      locationManager.removeUpdates(this);
      WakeLock lock=getLock(this);
      if (lock.isHeld()) {
        lock.release();
      }
    }
 else {
      if (routingHelper.isFollowingMode() && routingHelper.getLeftDistance() > 0) {
        Message msg=Message.obtain(handler,new Runnable(){
          @Override public void run(){
            if (routingHelper.getLeftDistance() > 0 && !settings.MAP_ACTIVITY_ENABLED.get() && !handler.hasMessages(LOST_LOCATION_MSG_ID)) {
              routingHelper.getVoiceRouter().gpsLocationLost();
            }
          }
        }
);
        msg.what=LOST_LOCATION_MSG_ID;
        handler.removeMessages(LOST_LOCATION_MSG_ID);
        handler.sendMessageDelayed(msg,LOST_LOCATION_CHECK_DELAY);
      }
    }
    long locationTime=System.currentTimeMillis();
    savingTrackHelper.insertData(location.getLatitude(),location.getLongitude(),location.getAltitude(),location.getSpeed(),location.getAccuracy(),locationTime,settings);
    if (liveMonitoringHelper.isLiveMonitoringEnabled()) {
      liveMonitoringHelper.insertData(location.getLatitude(),location.getLongitude(),location.getAltitude(),location.getSpeed(),location.getAccuracy(),locationTime,settings);
    }
    if (routingHelper.isFollowingMode()) {
      routingHelper.setCurrentLocation(MapActivity.convertLocation(location),false);
    }
  }
}
