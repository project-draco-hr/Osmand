{
  frame=new JFrame("OsmAnd Map Creator");
  try {
    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
  }
 catch (  Exception e) {
    log.error("Can't set look and feel",e);
  }
  frame.addWindowListener(new ExitListener());
  Container content=frame.getContentPane();
  frame.setFocusable(true);
  statusBarLabel=new JLabel();
  content.add(statusBarLabel,BorderLayout.SOUTH);
  treePlaces=new JTree();
  treePlaces.setModel(new DefaultTreeModel(new DefaultMutableTreeNode("Region"),false));
  JSplitPane panelForTreeAndMap=new JSplitPane(JSplitPane.HORIZONTAL_SPLIT,new JScrollPane(treePlaces),mapPanel);
  panelForTreeAndMap.setResizeWeight(0.2);
  mapPanel.setFocusable(true);
  mapPanel.addMapLocationListener(this);
  createButtonsBar(content);
  if (searchList != null) {
    JSplitPane pane=new JSplitPane(JSplitPane.VERTICAL_SPLIT,new JScrollPane(searchList),panelForTreeAndMap);
    pane.setResizeWeight(0.2);
    content.add(pane,BorderLayout.CENTER);
  }
 else {
    content.add(panelForTreeAndMap,BorderLayout.CENTER);
  }
  treePlaces.addTreeSelectionListener(new TreeSelectionListener(){
    @Override public void valueChanged(    TreeSelectionEvent e){
      if (e.getPath() != null) {
        if (e.getPath().getLastPathComponent() instanceof DefaultMutableTreeNode) {
          Object o=((DefaultMutableTreeNode)e.getPath().getLastPathComponent()).getUserObject();
          if (o instanceof City) {
            City c=(City)o;
            mapPanel.setLatLon(c.getNode().getLatitude(),c.getNode().getLongitude());
            mapPanel.requestFocus();
          }
          if (o instanceof Amenity) {
            Amenity c=(Amenity)o;
            mapPanel.setLatLon(c.getNode().getLatitude(),c.getNode().getLongitude());
            mapPanel.requestFocus();
          }
          if (o instanceof Entity) {
            Entity c=(Entity)o;
            if (c instanceof Node) {
              mapPanel.setLatLon(((Node)c).getLatitude(),((Node)c).getLongitude());
              mapPanel.requestFocus();
            }
 else {
              DefaultMutableTreeNode n=(DefaultMutableTreeNode)e.getPath().getPathComponent(e.getPath().getPathCount() - 2);
              if (n.getUserObject() instanceof Street) {
                Street str=(Street)n.getUserObject();
                LatLon l=str.getLocationBuilding(c);
                mapPanel.setLatLon(l.getLatitude(),l.getLongitude());
                mapPanel.requestFocus();
              }
            }
          }
        }
      }
    }
  }
);
}
