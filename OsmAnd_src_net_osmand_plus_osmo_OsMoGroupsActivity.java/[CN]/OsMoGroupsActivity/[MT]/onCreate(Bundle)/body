{
  if (Build.VERSION.SDK_INT > Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
    getWindow().setUiOptions(ActivityInfo.UIOPTION_SPLIT_ACTION_BAR_WHEN_NARROW);
  }
  super.onCreate(icicle);
  app=(OsmandApplication)getApplication();
  osMoPlugin=OsmandPlugin.getEnabledPlugin(OsMoPlugin.class);
  if (getIntent() != null) {
    if ("http".equals(getIntent().getScheme())) {
      new OsMoIntentHandler(app,osMoPlugin).execute(getIntent());
    }
  }
  setContentView(R.layout.expandable_list);
  getSupportActionBar().setTitle(R.string.osmo_activity);
  setSupportProgressBarIndeterminateVisibility(false);
  setupHeader();
  setupFooter();
  adapter=new OsMoGroupsAdapter(osMoPlugin.getGroups(),osMoPlugin.getTracker(),osMoPlugin.getService());
  setListAdapter(adapter);
  uiHandler=new Handler();
  directionPath=createDirectionPath();
  white=new Paint();
  white.setStyle(Style.FILL_AND_STROKE);
  white.setColor(getResources().getColor(R.color.color_unknown));
  white.setAntiAlias(true);
  updateStatus();
  setOnChildClickListener(new ExpandableListView.OnChildClickListener(){
    @Override public boolean onChildClick(    ExpandableListView parent,    View v,    int groupPosition,    int childPosition,    long id){
      OsMoDevice model=adapter.getChild(groupPosition,childPosition);
      if (model != selectedObject) {
        enterSelectionMode(model);
      }
 else {
        quitSelectionMode();
      }
      return true;
    }
  }
);
}
