{
  this.context=context;
  this.renderer=new MapRenderRepositories(context);
  asyncLoadingThread.start();
  tileDownloader=MapTileDownloader.getInstance(Version.getFullVersion(context));
  try {
    context.getSettings().extendOsmandPath(APP_DIR + ".nomedia").createNewFile();
  }
 catch (  Exception e) {
  }
  resetStoreDirectory();
  WindowManager mgr=(WindowManager)getContext().getSystemService(Context.WINDOW_SERVICE);
  DisplayMetrics dm=new DisplayMetrics();
  mgr.getDefaultDisplay().getMetrics(dm);
  float tiles=(dm.widthPixels / 256 + 2) * (dm.heightPixels / 256 + 2) * 3;
  log.info("Tiles to load in memory : " + tiles);
  maxImgCacheSize=(int)(tiles);
}
