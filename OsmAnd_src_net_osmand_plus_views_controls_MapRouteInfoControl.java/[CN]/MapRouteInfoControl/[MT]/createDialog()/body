{
  AlertDialog.Builder builder=new AlertDialog.Builder(mapActivity);
  View lmain=mapActivity.getLayoutInflater().inflate(R.layout.plan_route_info,null);
  boolean addButtons=routingHelper.isRouteCalculated();
  updateInfo(lmain);
  if (addButtons) {
    attachListeners(lmain);
  }
 else {
    lmain.findViewById(R.id.RouteInfoControls).setVisibility(View.GONE);
    lmain.findViewById(R.id.SimulateRoute).setVisibility(View.GONE);
    TextView textView=(TextView)lmain.findViewById(R.id.ValidateTextView);
    TargetPointsHelper targets=getTargets();
    if (targets.hasTooLongDistanceToNavigate()) {
      textView.setText(R.string.route_is_too_long);
      textView.setVisibility(View.VISIBLE);
    }
 else {
      textView.setVisibility(View.GONE);
    }
  }
  builder.setView(lmain);
  Dialog dialog=builder.create();
  dialog.setCanceledOnTouchOutside(true);
  WindowManager.LayoutParams lp=new WindowManager.LayoutParams();
  lp.copyFrom(dialog.getWindow().getAttributes());
  lp.width=WindowManager.LayoutParams.WRAP_CONTENT;
  lp.height=WindowManager.LayoutParams.WRAP_CONTENT;
  lp.gravity=Gravity.BOTTOM;
  lp.y=(int)(infoButton.getBottom() - infoButton.getTop() + scaleCoefficient * 5);
  dialog.getWindow().clearFlags(WindowManager.LayoutParams.FLAG_DIM_BEHIND);
  dialog.getWindow().requestFeature(Window.FEATURE_NO_TITLE);
  dialog.getWindow().setAttributes(lp);
  return dialog;
}
