{
  final List<Object> points;
  if (flat) {
    points=new ArrayList<Object>(waypointHelper.getAllPoints());
  }
 else {
    points=getPoints();
  }
  List<Object> activePoints=getActivePoints(points);
  return new StableArrayAdapter(ctx,R.layout.waypoint_reached,R.id.title,points,activePoints){
    @Override public boolean isEnabled(    int position){
      Object obj=getItem(position);
      boolean labelView=(obj instanceof Integer);
      boolean topDividerView=(obj instanceof Boolean) && ((Boolean)obj);
      boolean bottomDividerView=(obj instanceof Boolean) && !((Boolean)obj);
      boolean enabled=!labelView && !topDividerView && !bottomDividerView;
      if (enabled && obj instanceof RadiusItem) {
        int type=((RadiusItem)obj).type;
        enabled=type != WaypointHelper.POI;
      }
      return enabled;
    }
    @Override public View getView(    final int position,    View convertView,    ViewGroup parent){
      View v=convertView;
      final ArrayAdapter<Object> thisAdapter=this;
      Object obj=getItem(position);
      boolean labelView=(obj instanceof Integer);
      boolean topDividerView=(obj instanceof Boolean) && ((Boolean)obj);
      boolean bottomDividerView=(obj instanceof Boolean) && !((Boolean)obj);
      if (obj instanceof RadiusItem) {
        final int type=((RadiusItem)obj).type;
        v=createItemForRadiusProximity(ctx,type,running,position,thisAdapter,nightMode);
        AndroidUtils.setListItemBackground(mapActivity,v,nightMode);
      }
 else       if (labelView) {
        v=createItemForCategory(ctx,(Integer)obj,running,position,thisAdapter,nightMode);
        AndroidUtils.setListItemBackground(mapActivity,v,nightMode);
      }
 else       if (topDividerView) {
        v=ctx.getLayoutInflater().inflate(R.layout.card_top_divider,null);
      }
 else       if (bottomDividerView) {
        v=ctx.getLayoutInflater().inflate(R.layout.card_bottom_divider,null);
      }
 else       if (obj instanceof LocationPointWrapper) {
        LocationPointWrapper point=(LocationPointWrapper)obj;
        v=updateWaypointItemView(edit,deletedPoints,app,ctx,v,point,this,nightMode,flat);
        AndroidUtils.setListItemBackground(mapActivity,v,nightMode);
      }
      return v;
    }
  }
;
}
