{
  final List<Object> points;
  if (flat) {
    points=new ArrayList<Object>(waypointHelper.getAllPoints());
  }
 else {
    points=getPoints();
  }
  return new ArrayAdapter<Object>(ctx,R.layout.waypoint_reached,R.id.title,points){
    @Override public View getView(    final int position,    View convertView,    ViewGroup parent){
      View v=convertView;
      final ArrayAdapter<Object> thisAdapter=this;
      Object obj=getItem(position);
      boolean labelView=(obj instanceof Integer);
      boolean topDividerView=(obj instanceof Boolean) && ((Boolean)obj);
      boolean bottomDividerView=(obj instanceof Boolean) && !((Boolean)obj);
      if (obj instanceof RadiusItem) {
        final int type=((RadiusItem)obj).type;
        v=createItemForRadiusProximity(ctx,type,running,position,thisAdapter,nightMode);
        if (nightMode) {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_dark));
        }
 else {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_light));
        }
      }
 else       if (labelView) {
        v=createItemForCategory(ctx,(Integer)obj,running,position,thisAdapter,nightMode);
        if (nightMode) {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_dark));
        }
 else {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_light));
        }
      }
 else       if (topDividerView) {
        v=ctx.getLayoutInflater().inflate(R.layout.card_top_divider,null);
      }
 else       if (bottomDividerView) {
        v=ctx.getLayoutInflater().inflate(R.layout.card_bottom_divider,null);
      }
 else       if (obj instanceof LocationPointWrapper) {
        LocationPointWrapper point=(LocationPointWrapper)obj;
        v=updateWaypointItemView(edit,deletedPoints,app,ctx,v,point,this,nightMode);
        if (nightMode) {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_dark));
        }
 else {
          v.setBackgroundColor(mapActivity.getResources().getColor(R.color.bg_color_light));
        }
      }
      return v;
    }
  }
;
}
