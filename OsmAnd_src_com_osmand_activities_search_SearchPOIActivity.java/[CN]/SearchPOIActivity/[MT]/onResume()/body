{
  super.onResume();
  if (searchNearBy) {
    location=null;
  }
  if (filter != null && location != null) {
    searchedLocation=location;
    amenityAdapter.setNewModel(filter.initializeNewSearch(location.getLatitude(),location.getLongitude(),40));
    searchPOILevel.setEnabled(filter.isSearchFurtherAvailable());
    searchArea.setText(filter.getSearchArea());
  }
 else {
    amenityAdapter.notifyDataSetChanged();
    searchPOILevel.setEnabled(false);
  }
  if (searchNearBy && location == null) {
    searchPOILevel.setText(R.string.search_poi_location);
  }
 else {
    searchPOILevel.setText(R.string.search_POI_level_btn);
  }
  showOnMap.setEnabled(filter != null);
  if (searchNearBy) {
    LocationManager service=(LocationManager)getSystemService(LOCATION_SERVICE);
    service.requestLocationUpdates(LocationManager.GPS_PROVIDER,GPS_TIMEOUT_REQUEST,GPS_DIST_REQUEST,this);
    if (!isRunningOnEmulator() && !service.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
      service.requestLocationUpdates(LocationManager.NETWORK_PROVIDER,GPS_TIMEOUT_REQUEST,GPS_DIST_REQUEST,this);
      currentLocationProvider=LocationManager.NETWORK_PROVIDER;
    }
  }
}
