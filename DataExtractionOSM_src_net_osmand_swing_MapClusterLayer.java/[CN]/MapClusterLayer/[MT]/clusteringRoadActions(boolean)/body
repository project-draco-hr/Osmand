{
  Point popupMenuPoint=map.getPopupMenuPoint();
  double fy=(popupMenuPoint.y - map.getCenterPointY()) / map.getTileSize();
  double fx=(popupMenuPoint.x - map.getCenterPointX()) / map.getTileSize();
  final double latitude=MapUtils.getLatitudeFromTile(map.getZoom(),map.getYTile() + fy);
  final double longitude=MapUtils.getLongitudeFromTile(map.getZoom(),map.getXTile() + fx);
  new Thread(new Runnable(){
    @Override public void run(){
      List<Way> ways;
      try {
        ways=clustering(latitude,longitude,tertiary ? notClusterRoads : notClusterRoadsWOTertiary);
        DataTileManager<Way> points=new DataTileManager<Way>();
        points.setZoom(11);
        for (        Way w : ways) {
          LatLon n=w.getLatLon();
          points.registerObject(n.getLatitude(),n.getLongitude(),w);
        }
        map.setPoints(points);
        map.repaint();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
).start();
}
