{
  boolean processed=false;
  String operation=command;
  if (command.startsWith("GROUP_CHANGE:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    OsMoGroup gr=storage.getGroup(gid);
    if (gr != null) {
      List<OsMoDevice> delta=mergeGroup(gr,obj,false);
      for (      OsMoDevice d : delta) {
        if (d.getDeletedTimestamp() != 0 && d.isEnabled()) {
          disconnectImpl(d);
        }
 else         if (d.isEnabled() && !d.isActive()) {
          connectDeviceImpl(d);
        }
      }
      storage.save();
    }
    processed=true;
  }
 else   if (command.startsWith("GROUP_DISCONNECT:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    OsMoGroup gr=storage.getGroup(gid);
    if (gr != null) {
      disconnectAllGroupUsers(gr);
    }
    processed=true;
  }
 else   if (command.startsWith("GROUP_CONNECT:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    OsMoGroup gr=storage.getGroup(gid);
    if (gr != null) {
      mergeGroup(gr,obj,true);
      gr.active=true;
      for (      OsMoDevice d : storage.getMainGroup().getGroupUsers()) {
        connectDeviceImpl(d);
      }
      storage.save();
    }
    processed=true;
  }
 else   if (command.startsWith("GROUP_CREATE:") || command.startsWith("GROUP_JOIN:")) {
    if (command.startsWith("GROUP_CREATE:")) {
      operation="GROUP_CREATE";
    }
    String gid=command.substring(command.indexOf(':') + 1);
    OsMoGroup gr=storage.getGroup(gid);
    if (gr == null) {
      gr=new OsMoGroup();
      gr.groupId=gid;
    }
    parseGroup(obj,gr);
    connectGroupImpl(gr);
    storage.save();
    processed=true;
  }
 else   if (command.startsWith("LEAVE_GROUP:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    OsMoGroup gr=storage.getGroup(gid);
    if (gr != null) {
      disconnectAllGroupUsers(gr);
      storage.deleteGroup(gr);
      storage.save();
    }
    processed=true;
  }
  if (processed && uiListener != null) {
    uiListener.groupsListChange(operation);
  }
  return processed;
}
