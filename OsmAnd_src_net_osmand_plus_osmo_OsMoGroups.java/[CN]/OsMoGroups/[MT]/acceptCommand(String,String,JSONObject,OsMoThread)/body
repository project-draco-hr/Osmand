{
  boolean processed=false;
  String operation=command;
  OsMoGroup group=null;
  if (command.startsWith("GROUP_CHANGE:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    group=storage.getGroup(gid);
    if (group != null) {
      List<OsMoDevice> delta=mergeGroup(group,obj,false);
      for (      OsMoDevice d : delta) {
        if (d.getDeletedTimestamp() != 0 && d.isEnabled()) {
          disconnectImpl(d);
        }
 else         if (d.isEnabled() && !d.isActive()) {
          connectDeviceImpl(d);
        }
      }
      storage.save();
    }
    processed=true;
  }
 else   if (command.startsWith("GROUP_DISCONNECT:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    group=storage.getGroup(gid);
    if (group != null) {
      disconnectAllGroupUsers(group);
    }
    processed=true;
  }
 else   if (command.startsWith("GROUP_CONNECT:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    group=storage.getGroup(gid);
    if (group != null) {
      mergeGroup(group,obj,true);
      group.active=true;
      for (      OsMoDevice d : storage.getMainGroup().getGroupUsers()) {
        connectDeviceImpl(d);
      }
      storage.save();
    }
    processed=true;
  }
 else   if (command.startsWith("AGROUP_CREATE:") || command.startsWith("GROUP_JOIN:")) {
    if (command.startsWith("AGROUP_CREATE:")) {
      operation="AGROUP_CREATE";
    }
    String gid=command.substring(command.indexOf(':') + 1);
    group=storage.getGroup(gid);
    if (group == null) {
      group=new OsMoGroup();
      group.groupId=gid;
    }
    parseGroup(obj,group);
    connectGroupImpl(group);
    storage.save();
    processed=true;
  }
 else   if (command.startsWith("LEAVE_GROUP:")) {
    String gid=command.substring(command.indexOf(':') + 1);
    group=storage.getGroup(gid);
    if (group != null) {
      disconnectAllGroupUsers(group);
      storage.deleteGroup(group);
      storage.save();
    }
    processed=true;
  }
  if (processed && uiListener != null) {
    uiListener.groupsListChange(operation,group);
  }
  return processed;
}
