{
  super.onResume();
  if (getMyApplication().getFavorites().getFavouritePoints().size() > 0) {
    if (!getMyApplication().getSettings().isLastKnownMapLocation()) {
      location=getMyApplication().getLocationProvider().getFirstTimeRunDefaultLocation();
      loc=new LatLon(getMyApplication().getLocationProvider().getFirstTimeRunDefaultLocation().getLatitude(),getMyApplication().getLocationProvider().getFirstTimeRunDefaultLocation().getLongitude());
    }
 else {
      location=getLocationProvider().getLastKnownLocation();
      loc=new LatLon(getLocationProvider().getLastKnownLocation().getLatitude(),getLocationProvider().getLastKnownLocation().getLongitude());
    }
    if (loc == null) {
      loc=getMyApplication().getSettings().getLastKnownMapLocation();
    }
    updateLocation(loc);
  }
  setupFavorites();
}
