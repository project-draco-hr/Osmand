{
  OsmandPreference<Boolean> boolPref=booleanPreferences.get(preference.getKey());
  OsmandPreference<Integer> seekPref=seekBarPreferences.get(preference.getKey());
  OsmandPreference<Object> listPref=(OsmandPreference<Object>)listPreferences.get(preference.getKey());
  OsmandPreference<String> editPref=editTextPreferences.get(preference.getKey());
  if (boolPref != null) {
    boolPref.set((Boolean)newValue);
    if (boolPref.getId().equals(osmandSettings.NATIVE_RENDERING.getId())) {
      if (((Boolean)newValue).booleanValue()) {
        loadNativeLibrary();
      }
    }
  }
 else   if (seekPref != null) {
    seekPref.set((Integer)newValue);
  }
 else   if (editPref != null) {
    editPref.set((String)newValue);
  }
 else   if (listPref != null) {
    int ind=((ListPreference)preference).findIndexOfValue((String)newValue);
    CharSequence entry=((ListPreference)preference).getEntries()[ind];
    Map<String,?> map=listPrefValues.get(preference.getKey());
    Object obj=map.get(entry);
    final Object oldValue=listPref.get();
    boolean changed=listPref.set(obj);
    if (changed) {
      if (listPref.getId().equals(osmandSettings.VOICE_PROVIDER.getId())) {
        if (MORE_VALUE.equals(newValue)) {
          listPref.set(oldValue);
          final Intent intent=new Intent(this,DownloadIndexActivity.class);
          intent.putExtra(DownloadIndexActivity.FILTER_KEY,"voice");
          startActivity(intent);
        }
 else {
          getMyApplication().showDialogInitializingCommandPlayer(this,false);
        }
      }
 else       if (listPref.getId().equals(osmandSettings.ROUTER_SERVICE.getId())) {
        routerServicePreference.setSummary(getString(R.string.router_service_descr) + "  [" + osmandSettings.ROUTER_SERVICE.get()+ "]");
      }
 else       if (listPref.getId().equals(osmandSettings.APPLICATION_MODE.getId())) {
        updateAllSettings();
      }
 else       if (listPref.getId().equals(osmandSettings.PREFERRED_LOCALE.getId())) {
        getMyApplication().checkPrefferedLocale();
        Intent intent=getIntent();
        finish();
        startActivity(intent);
      }
 else       if (listPref.getId().equals(osmandSettings.DAYNIGHT_MODE.getId())) {
        dayNightModePreference.setSummary(getString(R.string.daynight_descr) + "  [" + osmandSettings.DAYNIGHT_MODE.get().toHumanString(this)+ "]");
      }
    }
  }
 else   if (preference == applicationDir) {
    warnAboutChangingStorage((String)newValue);
    return false;
  }
  return true;
}
