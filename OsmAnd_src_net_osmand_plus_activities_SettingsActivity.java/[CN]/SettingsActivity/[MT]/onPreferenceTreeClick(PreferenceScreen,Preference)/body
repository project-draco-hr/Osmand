{
  String title="";
  if (preference.getKey() != null && preference instanceof PreferenceScreen && SettingsActivity.SCREEN_ID_NAVIGATION_SETTINGS.equals(preference.getKey())) {
    PreferenceScreen scr=(PreferenceScreen)preference;
    title=scr.getTitle().toString();
    if (title.startsWith("-")) {
      title=title.substring(1);
    }
    scr.getDialog().setTitle("   " + title + " ["+ osmandSettings.APPLICATION_MODE.get().toHumanString(this)+ "]");
  }
 else   if (preference instanceof PreferenceScreen) {
    final PreferenceScreen scr=(PreferenceScreen)preference;
    title=scr.getTitle().toString();
    scr.getDialog().setTitle("   " + title);
  }
  if (preference instanceof PreferenceScreen) {
    final PreferenceScreen scr=(PreferenceScreen)preference;
    CustomTitleBarView titleBar=new CustomTitleBarView(title,R.drawable.tab_settings_screen_icon,null){
      @Override public void backPressed(){
        scr.getDialog().dismiss();
      }
    }
;
    View titleView=getLayoutInflater().inflate(titleBar.getTitleBarLayout(),null);
    titleBar.init(titleView);
    View dv=scr.getDialog().getWindow().getDecorView();
    ListView ls=(ListView)dv.findViewById(android.R.id.list);
    if (ls != null) {
      ls.addFooterView(titleView);
    }
  }
  if (preference == applicationDir) {
    return true;
  }
  return super.onPreferenceTreeClick(preferenceScreen,preference);
}
