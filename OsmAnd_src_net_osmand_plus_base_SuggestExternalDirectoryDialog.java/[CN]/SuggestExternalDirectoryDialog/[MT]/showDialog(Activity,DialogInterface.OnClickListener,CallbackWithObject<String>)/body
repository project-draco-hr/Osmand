{
  final boolean showOther=otherListener != null;
  final OsmandApplication app=(OsmandApplication)a.getApplication();
  Builder bld=new AlertDialog.Builder(a);
  HashSet<String> externalMounts=getExternalMounts();
  String apath=app.getSettings().getExternalStorageDirectory().getAbsolutePath();
  externalMounts.add(app.getExternalServiceAPI().getExternalStorageDirectory());
  externalMounts.add(apath);
  final String[] extMounts=new String[showOther ? externalMounts.size() + 1 : externalMounts.size()];
  externalMounts.toArray(extMounts);
  if (showOther) {
    extMounts[extMounts.length - 1]=a.getString(R.string.other_location);
  }
  if (extMounts.length > 1) {
    int checkedItem=0;
    for (int j=0; j < extMounts.length; j++) {
      if (extMounts[j].equals(apath)) {
        checkedItem=j;
        break;
      }
    }
    bld.setTitle(R.string.application_dir);
    bld.setSingleChoiceItems(extMounts,checkedItem,new OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        if (showOther && which == extMounts.length - 1) {
          otherListener.onClick(dialog,which);
        }
 else {
          dialog.dismiss();
          if (selector != null) {
            selector.processResult(extMounts[which]);
          }
 else {
            app.getSettings().setExternalStorageDirectory(extMounts[which]);
            app.getResourceManager().resetStoreDirectory();
          }
        }
      }
    }
);
    bld.setPositiveButton(R.string.default_buttons_ok,null);
    bld.show();
    return true;
  }
  return false;
}
