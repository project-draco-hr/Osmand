{
  waypointDialogHelper=new WaypointDialogHelper(mapActivity);
  landscape=!ScreenOrientationHelper.isOrientationPortrait(mapActivity);
  dashboardView=(FrameLayout)mapActivity.findViewById(R.id.dashboard);
  View.OnClickListener listener=new View.OnClickListener(){
    @Override public void onClick(    View v){
      hideDashboard();
    }
  }
;
  scrollView=((NotifyingScrollView)dashboardView.findViewById(R.id.main_scroll));
  listView=(ListView)dashboardView.findViewById(R.id.dash_list_view);
  scrollView.setOnScrollChangedListener(new NotifyingScrollView.OnScrollChangedListener(){
    public void onScrollChanged(    ScrollView who,    int l,    int t,    int oldl,    int oldt){
      int sy=who.getScrollY();
      updateTopButton(sy);
    }
  }
);
  gradientToolbar=mapActivity.getResources().getDrawable(R.drawable.gradient_toolbar).mutate();
  if (ScreenOrientationHelper.isOrientationPortrait(mapActivity)) {
    ((ObservableListView)listView).setScrollViewCallbacks(this);
    mFlexibleSpaceImageHeight=mapActivity.getResources().getDimensionPixelSize(R.dimen.dashboard_map_top_padding);
    paddingView=new View(mapActivity);
    AbsListView.LayoutParams lp=new AbsListView.LayoutParams(AbsListView.LayoutParams.MATCH_PARENT,mFlexibleSpaceImageHeight);
    paddingView.setLayoutParams(lp);
    paddingView.setClickable(true);
    paddingView.setOnClickListener(listener);
    listView.addHeaderView(paddingView);
    listBackgroundView=mapActivity.findViewById(R.id.dash_list_background);
  }
  dashboardView.findViewById(R.id.animateContent).setOnClickListener(listener);
  dashboardView.findViewById(R.id.map_part_dashboard).setOnClickListener(listener);
  initActionButton();
  dashboardView.addView(actionButton);
}
