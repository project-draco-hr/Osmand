{
  baseColor=mapActivity.getResources().getColor(R.color.osmand_orange) & 0x00ffffff;
  waypointDialogHelper=new WaypointDialogHelper(mapActivity);
  landscape=!AndroidUiHelper.isOrientationPortrait(mapActivity);
  dashboardView=(FrameLayout)mapActivity.findViewById(R.id.dashboard);
  View.OnClickListener listener=new View.OnClickListener(){
    @Override public void onClick(    View v){
      hideDashboard();
    }
  }
;
  toolbar=((Toolbar)dashboardView.findViewById(R.id.toolbar));
  ObservableScrollView scrollView=((ObservableScrollView)dashboardView.findViewById(R.id.main_scroll));
  listView=(ListView)dashboardView.findViewById(R.id.dash_list_view);
  gradientToolbar=mapActivity.getResources().getDrawable(R.drawable.gradient_toolbar).mutate();
  if (AndroidUiHelper.isOrientationPortrait(mapActivity)) {
    this.portrait=true;
    scrollView.setScrollViewCallbacks(this);
    ((ObservableListView)listView).setScrollViewCallbacks(this);
    mFlexibleSpaceImageHeight=mapActivity.getResources().getDimensionPixelSize(R.dimen.dashboard_map_top_padding);
    mFlexibleBlurSpaceHeight=mapActivity.getResources().getDimensionPixelSize(R.dimen.dashboard_map_toolbar);
    paddingView=new FrameLayout(mapActivity);
    AbsListView.LayoutParams lp=new AbsListView.LayoutParams(AbsListView.LayoutParams.MATCH_PARENT,mFlexibleSpaceImageHeight);
    paddingView.setLayoutParams(lp);
    paddingView.setClickable(true);
    paddingView.setOnClickListener(listener);
    FrameLayout shadowContainer=new FrameLayout(mapActivity);
    FrameLayout.LayoutParams fl=new FrameLayout.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT,FrameLayout.LayoutParams.MATCH_PARENT);
    fl.gravity=Gravity.BOTTOM;
    shadowContainer.setLayoutParams(fl);
    ImageView shadow=new ImageView(mapActivity);
    shadow.setImageDrawable(mapActivity.getResources().getDrawable(R.drawable.bg_shadow_onmap));
    shadow.setLayoutParams(new FrameLayout.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT,FrameLayout.LayoutParams.WRAP_CONTENT,Gravity.BOTTOM));
    shadow.setScaleType(ScaleType.FIT_XY);
    shadowContainer.addView(shadow);
    ((FrameLayout)paddingView).addView(shadowContainer);
    listView.addHeaderView(paddingView);
    listBackgroundView=mapActivity.findViewById(R.id.dash_list_background);
  }
  dashboardView.findViewById(R.id.animateContent).setOnClickListener(listener);
  dashboardView.findViewById(R.id.map_part_dashboard).setOnClickListener(listener);
  initActionButtons();
  dashboardView.addView(actionButton);
}
