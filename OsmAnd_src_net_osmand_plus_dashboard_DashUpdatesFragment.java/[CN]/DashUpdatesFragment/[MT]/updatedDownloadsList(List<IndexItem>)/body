{
  List<IndexItem> itemList=new ArrayList<IndexItem>(list);
  Collections.sort(itemList,new Comparator<IndexItem>(){
    @Override public int compare(    IndexItem indexItem,    IndexItem t1){
      DatabaseHelper helper=BaseDownloadActivity.downloadListIndexThread.getDbHelper();
      return (int)(helper.getCount(t1.getBasename(),DatabaseHelper.DOWNLOAD_ENTRY) - helper.getCount(indexItem.getBasename(),DatabaseHelper.DOWNLOAD_ENTRY));
    }
  }
);
  View mainView=getView();
  if (mainView == null) {
    return;
  }
  progressBars.clear();
  baseNames.clear();
  downloadButtons.clear();
  ((TextView)mainView.findViewById(R.id.header)).setText(getString(R.string.map_update,String.valueOf(list.size())));
  LinearLayout updates=(LinearLayout)mainView.findViewById(R.id.updates_items);
  updates.removeAllViews();
  if (itemList.size() < 1) {
    mainView.findViewById(R.id.maps).setVisibility(View.GONE);
    return;
  }
 else {
    mainView.findViewById(R.id.maps).setVisibility(View.VISIBLE);
  }
  for (int i=0; i < itemList.size(); i++) {
    final IndexItem item=itemList.get(i);
    if (i > 2) {
      break;
    }
    LayoutInflater inflater=getActivity().getLayoutInflater();
    View view=inflater.inflate(R.layout.dash_updates_item,null,false);
    String name=item.getVisibleName(getMyApplication(),getMyApplication().getResourceManager().getOsmandRegions());
    String d=item.getDate(getMyApplication().getResourceManager().getDateFormat()) + ", " + item.getSizeDescription(getMyApplication());
    String eName=name.replace("\n"," ");
    ((TextView)view.findViewById(R.id.map_name)).setText(eName);
    ((TextView)view.findViewById(R.id.map_descr)).setText(d);
    final ProgressBar progressBar=(ProgressBar)view.findViewById(R.id.ProgressBar);
    View downloadButton=(view.findViewById(R.id.btn_download));
    downloadButton.setOnClickListener(new View.OnClickListener(){
      @Override public void onClick(      View view){
        if (getDownloadActivity().isInQueue(item)) {
          getDownloadActivity().removeFromQueue(item);
          ((ImageButton)view).setImageResource(R.drawable.download_button);
        }
 else         if (!getDownloadActivity().startDownload(item)) {
          ((ImageButton)view).setImageResource(R.drawable.cancel_button);
        }
      }
    }
);
    downloadButtons.add((ImageButton)downloadButton);
    baseNames.add(item.getBasename());
    progressBars.add(progressBar);
    updates.addView(view);
  }
  updateProgress(BaseDownloadActivity.downloadListIndexThread.getCurrentRunningTask(),false);
}
