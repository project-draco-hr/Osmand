{
  super.onCreate(icicle);
  settings=OsmandSettings.getOsmandSettings(this);
  Intent intent=getIntent();
  if (intent != null) {
    float lat=intent.getFloatExtra(SEARCH_LAT,0);
    float lon=intent.getFloatExtra(SEARCH_LON,0);
    if (lat != 0 || lon != 0) {
      lastKnownMapLocation=new LatLon(lat,lon);
    }
  }
  if (lastKnownMapLocation == null) {
    lastKnownMapLocation=OsmandSettings.getOsmandSettings(this).getLastKnownMapLocation();
  }
  setContentView(R.layout.search_transport);
  searchTransportLevel=(Button)findViewById(R.id.SearchTransportLevelButton);
  searchTransportLevel.setText(R.string.search_POI_level_btn);
  searchTransportLevel.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      if (!isRouteCalculated()) {
        if (isSearchFurtherAvailable()) {
          zoom--;
          searchTransport();
        }
      }
 else {
        intermediateListAdapater.clear();
        intermediateListAdapater.add(null);
        searchTransport();
      }
    }
  }
);
  searchArea=(TextView)findViewById(R.id.SearchAreaText);
  progress=(ProgressBar)findViewById(R.id.ProgressBar);
  progress.setVisibility(View.INVISIBLE);
  stopsAdapter=new TransportStopAdapter(new ArrayList<RouteInfoLocation>());
  setListAdapter(stopsAdapter);
  ListView intermediateList=(ListView)findViewById(R.id.listView);
  intermediateListAdapater=new TransportRouteAdapter(TransportRouteHelper.getInstance().getRoute());
  intermediateList.setAdapter(intermediateListAdapater);
  if (intermediateList.getCount() == 0) {
    intermediateListAdapater.add(null);
  }
}
