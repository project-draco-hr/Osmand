{
  ResultSet rs;
  try {
    rs=statement.executeQuery(select);
    Entity prevEntity=null;
    long prevId=-1;
    while (rs.next()) {
      long curId=rs.getLong(1);
      boolean newEntity=curId != prevId;
      Entity e=prevEntity;
      if (type == EntityType.NODE) {
        if (newEntity) {
          e=new Node(rs.getDouble(2),rs.getDouble(3),curId);
        }
        e.putTag(rs.getString(4),rs.getString(5));
      }
 else       if (type == EntityType.WAY) {
        if (newEntity) {
          e=new Way(curId);
        }
        int ord=rs.getInt(3);
        if (ord == 0 && rs.getObject(4) != null) {
          e.putTag(rs.getString(4),rs.getString(5));
        }
        if (newEntity || ord > 0) {
          ((Way)e).addNode(new Node(rs.getDouble(6),rs.getDouble(7),rs.getLong(2)));
        }
      }
 else {
        if (newEntity) {
          e=new Relation(curId);
        }
        e.putTag(rs.getString(2),rs.getString(3));
      }
      if (newEntity) {
        if (prevEntity != null) {
          toProcess.put(prevEntity);
        }
        prevEntity=e;
      }
      prevId=curId;
    }
    if (prevEntity != null) {
      toProcess.put(prevEntity);
    }
    rs.close();
  }
 catch (  SQLException e1) {
    e1.printStackTrace();
  }
catch (  InterruptedException e) {
    e.printStackTrace();
  }
 finally {
    try {
      toProcess.put(getEndingEntity());
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
    }
  }
}
