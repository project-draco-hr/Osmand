{
  ResultSet rs;
  try {
    select.execute();
    rs=select.getResultSet();
    Entity prevEntity=null;
    long prevId=Long.MIN_VALUE;
    while (rs.next()) {
      long curId=rs.getLong(1);
      boolean newEntity=curId != prevId;
      Entity e=prevEntity;
      if (type == EntityType.NODE) {
        e=new Node(rs.getDouble(2),rs.getDouble(3),curId);
        readTags(e,rs.getBytes(4));
      }
 else       if (type == EntityType.WAY || type == EntityType.WAY_BOUNDARY) {
        if (newEntity) {
          e=new Way(curId);
        }
        int ord=rs.getInt(3);
        if (ord == 0) {
          readTags(e,rs.getBytes(4));
        }
        if (rs.getObject(6) == null) {
          ((Way)e).addNode(rs.getLong(2));
        }
 else {
          Node n=new Node(rs.getDouble(5),rs.getDouble(6),rs.getLong(2));
          readTags(n,rs.getBytes(7));
          ((Way)e).addNode(n);
        }
      }
 else {
        e=new Relation(curId);
        readTags(e,rs.getBytes(2));
      }
      if (newEntity) {
        if (prevEntity != null) {
          toProcess.put(prevEntity);
        }
        prevEntity=e;
      }
      prevId=curId;
    }
    if (prevEntity != null) {
      toProcess.put(prevEntity);
    }
    rs.close();
  }
 catch (  SQLException e1) {
    e1.printStackTrace();
  }
catch (  InterruptedException e) {
    e.printStackTrace();
  }
 finally {
    if (putEndingEntity) {
      try {
        toProcess.put(getEndingEntity());
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
  }
}
