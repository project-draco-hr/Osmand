{
  if (intermediate != null && intermediate.size() > 0) {
    ArrayList<RouteSegment> ps=new ArrayList<RouteSegment>(intermediate);
    ArrayList<RouteSegmentResult> firstPartRecalculatedRoute=null;
    ArrayList<RouteSegmentResult> restPartRecalculatedRoute=null;
    if (ctx.previouslyCalculatedRoute != null) {
      List<RouteSegmentResult> prev=ctx.previouslyCalculatedRoute;
      long id=intermediate.get(0).getRoad().id;
      int ss=intermediate.get(0).getSegmentStart();
      for (int i=0; i < prev.size(); i++) {
        RouteSegmentResult rsr=prev.get(i);
        if (id == rsr.getObject().getId() && ss == rsr.getEndPointIndex()) {
          firstPartRecalculatedRoute=new ArrayList<RouteSegmentResult>(prev.subList(0,i + 1));
          restPartRecalculatedRoute=new ArrayList<RouteSegmentResult>(prev.subList(i + 1,prev.size()));
          break;
        }
      }
    }
    ps.add(end);
    ps.add(0,start);
    List<RouteSegmentResult> results=new ArrayList<RouteSegmentResult>();
    for (int i=0; i < ps.size() - 1; i++) {
      RoutingContext local=new RoutingContext(ctx.config);
      local.copyLoadedDataAndClearCaches(ctx);
      if (i == 0) {
        local.previouslyCalculatedRoute=firstPartRecalculatedRoute;
      }
      local.visitor=ctx.visitor;
      List<RouteSegmentResult> res=searchRouteInternal(local,ps.get(i),ps.get(i + 1),leftSideNavigation);
      results.addAll(res);
      ctx.distinctLoadedTiles+=local.distinctLoadedTiles;
      ctx.distinctUnloadedTiles.addAll(local.distinctUnloadedTiles);
      ctx.loadedTiles+=local.loadedTiles;
      ctx.visitedSegments+=local.visitedSegments;
      ctx.loadedPrevUnloadedTiles+=local.loadedPrevUnloadedTiles;
      ctx.timeToCalculate+=local.timeToCalculate;
      ctx.timeToLoad+=local.timeToLoad;
      ctx.relaxedSegments+=local.relaxedSegments;
      List<RoutingTile> toUnload=new ArrayList<RoutingContext.RoutingTile>();
      for (      RoutingTile t : local.tiles.valueCollection()) {
        if (!ctx.tiles.contains(t.getId())) {
          toUnload.add(t);
        }
      }
      for (      RoutingTile tl : toUnload) {
        local.unloadTile(tl,false);
      }
      if (restPartRecalculatedRoute != null) {
        results.addAll(restPartRecalculatedRoute);
        break;
      }
    }
    Object[] vls=ctx.tiles.values();
    for (    Object tl : vls) {
      if (((RoutingTile)tl).isLoaded()) {
        ctx.unloadTile((RoutingTile)tl,false);
      }
    }
    printResults(ctx,start,end,results);
    return results;
  }
  return searchRoute(ctx,start,end,leftSideNavigation);
}
