{
  boolean directionAllowed;
  final int middle=segment.getSegmentStart();
  int oneway=ctx.getRouter().isOneWay(road);
  if (!reverseWaySearch) {
    if (direction) {
      directionAllowed=oneway >= 0;
    }
 else {
      directionAllowed=oneway <= 0;
    }
  }
 else {
    if (direction) {
      directionAllowed=oneway <= 0;
    }
 else {
      directionAllowed=oneway >= 0;
    }
  }
  if (direction) {
    if (middle == road.getPointsLength() - 1 || visitedSegments.containsKey(calculateRoutePointId(road,middle,true)) || segment.getAllowedDirection() == -1) {
      directionAllowed=false;
    }
  }
 else {
    if (middle == 0 || visitedSegments.containsKey(calculateRoutePointId(road,middle - 1,false)) || segment.getAllowedDirection() == 1) {
      directionAllowed=false;
    }
  }
  return directionAllowed;
}
