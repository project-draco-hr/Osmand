{
  final OsmPoint[] poi=(OsmPoint[])getArguments().getSerializable(OPENSTREETMAP_POINT);
  AlertDialog.Builder builder=new AlertDialog.Builder(getActivity());
  View view=getActivity().getLayoutInflater().inflate(R.layout.send_poi_dialog,null);
  final View messageEditTextLabel=view.findViewById(R.id.messageEditTextLabel);
  final EditText messageEditText=(EditText)view.findViewById(R.id.messageEditText);
  final EditText userNameEditText=(EditText)view.findViewById(R.id.userNameEditText);
  final EditText passwordEditText=(EditText)view.findViewById(R.id.passwordEditText);
  final CheckBox closeChangeSetCheckBox=(CheckBox)view.findViewById(R.id.closeChangeSetCheckBox);
  messageEditText.setText(comment);
  final OsmandSettings settings=((OsmandApplication)getActivity().getApplication()).getSettings();
  userNameEditText.setText(settings.USER_NAME.get());
  passwordEditText.setText(settings.USER_PASSWORD.get());
  boolean hasOsmPOI=false;
  for (  OsmPoint p : poi) {
    if (p.getGroup() == OsmPoint.Group.POI) {
      hasOsmPOI=true;
      break;
    }
  }
  messageEditTextLabel.setVisibility(hasOsmPOI ? View.VISIBLE : View.GONE);
  messageEditText.setVisibility(hasOsmPOI ? View.VISIBLE : View.GONE);
  closeChangeSetCheckBox.setVisibility(hasOsmPOI ? View.VISIBLE : View.GONE);
  final ProgressDialogPoiUploader progressDialogPoiUploader;
  if (poiUploader != null) {
    progressDialogPoiUploader=poiUploader;
  }
 else {
    progressDialogPoiUploader=(ProgressDialogPoiUploader)getParentFragment();
  }
  builder.setTitle(R.string.shared_string_commit).setView(view).setPositiveButton(R.string.shared_string_ok,new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int which){
      comment=messageEditText.getText().toString();
      settings.USER_NAME.set(userNameEditText.getText().toString());
      settings.USER_PASSWORD.set(passwordEditText.getText().toString());
      if (comment.length() > 0) {
        for (        OsmPoint osmPoint : poi) {
          if (osmPoint.getGroup() == OsmPoint.Group.POI) {
            ((OpenstreetmapPoint)osmPoint).setComment(comment);
            break;
          }
        }
      }
      progressDialogPoiUploader.showProgressDialog(poi,closeChangeSetCheckBox.isChecked());
    }
  }
).setNegativeButton(R.string.shared_string_cancel,null);
  return builder.create();
}
