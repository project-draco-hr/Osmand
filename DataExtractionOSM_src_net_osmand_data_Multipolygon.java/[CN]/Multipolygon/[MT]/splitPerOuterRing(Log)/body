{
  SortedSet<Ring> inners=new TreeSet<Ring>(getInnerRings());
  SortedSet<Ring> outers=new TreeSet<Ring>(getOuterRings());
  ArrayList<Multipolygon> multipolygons=new ArrayList<Multipolygon>();
  for (  Ring outer : outers) {
    Multipolygon m=new Multipolygon();
    m.addOuterWays(outer.getWays());
    SortedSet<Ring> innersInsideOuter=new TreeSet<Ring>();
    for (    Ring inner : inners) {
      if (inner.isIn(outer)) {
        innersInsideOuter.add(inner);
        for (        Way w : inner.getWays()) {
          m.addInnerWay(w);
        }
      }
    }
    inners.removeAll(innersInsideOuter);
    multipolygons.add(m);
  }
  if (inners.size() != 0 && log != null)   log.warn("Multipolygon " + getId() + " has a mismatch in outer and inner rings");
  return multipolygons;
}
