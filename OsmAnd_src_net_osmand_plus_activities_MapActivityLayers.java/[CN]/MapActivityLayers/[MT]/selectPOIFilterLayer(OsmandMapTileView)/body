{
  OsmandApplication app=getApplication();
  final PoiFiltersHelper poiFilters=app.getPoiFilters();
  final ContextMenuAdapter adapter=new ContextMenuAdapter();
  adapter.addItem(new ContextMenuItem.ItemBuilder().setTitleId(R.string.shared_string_search,app).setIcon(R.drawable.ic_action_search_dark).createItem());
  final List<PoiUIFilter> list=new ArrayList<PoiUIFilter>();
  list.add(poiFilters.getCustomPOIFilter());
  for (  PoiUIFilter f : poiFilters.getTopDefinedPoiFilters()) {
    addFilterToList(adapter,list,f);
  }
  for (  PoiUIFilter f : poiFilters.getSearchPoiFilters()) {
    addFilterToList(adapter,list,f);
  }
  AlertDialog.Builder builder=new AlertDialog.Builder(activity);
  ListAdapter listAdapter=adapter.createListAdapter(activity,app.getSettings().isLightContent());
  builder.setAdapter(listAdapter,new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int position){
      PoiUIFilter pf=list.get(position);
      String filterId=pf.getFilterId();
      if (filterId.equals(PoiUIFilter.CUSTOM_FILTER_ID)) {
        Intent search=new Intent(activity,SearchActivity.class);
        search.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
        activity.getMyApplication().getSettings().SEARCH_TAB.set(SearchActivity.POI_TAB_INDEX);
        activity.startActivity(search);
      }
    }
  }
);
  builder.setTitle(R.string.show_poi_over_map).setPositiveButton(R.string.shared_string_ok,new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int which){
      mapView.refreshMap();
    }
  }
).setNegativeButton(R.string.shared_string_cancel,null);
  return builder.show();
}
