{
  OnContextMenuClick listener=new OnContextMenuClick(){
    @Override public boolean onContextMenuClick(    ArrayAdapter<?> adapter,    int resId,    int pos,    boolean isChecked){
      if (resId == R.string.context_menu_item_create_poi) {
        EditPoiDialogFragment editPoiDialogFragment=EditPoiDialogFragment.createAddPoiInstance(latitude,longitude,mapActivity.getMyApplication());
        editPoiDialogFragment.show(mapActivity.getSupportFragmentManager(),EditPoiDialogFragment.TAG);
      }
 else       if (resId == R.string.context_menu_item_open_bug) {
        if (osmBugsLayer == null) {
          registerLayers(mapActivity);
        }
        osmBugsLayer.openBug(latitude,longitude);
      }
 else       if (resId == R.string.poi_context_menu_delete) {
        new EditPoiDialogFragment.ShowDeleteDialogAsyncTask(mapActivity).execute((Amenity)selectedObj);
      }
 else       if (resId == R.string.poi_context_menu_modify) {
        EditPoiDialogFragment.showEditInstance((Amenity)selectedObj,mapActivity);
      }
      return true;
    }
  }
;
  boolean isEditable=false;
  if (selectedObj instanceof Amenity) {
    Amenity amenity=(Amenity)selectedObj;
    final PoiType poiType=amenity.getType().getPoiTypeByKeyName(amenity.getSubType());
    isEditable=!amenity.getType().isWiki() && !poiType.isNotEditableOsm();
  }
  if (isEditable) {
    adapter.item(R.string.poi_context_menu_modify).iconColor(R.drawable.ic_action_edit_dark).listen(listener).position(1).reg();
    adapter.item(R.string.poi_context_menu_delete).iconColor(R.drawable.ic_action_delete_dark).listen(listener).position(2).reg();
  }
 else {
    adapter.item(R.string.context_menu_item_create_poi).iconColor(R.drawable.ic_action_plus_dark).listen(listener).position(-1).reg();
  }
  adapter.item(R.string.context_menu_item_open_bug).iconColor(R.drawable.ic_action_bug_dark).listen(listener).reg();
}
