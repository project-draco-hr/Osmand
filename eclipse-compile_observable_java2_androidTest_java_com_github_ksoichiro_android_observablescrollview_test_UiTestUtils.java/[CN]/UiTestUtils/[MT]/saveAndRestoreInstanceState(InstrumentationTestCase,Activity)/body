{
  test.runTestOnUiThread(new Runnable(){
    @Override public void run(){
      Bundle outState=new Bundle();
      test.getInstrumentation().callActivityOnSaveInstanceState(activity,outState);
      test.getInstrumentation().callActivityOnPause(activity);
      test.getInstrumentation().callActivityOnResume(activity);
      test.getInstrumentation().callActivityOnRestoreInstanceState(activity,outState);
    }
  }
);
  test.getInstrumentation().waitForIdleSync();
}
