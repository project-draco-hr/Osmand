{
  MapInfoControlRegInfo ii=new MapInfoControlRegInfo();
  ii.defaultModes=appDefaultModes.clone();
  ii.defaultCollapsible=null;
  ii.key=key;
  ii.visibleModes=EnumSet.noneOf(ApplicationMode.class);
  ii.visibleCollapsible=null;
  for (  ApplicationMode ms : ApplicationMode.values()) {
    boolean def=appDefaultModes.contains(ms);
    Set<String> set=visibleElements.get(ms);
    if (set != null) {
      if (set.contains(key)) {
        def=true;
      }
 else       if (set.contains("-" + key)) {
        def=false;
      }
    }
    if (def) {
      ii.visibleModes.add(ms);
    }
  }
  if (m != null)   m.setContentDescription(m.getContext().getString(messageId));
  ii.drawable=drawable;
  ii.messageId=messageId;
  ii.m=m;
  ii.priorityOrder=priorityOrder;
  ii.position=left;
  this.top.add(ii);
  return ii;
}
