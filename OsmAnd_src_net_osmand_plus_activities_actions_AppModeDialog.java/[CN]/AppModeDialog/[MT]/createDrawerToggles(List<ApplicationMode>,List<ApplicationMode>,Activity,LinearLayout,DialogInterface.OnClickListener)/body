{
  ToggleButton[] buttons=createToggles(visible,ll,a);
  ToggleButton[] newButtons=new ToggleButton[buttons.length + 1];
  for (int i=0; i < buttons.length; i++) {
    newButtons[i]=buttons[i];
  }
  ToggleButton tb=new ToggleButton(a);
  newButtons[buttons.length]=tb;
  tb.setTextOn("");
  tb.setTextOff("");
  int left=(int)TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,10,a.getResources().getDisplayMetrics());
  int metrics=(int)TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,64,a.getResources().getDisplayMetrics());
  tb.setButtonDrawable(R.drawable.ic_other_modes);
  LayoutParams lp=new LayoutParams(metrics,metrics);
  lp.setMargins(left,0,0,0);
  tb.setChecked(false);
  tb.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View view){
      CompoundButton compoundButton=(CompoundButton)view;
      compoundButton.setChecked(false);
      final AlertDialog.Builder builder=new AlertDialog.Builder(a);
      final Set<ApplicationMode> selected=new LinkedHashSet<ApplicationMode>(visible);
      builder.setTitle(R.string.profile_settings);
      builder.setPositiveButton(R.string.default_buttons_ok,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialogInterface,        int i){
          visible.clear();
          visible.addAll(selected);
          if (onDialogOk != null) {
            onDialogOk.onClick(dialogInterface,i);
          }
        }
      }
);
      final AlertDialog dialog=builder.create();
      View v=AppModeDialog.prepareAppModeView(a,modes,selected,null,false,new View.OnClickListener(){
        @Override public void onClick(        View v){
          if (selected.size() == 3) {
            dialog.getButton(DialogInterface.BUTTON_POSITIVE).setEnabled(true);
          }
 else {
            dialog.getButton(DialogInterface.BUTTON_POSITIVE).setEnabled(false);
          }
        }
      }
);
      dialog.setView(v);
      dialog.show();
    }
  }
);
  ll.addView(tb,lp);
  return newButtons;
}
