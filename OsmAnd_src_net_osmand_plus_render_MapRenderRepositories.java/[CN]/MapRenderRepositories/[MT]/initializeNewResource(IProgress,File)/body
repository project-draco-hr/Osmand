{
  long start=System.currentTimeMillis();
  if (files.containsKey(file.getAbsolutePath())) {
    closeConnection(files.get(file.getAbsolutePath()),file.getAbsolutePath());
  }
  RandomAccessFile raf=null;
  BinaryMapIndexReader reader=null;
  try {
    raf=new RandomAccessFile(file,"r");
    reader=new BinaryMapIndexReader(raf);
    if (reader.getVersion() != IndexConstants.BINARY_MAP_VERSION) {
      return null;
    }
    files.put(file.getAbsolutePath(),reader);
  }
 catch (  IOException e) {
    log.error("No connection or unsupported version",e);
    if (raf != null) {
      try {
        raf.close();
      }
 catch (      IOException e1) {
      }
    }
    return null;
  }
catch (  OutOfMemoryError oome) {
    if (raf != null) {
      try {
        raf.close();
      }
 catch (      IOException e1) {
      }
    }
    throw oome;
  }
  if (log.isDebugEnabled()) {
    log.debug("Initializing db " + file.getAbsolutePath() + " "+ (System.currentTimeMillis() - start)+ "ms");
  }
  return reader;
}
