{
  long start=System.currentTimeMillis();
  if (files.containsKey(file.getAbsolutePath())) {
    closeConnection(files.get(file.getAbsolutePath()),file.getAbsolutePath());
  }
  files.put(file.getAbsolutePath(),reader);
  NativeOsmandLibrary nativeLib=prefs.NATIVE_RENDERING.get() ? NativeOsmandLibrary.getLoadedLibrary() : null;
  if (nativeLib != null) {
    if (!nativeLib.initMapFile(file.getAbsolutePath())) {
      log.error("Initializing native db " + file.getAbsolutePath() + " failed!");
    }
 else {
      nativeFiles.add(file.getAbsolutePath());
    }
  }
}
