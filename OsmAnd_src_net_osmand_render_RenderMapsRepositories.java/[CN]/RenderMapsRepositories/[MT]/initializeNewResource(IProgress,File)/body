{
  long start=System.currentTimeMillis();
  try {
    if (conn != null) {
      conn.close();
      conn=null;
      pStatement=null;
    }
    try {
      Class.forName("org.sqlite.JDBC");
    }
 catch (    Exception e) {
      log.error("Could not load driver",e);
      return false;
    }
    conn=DriverManager.getConnection("jdbc:sqlite:" + file.getAbsolutePath());
    pStatement=conn.prepareStatement(loadMapQuery);
    Statement stat=conn.createStatement();
    ResultSet rs=stat.executeQuery("PRAGMA user_version");
    int v=rs.getInt(1);
    rs.close();
    if (v != IndexConstants.MAP_TABLE_VERSION) {
      return false;
    }
    stat.close();
  }
 catch (  Exception e) {
    log.error("No connection",e);
    if (conn != null) {
      try {
        conn.close();
      }
 catch (      java.sql.SQLException e1) {
      }
      conn=null;
    }
    return false;
  }
  if (log.isDebugEnabled()) {
    log.debug("Initializing db " + file.getAbsolutePath() + " "+ (System.currentTimeMillis() - start)+ "ms");
  }
  return true;
}
